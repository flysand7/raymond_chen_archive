<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The case of the missing context menu verbs</h1>  <!-- .entry-meta -->

<p>A customer reported that when they right-clicked a batch file, a bunch of commands were missing. For example, <i>Open</i> was gone!
 Okay, there really isn’t much of a story here, because some direct debugging quickly identified the culprit.
 The customer had installed a third party shell extension which returned a huge value from its <code>IContext­Menu::Query­Context­Menu</code> method.
 Explorer told the shell extension, “Hey, like I’ve got room for 30,000 menu items. How many do you need?”
 The shell extension replied, “I’ll take 29,995 of them.”
 And so the shell extension sucked up nearly all the menu IDs, and by the time the <i>Open</i> command handler came along, the context menu host said, “Sorry, I’m all out.”
 If you followed along when we <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/10/07/239197.aspx"> created a composite context menu</a>, you could sort of see this problem coming.</p>
<p> Uninstalling the buggy shell extension fixed the problem. </p>


</body>