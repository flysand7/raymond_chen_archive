<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why aren't environment variables being expanded in my RGS file?</h1>  <!-- .entry-meta -->

<p>A customer was having trouble with their RGS file.
</p>
<blockquote class="q">
<p>
I want to include the below line in a .rgs file:
</p>
<pre>
val HandlerPath = s '%windir%\system32\awesome.dll'.
</pre>
<p>
When I do this, registering of the dll fails with 80002009. Any help?
If I change it to
</p>
<pre>
val HandlerPath = s 'C:\windows\system32\awesome.dll'.
</pre>
<p>
then the registration succeeds (but of course now contains
a hard-coded path).
</p>
</blockquote>
<p>
A common problem people have when asking a question is assuming
that the person reading your question has knowledge that is a
strict superset of what you know.
As a result, people omit details like
the answer to the question
“How did you register your RGS file?”
</p>
<p>
If all else fails read the documentation
(which happens to be the #1 hit for “rgs file”, or at least was
at the time of this writing).
And the documentation explains
<a href="http://msdn.microsoft.com/en-us/library/7dc08eza.aspx">
how the <code>%</code> works</a>.
And it’s not for environment variable expansion.
</p>
<p>
Just because you stick something between percent signs
doesn’t mean that the magical percent sign fairies are going
to swoop in and perform environment variable expansion.
<a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/08/04/10192588.aspx">
Wishful thinking does not cause features to spring into existence</a>.
</p>
<p>
As the documentation says,
you need to use the
<code>_ATL_REGMAP_ENTRY</code> macro to
create the mapping for replacement variables.
</p>
<p>
This type of question reflects a certain mentality which is
<a href="http://thedailywtf.com/Articles/G%C3%B6r_spel!.aspx">
cute when kids do it</a>,
but frustrating when demonstrated by programmers,
namely, that features exist
<i>merely because you expect them to</i>,
rather than because there’s any documentation that
suggests that they exist.</p>


</body>