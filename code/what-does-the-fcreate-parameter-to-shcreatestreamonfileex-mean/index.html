<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What does the fCreate parameter to SHCreateStreamOnFileEx mean?</h1>  <!-- .entry-meta -->

<p> The documentation for the <code>fCreate</code> parameter for the <code>SHCreateStreamOnFileEx</code> function covers the issue, but since people seem to really like charts and tables, I’ll present the same information in tabular form. </p>
<table>
<col span="3" style="padding-right: 1em"/>
<tr>
<th>grfMode</th>
<th>fCreate</th>
<th>File exists?</th>
<th>Behavior</th>
</tr>
<tr>
<td>STGM_CREATE</td>
<td>(ignored)</td>
<td>Yes</td>
<td>File is opened (old contents lost)</td>
</tr>
<tr>
<td>STGM_CREATE</td>
<td>(ignored)</td>
<td>No</td>
<td>File is created</td>
</tr>
<tr>
<td>STGM_FAILIFTHERE</td>
<td>FALSE</td>
<td>Yes</td>
<td>File is opened (old contents preserved)</td>
</tr>
<tr>
<td>STGM_FAILIFTHERE</td>
<td>FALSE</td>
<td>No</td>
<td>Fails</td>
</tr>
<tr>
<td>STGM_FAILIFTHERE</td>
<td>TRUE</td>
<td>Yes</td>
<td>Fails</td>
</tr>
<tr>
<td>STGM_FAILIFTHERE</td>
<td>TRUE</td>
<td>No</td>
<td>File is created</td>
</tr>
</table>


</body>