<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What happens if I call EnumPropsEx while another thread is mutating the properties?</h1>  <!-- .entry-meta -->

<p>Following up on the question <a href="https://blogs.msdn.microsoft.com/oldnewthing/20160303-00/?p=93111">Are SetProp and RemoveProp thread-safe?</a>, you might wonder what happens if you call <code>Enum­Props­Ex</code> while another thread is mutating the properties? </p>
<p>The answer is similar to what you get if <a href="https://devblogs.microsoft.com/oldnewthing/">you call <code>Find­First­File</code> / <code>Find­Next­File</code> while somebody else is creating or deleting files</a>. </p>
<ul>
<li>If a property is created after the enumeration starts,     then it is unspecified whether it will be reported by     <code>Enum­Props­Ex</code>. 
<li>If a property is deleted after the enumeration starts,     then it is unspecified whether it will be reported by     <code>Enum­Props­Ex</code>.     Special exception: The enumeration callback is allowed     to remove the property being enumerated. 
<li>If a property is modified after the enumeration starts,     then it is unspecified whether the value reported by     <code>Enum­Props­Ex</code>     is the old value or the new value. </li></li></li></ul>
<p>Hopefully, nobody is playing games with properties that are so crazy that any of these rules will actually come into play, aside from the special exception. </p>


</body>