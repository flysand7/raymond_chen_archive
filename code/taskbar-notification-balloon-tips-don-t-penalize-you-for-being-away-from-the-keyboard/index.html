<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Taskbar notification balloon tips don't penalize you for being away from the keyboard</h1>  <!-- .entry-meta -->

<p><a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/functions/shell_notifyicon.asp"> The <code>Shell_NotifyIcon</code> function</a> is used to do various things, among them, displaying a balloon tip to the user. As discussed in the documentation for <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/structures/notifyicondata.asp"> the <code>NOTIFYICONDATA</code> structure</a>, the <b>uTimeout</b> member specifies how long the balloon should be displayed.
 But what if the user is not at the computer when you display your balloon? After 30 seconds, the balloon will time out, and the user will have missed your important message!
 Never fear.  The taskbar keeps track of whether the user is using the computer (with the help of <a href="http://msdn.microsoft.com/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/KeyboardInput/KeyboardInputReference/KeyboardInputFunctions/GetLastInputInfo.asp"> the <code>GetLastInputInfo</code> function</a>) and doesn’t “run the clock” if it appears that the user isn’t there. You will get your 30 seconds of “face time” with the user.
 But what if you want to time out your message even if the user isn’t there?
 You actually have the information available to you to solve this puzzle on the web pages I linked above.  See if you can put the pieces together and come up with a better solution than <a href="http://groups.google.com/groups?selm=4c3a52a7.0404200620.353d354c@posting.google.com"> simulating a click on the balloon</a>. (Hint: Look carefully at what it means if you set your balloon text to an empty string.)
 And what if you want your message to stay on the screen longer than 30 seconds?</p>
<p> You can’t. The notification area enforces a 30 second limit for any single balloon.  Because if they user hasn’t done anything about it for 30 seconds, they probably aren’t interested. If your message is so critical that the user shouldn’t be allowed to ignore it, then don’t use a notification balloon. Notification balloons are for non-critical transient messages to the user. </p>


</body>