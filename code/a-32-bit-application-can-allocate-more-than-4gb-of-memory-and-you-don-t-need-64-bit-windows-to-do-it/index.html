<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">A 32-bit application can allocate more than 4GB of memory, and you don't need 64-bit Windows to do it</h1>  <!-- .entry-meta -->

<p>Commenter Herb wondered <a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#608186"> how a 32-bit program running on 64-bit Windows can allocate more than 4GB of memory</a>. Easy: The same way it allocates more than 4GB of memory on 32-bit Windows!
 Over a year before Herb asked the question, I had already answered it in the tediously boring <a href="http://blogs.msdn.com/oldnewthing/archive/2004/08/22/218527.aspx"> two-week series on the myths surrounding the /3GB switch</a>. Here’s a page that shows <a href="http://blogs.msdn.com/oldnewthing/archive/2004/08/10/211890.aspx"> how you can allocate more than 2GB of memory</a> by using shared memory (which Win32 confusingly calls file mappings). That code fragment allocated 4GB of memory at one go, and then accessed it in pieces (because a 32-bit program can’t map an entire 4GB memory block at one go). To allocate more, either make the number bigger in the call to <code>CreateFileMapping</code> or just call <code>CreateFileMapping</code> multiple times.
 The following week, I talked about how you can <a href="http://blogs.msdn.com/oldnewthing/archive/2004/08/19/217087.aspx"> use AWE to allocate physical pages</a>. Again, you can allocate as much memory as you like, but if you allocate enormous amounts of memory, you will probably not be able to map them all in at once.
 The claims of the program are true, but 64-bit Windows wasn’t necessary for the program to accomplish what it claims. It’s like <a href="http://www.imdb.com/title/tt0033563/"> Dumbo</a> and the magic feather. “Dumbo can fly with the magic feather in his trunk.” Well, yeah, but he didn’t actually need the feather.</p>
<p> (On the other hand, 64-bit Windows certainly makes it more convenient to <u>use</u> more than 4GB of memory, since you can map the memory  into your address space all at once and use normal pointers to access it.) </p>


</body>