<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why is the System.DateCreated property off by a few seconds?</h1>  <!-- .entry-meta -->

<p>If you ask for the <code>System.Date­Created</code> property of a shell item, the timestamp that comes back is up to two seconds different from the file’s actual timestamp. (Similarly for <code>System.Date­Modified</code> and <code>System.Date­Accessed</code>.) Why is that? </p>
<p>This is an artifact of a decision taken in 1993. </p>
<p>In general, shell namespace providers cache information in the ID list at the time the ID list is created so that querying basic properties from an item can be done without accessing the underlying medium. </p>
<p>In 1993, <a href="http://blogs.msdn.com/oldnewthing/archive/2003/10/10/55256.aspx">saving 4KB of memory had a measurable impact on system performance</a>. Therefore, bytes were scrimped and saved, and one place where <i>four whole bytes</i> were squeezed out was in the encoding of file timestamps in ID lists. Instead of using the 8-byte <code>FILE­TIME</code> structure, the shell used the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724247(v=vs.85).aspx">4-byte DOS date-time format</a>. Since the shell created thousands of ID lists, a four-byte savings multiplied over thousands of items comes out to several <a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/06/11/9725386.aspx">kilobytes</a> of data. </p>
<p>But one of the limitations of the DOS date-time format is that it records time in two-second increments, so any timestamp recorded in DOS date-time format can be up to two seconds away from its actual value. (The value is always truncated rather than rounded in order to avoid problems with timestamps from the future.) Since Windows 95 used FAT as its native file system, and FAT uses the DOS date-time format, this rounding never created any problems in practice, since all the file timestamps were already pre-truncated to 2-second intervals. </p>
<p>Of course, Windows NT uses NTFS as the native file system, and NTFS records file times to 100-nanosecond <a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/09/02/459952.aspx">precision</a>. (Though the accuracy is significantly less.) But too late. The ID list format has already been decided, and since ID lists can be saved to a file and transported to another computer (<i>e.g.</i> in the form of a shortcut file), the binary format cannot be tampered with. Hooray for compatibility. </p>
<p><b>Bonus chatter</b>: In theory, the ID list format could be extended in a backward-compatible way, so that every ID list contained two timestamps, a compatible version (2-second precision) and a new version (100-nanosecond precision). So far, there has not been significant demand for more accurate timestamps inside of ID lists. </p>


</body>