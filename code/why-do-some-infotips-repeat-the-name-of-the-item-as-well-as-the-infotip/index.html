<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why do some infotips repeat the name of the item as well as the infotip?</h1>  <!-- .entry-meta -->

<p>A customer noticed that when the user hovered over their application name in the Start menu, the infotip that pops up includes their product name:</p>
<table cellpadding="0" cellspacing="0" style="border-left: solid .75pt black;border-right: solid .75pt black;width: 10em;font-family: MS Sans Serif, sans-serif;font-size: 9pt;background: window;color: windowtext;margin: 1em 0em">
<tr>
<td align="center">♫ </td>
<td nowrap="">

<p>     Contoso Professional Music Studio De…</p></td>
</tr>
<tr>
<td align="center">◕ </td>
<td nowrap="">Fabrikam Chart 2.0</td>
</tr>
<tr>
<td align="center">ℒ </td>
<td nowrap="">Litware 2010</td>
</tr>
</table>
<p> … but no other program on the Start menu included the product name in the description:</p>
<table cellpadding="0" cellspacing="0" style="border-left: solid .75pt black;border-right: solid .75pt black;width: 10em;font-family: MS Sans Serif, sans-serif;font-size: 9pt;background: window;color: windowtext;margin: 1em 0em">
<tr>
<td align="center">◕ </td>
<td nowrap="">

<p>     Fabrikam Chart 2.0</p></td>
</tr>
<tr>
<td align="center">♫ </td>
<td nowrap="">Contoso Professional Music Studio De…</td>
</tr>
<tr>
<td align="center">ℒ </td>
<td nowrap="">Litware 2010</td>
</tr>
</table>
<p> The customer compared their shortcut with the other ones but couldn’t find anything that was telling Explorer, “Include the program name in the pop-up infotip, please.”
 Because the reason for the name being included in the infotip had nothing to do with the properties stored in the shortcut. The reason the name was included in the infotip is that the name was being truncated in the main display.
 When an infotip is about to be displayed for a listview item, the listview sends a <a href="http://msdn.microsoft.com/library/bb774835.aspx"> <code>LVN_GET­INFO­TIP</code> notification</a> with a <a href="http://msdn.microsoft.com/library/bb774786.aspx"> <code>NMLV­GET­INFO­TIP</code> structure</a>. If the <code>LVGIT_UNFOLDED</code> flag is not set, then the infotip is being displayed for a truncated item, and the <code>pszText</code> is pre-filled with the full name. The program should then append its information to the existing text so that the full name is the first line of the infotip. On the other hand, if the <code>LVGIT_UNFOLDED</code> flag is set, then the item text is fully-visible and you should just copy your desired description text into the <code>pszText</code> buffer.
 The customer was happy to get this information. Their designer wanted only the description to appear in the infotip, and now they know that they need to shorten the program name to make the name disappear from the infotip.</p>
<p> <b>Bonus chatter</b>: <a href="http://blogs.msdn.com/b/jonathanh/archive/2005/08/05/what-s-the-longest-microsoft-product-name.aspx"> Microsoft® WinFX™ Software Development Kit for Microsoft® Pre-Release Windows Operating System Code-Named “Longhorn”, Beta 1 Web Setup</a>. </p>


</body>