<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What states are possible in a DRAWITEMSTRUCT structure?</h1>  <!-- .entry-meta -->

<p>The <code>DRAW­ITEM­STRUCT</code> structure has an <code>item­State</code> member which contains a number of bits describing the state of the item being drawn. How do those states map to the underlying control?
 Most of the states are rather obvious. For a list box item to be <i>selected</i>, it means that the item is part of the selection. But what does <i>selected</i> mean for a button?
 Since people like tables, I’ll put the answer in a table:</p>
<table border="1" cellpadding="3" cellspacing="0" style="border-collapse: collapse;margin-bottom: 1em">
<tr>
<th></th>
<th>Menu</th>
<th>Listbox</th>
<th>Combobox</th>
<th>Button</th>
</tr>
<tr>
<td><code>CtlType</code></td>
<td><code>ODT_MENU</code></td>
<td><code>ODT_LISTBOX</code></td>
<td><code>ODT_COMBOBOX</code></td>
<td><code>ODT_BUTTON</code></td>
</tr>
<tr>
<td><code>itemID</code></td>
<td>menu item ID</td>
<td>item index or −1</td>
<td>item index or −1</td>
<td></td>
</tr>
<tr> </tr>
<td><code>ODS_SELECTED</code></td>
<td>Selected</td>
<td>Selected</td>
<td>Selected</td>
<p><!-- aka Focus --> </p>
<td>Pushed</td>
<tr>
<td><code>ODS_GRAYED</code></td>
<td>Grayed</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_DISABLED</code></td>
<td>Disabled</td>
<td>Disabled</td>
<td>Disabled</td>
<td>Disabled</td>
</tr>
<tr>
<td><code>ODS_CHECKED</code></td>
<td>Checked</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_FOCUS</code></td>
<td></td>
<td>Focus</td>
<td>Focus</td>
<td>Focus</td>
</tr>
<tr>
<td><code>ODS_DEFAULT</code></td>
<td>Default menu item</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_HOTLIGHT</code></td>
<td>Hover</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_INACTIVE</code></td>
<td>Inactive</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_NOACCEL</code></td>
<td>HideAccel</td>
<td>HideAccel</td>
<td>HideAccel</td>
<td>HideAccel</td>
</tr>
<tr>
<td><code>ODS_NOFOCUSRECT</code></td>
<td></td>
<td>HideFocus</td>
<td>HideFocus</td>
<td>HideFocus</td>
</tr>
<tr>
<td><code>ODS_COMBOBOXEDIT</code></td>
<td></td>
<td></td>
<td>Is edit control</td>
<td></td>
</tr>
</table>
<table border="1" cellpadding="3" cellspacing="0" style="border-collapse: collapse">
<tr>
<th></th>
<th>Static</th>
<th>Header</th>
<th>Tab</th>
<th>Listview</th>
<th>Status</th>
</tr>
<tr>
<td><code>CtlType</code></td>
<td><code>ODT_STATIC</code></td>
<td><code>ODT_HEADER</code></td>
<td><code>ODT_TAB</code></td>
<td><code>ODT_LISTVIEW</code></td>
<td></td>
</tr>
<tr>
<td><code>itemID</code></td>
<td></td>
<td>item index</td>
<td>item index</td>
<td>item index</td>
<td>part index</td>
</tr>
<tr>
<td><code>ODS_SELECTED</code></td>
<td></td>
<td>Pushed</td>
<td>Selected</td>
<td>Selected</td>
<td></td>
</tr>
<tr>
<td><code>ODS_GRAYED</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_DISABLED</code></td>
<td><font color="blue">Oops</font></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_CHECKED</code></td>
<td></td>
<td></td>
<td></td>
<td>AutoChecked</td>
<td></td>
</tr>
<tr>
<td><code>ODS_FOCUS</code></td>
<td></td>
<td></td>
<td></td>
<td>Focus</td>
<td></td>
</tr>
<tr>
<td><code>ODS_DEFAULT</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_HOTLIGHT</code></td>
<td></td>
<td></td>
<td></td>
<td>Hover</td>
<td></td>
</tr>
<tr>
<td><code>ODS_INACTIVE</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_NOACCEL</code></td>
<td>HideAccel</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_NOFOCUSRECT</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ODS_COMBOBOXEDIT</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
<p> Okay, now that it’s all in a table, how do I read the table?
 A box is blank if the corresponding flag is not currently used by the control type. (No guarantees about the future.) For example, as of this writing, button controls do not set an <code>itemID</code>, nor do they ever ask for <code>ODS_GRAYED</code>.
 You may have noticed that the box for <code>CtlType</code> is blank for status controls. That’s an oops. The status bar control forgot to set the <code>CtlType</code> when it sends the <code>WM_DRAW­ITEM</code> message, so the value is uninitialized garbage. The way to detect a status bar control is to check the window handle. (This works in general. You can always detect a control by checking the window handle.)
 For list boxes and combo boxes, the <code>itemID</code> can have the special value <code>-1</code> to mean “I am drawing a list box/combo box where no item is selected.” For list boxes, this happens when the list box is empty. For combo boxes, this happens when the user types text into the edit box that does not match any of the items in the list portion of the combo box.
 Most of the other box entries are self-explanatory. For the most part, the flag name matches the conditions under which the corresponding flag is set. For example, the <code>ODS_FOCUS</code> flag is set when the list box item being drawn is the selected item.
 Note that the <code>ODS_SELECTED</code> flag is used for button and header controls to indicate that the control should be drawn in the pushed state. For example, the user may have put focus on a button control and pressed the space bar and not yet released it, or the application may have manually set the <code>BST_PUSHED</code> state. Header controls can get into a <i>pushed</i> state if you enable the <code>HDS_BUTTONS</code> style.
 List view controls set the <code>ODS_CHECKED</code> flag if a check box should be drawn over the item. This happens if the <code>LVS_EX_AUTO­CHECK­SELECT</code> extended style is specified and the item is selected. (Normally, the check box is drawn to the side as a state image.)
 The <code>ODS_COMBO­BOX­EDIT</code> flag is used only by combo box controls. It is set if the item being drawn is the edit portion of a combo box control. If not set, then the item being drawn is in the list box portion of the combo box control.
 Finally, there is a box marked <font color="blue">Oops</font>.
 The static control is supposed to set <code>ODS_DISABLED</code> if the static control is disabled. And that’s what happens if you are using the classic static control. However, there is a typo in the the fancy themed static control, and it sets the <code>ODS_DISBALED</code> flag incorrectly. If you are owner-drawing a themed static control, and you want to draw differently depending on whether the control is disabled, then you should ignore the <code>ODS_DISABLED</code> flag and instead draw the disabled state based on the result of calling <code>Is­Window­Enabled</code> function.</p>
<p> The bug in the themed static control cannot be fixed for compatibility reasons. I can pretty much guarantee that there is some application which doesn’t draw correctly if the <code>ODS_DISABLED</code> flag is not set. </p>


</body>