<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why am I being told that my message ID is too large?</h1>  <!-- .entry-meta -->

<p>A customer asked for help with an error message in the message compiler. </p>
<blockquote class="q">
<p>Our message file goes like this: </p>
<pre>
MessageIdTypedef=DWORD
MessageId = 0x10001
SymbolicName = MSG_ERROR
Language = English
Error %1
.
</pre>
<p>When we compile it, we get this error: </p>
<pre>
MC : error : Message Id value (10001) too large
</pre>
<p>Our understanding is that we defined our message ID as a <code>DWORD</code> (which is an unsigned 32-bit integer), and the value <code>0x10001</code> easily fits inside an unsigned 32-bit integer. Is there a command line switch we need to pass to <code>mc.exe</code>? What are we missing? </p>
</blockquote>
<p>What they’re missing is that message identifiers are limited to the range 0 through 65535. </p>
<p>One place this limitation is visible is in the header file generated by the message compiler: </p>
<pre>
//
//  Values are 32 bit values laid out as follows:
//
//   3 3 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1
//   1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0
//  +-+-+-+-+-+---------------------+-------------------------------+
//  |S|R|C|N|r|    Facility         |               Code            |
//  +-+-+-+-+-+---------------------+-------------------------------+
//
//  where
//
//      S - Severity - indicates success/fail
//
//          0 - Success
//          1 - Fail (COERROR)
//
//      R - reserved portion of the facility code, corresponds to NT's
//              second severity bit.
//
//      C - reserved portion of the facility code, corresponds to NT's
//              C field.
//
//      N - reserved portion of the facility code. Used to indicate a
//              mapped NT status value.
//
//      r - reserved portion of the facility code. Reserved for internal
//              use. Used to indicate HRESULT values that are not status
//              values, but are instead message ids for display strings.
//
//      Facility - is the facility code
//
//      Code - is the facility's status code
//
</pre>
<p>Observe that the <code>Code</code> field is a 16-bit value. </p>
<p>A copy of this header block is also included in the <a href="https://msdn.microsoft.com/library/windows/desktop/aa363651(v=vs.85).aspx">documentation on event identifiers</a>. Though you have to realize that the thing that the message compiler spits out are event identifiers. </p>
<p>The 16-bit limit is also called out in the C# version of the trace logging interface: <a href="https://msdn.microsoft.com/library/system.diagnostics.tracing.eventattribute.eventid(v=vs.110).aspx"><code>Event­Attribute.Event­Id</code></a> says that “This value should be between 0 and 65535.” </p>
<p>But again, this requires that you realize that message files are related to event logging. </p>
<p>One thing that may nudge you to that realization is that <a href="https://msdn.microsoft.com/library/windows/desktop/aa363669(v=vs.85).aspx">the documentation for Message Files</a> is in the <i>Event Logging</i> section of MSDN, and it opens with the sentence, “Each <a href="https://msdn.microsoft.com/library/windows/desktop/aa363661(v=vs.85).aspx">event source</a> should register message files that contain…” </p>
<p>But perhaps the smoking gun is that the documentation for the Message File syntax says <a href="https://msdn.microsoft.com/library/windows/desktop/dd996906(v=vs.85).aspx">Any value specified must fit in 16 bits</a>. </p>


</body>