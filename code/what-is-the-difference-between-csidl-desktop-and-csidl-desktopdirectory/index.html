<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What is the difference between CSIDL_DESKTOP and CSIDL_DESKTOPDIRECTORY?</h1>  <!-- .entry-meta -->

<p>Among the various <code>CSIDL</code> values you can pass to functions like <code>SHGetSpecialFolderLocation</code> are <code>CSIDL_DESKTOP</code> and <code>CSIDL_DESKTOPDIRECTORY</code>. What’s the difference between them?
 The <code>CSIDL_DESKTOP</code> is the virtual folder that represents the desktop. The contents of this virtual folder is what gets displayed on top of your wallpaper.
 The <code>CSIDL_DESKTOP</code> virtual folder is populated from various locations, some of them virtual, and some of them physical. The <code>CSIDL_DESKTOPDIRECTORY</code> special folder is a physical folder that contains the files that you think of as on your desktop. These are the files that you’ve saved to your desktop, files that you’ve dragged to your desktop, that sort of thing. Some files on the desktop come from <code>CSIDL_COMMON_DESKTOPDIRECTORY</code>, which is the shared desktop. Files in the shared desktop directory are visible to all users.
 What does this mean for you, the programmer? (Well, assuming you are still using <code>CSIDL</code> values and haven’t switched over to the new <code>FOLDERID</code> model.)
 Programs shouldn’t care about <code>CSIDL_DESKTOPDIRECTORY</code>; they should just operate on <code>CSIDL_DESKTOP</code>, because that’s what the user sees. If you want to generate an <code>ITEMIDLIST</code> for a file on the desktop, use the <code>CSIDL_DESKTOP</code> folder. The physical folder behind the desktop can change (for example, due to <a href="http://blogs.msdn.com/oldnewthing/archive/2005/06/30/434209.aspx"> roaming user profiles</a>), but the logical location on the desktop remains fixed. If you had generated the <code>ITEMIDLIST</code> based on  <code>CSIDL_DESKTOPDIRECTORY</code>, then the experience for your users will be much more annoying: They will get file not found errors if the user profile roams to another machine (since the directory has changed). If they perform a <i>Save As</i> operation, the default save location will be some deep file system path instead of just being the desktop.</p>
<p> The <code>CSIDL_DESKTOPDIRECTORY</code> is the plumbing behind the scenes. Don’t show it to the user; it’s ugly. </p>


</body>