<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">When I send a WM_GETFONT message to a window, why don't I get a font?</h1>  <!-- .entry-meta -->

<p>A customer reported that the <code>WM_GET­FONT</code> message was not working. Specifically, they sent the message to a window, and they can plainly see that the window is rendering with a particular font, yet the <code>WM_GET­FONT</code> message returns 0. Why isn’t the window returning the correct font handle?
 The <code>WM_SET­FONT</code> and <code>WM_GET­FONT</code> messages are not mandatory. A window may choose to support them, or it may choose not to, or it may even choose to support one but not the other. (Though if it supports <code>WM_SET­FONT</code>, it probably ought to support <code>WM_GET­FONT</code>.)
 For example, our <a href="http://blogs.msdn.com/b/oldnewthing/archive/2003/07/25/54582.aspx"> scroll bar program</a> creates a custom font for the items in the list, but it does not implement the <code>WM_SET­FONT</code> or <code>WM_GET­FONT</code> messages. If you try to change the font via <code>WM_SET­FONT</code>, nothing happens. If you ask for the font via <code>WM_GET­FONT</code>, you get nothing back.
 A control might ignore your attempt to change the font if it already has its own notion of what font it should be using. Or maybe the control shows content in multiple fonts, so the concept of “the” font does not map well to the render model. (What would <code>WM_GET­FONT</code> on an HTML control return?) Or maybe the control doesn’t use GDI fonts at all. (Maybe it uses Direct­Write.)
 That’s one of the reasons why <a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/09/12/8945692.aspx"> the rules for the <code>WM_SET­FONT</code></a> are set up the way they are. Since there is no way to tell whether a window did anything in response to the <code>WM_SET­FONT</code> message, there would be no way to know whether responsibility for destroying the font should be transferred to the control or retained by the caller.</p>
<p> Controls that are designed to be used in dialog boxes are the ones most likely to support the <code>WM_SET­FONT</code> message, since that’s the message the dialog manager uses to tell each control the font specified in the dialog box template. The hope is that all of the controls will respect that font, so that the controls on the dialog box have a consistent appearance. But there’s nothing preventing a control from saying, “Screw you. I’m drawing with OCR-A and there’s nothing you can do to stop me.” </p>


</body>