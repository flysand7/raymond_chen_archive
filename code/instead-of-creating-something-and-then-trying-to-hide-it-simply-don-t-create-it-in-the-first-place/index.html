<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Instead of creating something and then trying to hide it, simply don't create it in the first place</h1>  <!-- .entry-meta -->

<p>A customer had a question, which was sort of <a href="http://blogs.msdn.com/b/oldnewthing/archive/2006/11/01/922449.aspx"> <i>I bet somebody got a really nice bonus for that feature</i></a> in reverse.</p>
<blockquote class="q"><p>  A customer is asking if there is a way to programmatically control the icons in the notification area. </p>
<p> Specifically, they want the setting for their notification icon to be “Only show notifications” rather than “Show icon and notifications” or “Hide icon and notifications.” </p>
<table border="0" cellpadding="3" style="border-collapse: collapse">
<tr>
<td style="border-bottom: solid .75pt black"><b>Icons</b></td>
<td colspan="2" style="border-bottom: solid .75pt black"><b>Behaviors</b></td>
</tr>
<tr>
<td>Power</td>
<td rowspan="2">
<table cellpadding="0" style="width: 100%;border: solid .75pt black">
<tr>
<td>Show icon and notifications</td>
<td>▾</td>
</tr>
</table>
</td>
</tr>
<tr>
<td style="color: gray"><i>Fully charged (100%)</i></td>
</tr>
<tr>
<td>Network</td>
<td rowspan="2">
<table cellpadding="0" style="width: 100%;border: solid .75pt black">
<tr>
<td>Show icon and notifications</td>
<td>▾</td>
</tr>
</table>
</td>
</tr>
<tr>
<td style="color: gray"><i>Fabrikam Internet access</i></td>
</tr>
<tr>
<td>Volume</td>
<td rowspan="2">
<table cellpadding="0" style="width: 100%;border: solid .75pt black">
<tr>
<td>Show icon and notifications</td>
<td>▾</td>
</tr>
</table>
</td>
</tr>
<tr>
<td style="color: gray"><i>Speakers: 10%</i></td>
</tr>
<tr style="background: yellow">
<td>Contoso Resource Notification</td>
<td rowspan="2">
<table cellpadding="0" style="width: 100%;border: solid .75pt black">
<tr>
<td>Only show notifications</td>
<td>▾</td>
</tr>
</table>
</td>
</tr>
<tr style="background: yellow">
<td style="color: gray"><i>No new resources found.</i></td>
</tr>
</table>
</blockquote>
<p> It’s a good thing the customer explained what they wanted, because they started out asking for the impossible part. Arbitrary control of notification icons is not programmatically exposed because all the awesome programs would just force themselves on. But they clarified that what they really want is a way to reduce the visibility of their icon so it displays only when a notification is being shown.
 And there’s a way to do that, and it doesn’t involve having to programmatically configure anything.
 If you don’t want your notification icon to appear in the notification area, then <i>don’t show your notification icon in the first place</i> unless you have a notification.</p>
<ul>
<li>When your program starts, don’t call     <code>Shell_Notify­Icon(NIM_ADD)</code>.     Since you don’t call the function, you don’t get a notification icon. </li>
<li>When you want to display a notification,     call     <code>Shell_Notify­Icon(NIM_ADD)</code>. </li>
<li>When the situation that calls for the notification has passed,     call     <code>Shell_Notify­Icon(NIM_REMOVE)</code>. </li>
</ul>
<p> In other words, use the notification icon in the manner it was intended.</p>
<p> It’s sad that notification icon abuse has become so popular (and application frameworks make it so easy to create an abusive notification icon) that people forget how to create a well-behaved notification icon. Instead, they start with the abusive method, and then try to figure out how to make it less abusive. </p>


</body>