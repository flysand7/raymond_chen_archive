<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Fixups are not the same as rewriting code, they’re just fixups</h1>  <!-- .entry-meta -->

<p>Classically speaking, a linker cannot rewrite the code the compiler generated; its job is merely to resolve symbols. Of course, resolving symbols means that references to those symbols in the code generated by the compiler turn from “I don’t know” to “Here it is.” Somebody named George <a href="http://groups.google.com/groups?selm=2EAD77B3-CB96-4FB7-9019-70D272D4B65B%40microsoft.com"> appeared to be confused by this</a>, believing that all changes by the linker counted as “rewriting code.”</p>
<p> Obviously if the linker weren’t allowed to change anything at all, there wouldn’t be much point to having a linker. For example, you wouldn’t be able to access functions or variables in a separate compilation unit (for example, from a library) because the compiler doesn’t know what the final address is; that’s what the linker is supposed to figure out. (Indeed, if <a href="http://msdn2.microsoft.com/en-us/library/xsa71f43.aspx"> function-level linking</a> is enabled, then even calls within a compilation unit are left as <i>insert address here</i>.) The linker resolves symbols and patches up code references that used to say <i>insert address here</i> so that they contain the actual address. </p>
<p> I think George took my statement a bit too literally. The linker can’t change a direct call to an indirect call; that’s not something that the compiler told the linker how to do. All the linker can do is patch up <i>insert address here</i> fixups. It can’t say “Oh, I’m going to take your two <code>mov</code> instructions and reverse the destination registers, and then flip the arguments to the subsequent <code>sub</code> instruction.” (I’m talking about classical linking; the introduction of <a href="http://msdn.microsoft.com/msdnmag/issues/02/05/Hood/"> link-time code generation</a> further blurs the line between the compiler and the linker.) </p>
<p> George also made the common mistake not only of calling this Web site a “document from MSDN” but also applying the same description to a <i>Microsoft Systems Journal</i> article from 1997. The back issues of MSJ are included in MSDN as a courtesy. Neither the back issues nor the contents of this Web site are under MSDN editorial control. </p>


</body>