<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">One of my favorite error codes: Optional parameter missing</h1>  <!-- .entry-meta -->

<p>The error <i>Optional parameter missing</i> sounds awfully paradoxical, doesn’t it. I mean, if the parameter is optional, why are you complaining that it’s missing?
 <a href="http://support.microsoft.com/kb/154039"> This KB article explains why</a>, specifically, the part that says, “If a parameter is omitted, the calling program must…”.
 For those who don’t want to click through, here’s the deal: Methods described in a type library can declare parameters as optional. Optional parameters must come at the end of the parameter list, of course. The catch is how you programmatically invoke a method that contains optional parameters.
 If you want to call a method that has optional parameters, you still have to pass the parameters. But you have to pass them a special way so that the method knows that they were omitted. (Specifically, you have to pass them as type <code>VT_ERROR</code>, code <code>DISP_E_PARAM­NOT­FOUND</code>.)
 In other words, an optional parameter is optional from the high-level language, but it isn’t optional at the low-level interface. Rather the <code>optional</code> keyword instructs the scripting engine to deploy syntactic sugar and allow the script to omit the parameters. The scripting engine then must follow specific rules in providing values for the parameters that were omitted by the script author.</p>
<p> In the lingo of C# and C++, a parameter declared <code>optional</code> in the TLB is really a mandatory parameter whose default value is <code>DISP_E_PARAM­NOT­FOUND</code>. </p>


</body>