<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why isn’t the original window order always preserved when you undo an Aero Shake?</h1>  <!-- .entry-meta -->

<p>A customer reported that when they used Aero Shake to minimize all the windows on their desktop, and then used it again to restore all the windows, the restored windows didn’t always have exactly the same z-order as they did originally. The customer wanted to know whether this was expected. </p>
<p>It’s not expected, but it’s not unexpected either. </p>
<p>Aero Shake is a shortcut for the <i>Minimize All</i> and <i>Undo Minimize All</i> commands, and consequently it is subject to all the same constraints as those commands. In particular, <a href="https://blogs.msdn.microsoft.com/oldnewthing/20040909-00/?p=37913">it makes a best-effort attempt to restore the windows in the correct order</a>, but if there’s a window that is slow to restore, Explorer doesn’t sit around and wait for the window to finish restoring. It just moves ahead and restores the next window. That way, a hung app doesn’t prevent Explorer from restoring your windows. </p>


</body>