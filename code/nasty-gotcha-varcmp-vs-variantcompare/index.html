<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Nasty gotcha: VarCmp vs VariantCompare</h1>  <!-- .entry-meta -->

<p>There are two functions for comparing <code>VARIANT</code>s. One comes from the COM team, called <code>VarCmp</code>. Assuming a successful comparison, it returns </p>
<table border="1" cellpadding="3" style="border-collapse: collapse">
<tr>
<th>Comparison</th>
<th>Return value</th>
</tr>
<tr>
<td>Less than</td>
<td>0 = <code>VARCMP_LT</code></td>
</tr>
<tr>
<td>Equal to</td>
<td>1 = <code>VARCMP_EQ</code></td>
</tr>
<tr>
<td>Greater than</td>
<td>2 = <code>VARCMP_GT</code></td>
</tr>
</table>
<p>This is consistent with the other <code>Var­Xxx</code> functions. </p>
<p>On the other hand, the <code>Variant­Compare</code> function comes from the shell, and it returns </p>
<table border="1" cellpadding="3" style="border-collapse: collapse">
<tr>
<th>Comparison</th>
<th>Return value</th>
</tr>
<tr>
<td>Less than</td>
<td align="right">−1</td>
</tr>
<tr>
<td>Equal to</td>
<td align="right">0</td>
</tr>
<tr>
<td>Greater than</td>
<td align="right">+1</td>
</tr>
</table>
<p>Yuck. </p>
<p>So be careful which one you’re calling and how you’re testing the result. </p>


</body>