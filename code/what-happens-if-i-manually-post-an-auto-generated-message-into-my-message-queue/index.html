<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What happens if I manually post an auto-generated message into my message queue?</h1>  <!-- .entry-meta -->

<p>As we well know, the window manager <a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/05/23/10420741.aspx"> generates various messages on-demand</a> rather than posting them into the queue at the time the event occurs. But what happens if you manually post one of these messages, like <code>Post­Message(hwnd, WM_PAINT, 0, 0)</code>? Does that clear the internal flag that says “This window needs a paint message?”</p>
<p> Nope. </p>
<p> The window manager <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/09/26/10216420.aspx"> does not have a prank call detector</a>. If you post a fake <code>WM_PAINT</code> message, then a fake <code>WM_PAINT</code> message shows up in the message queue. The part of the window manager which manages the “Does this window need to be repainted?” does not wiretap every telephone call to see if somebody is prank-calling a window with the <code>WM_PAINT</code> message, and then say, “You know what? I’m going to make that prank call a reality and make it act like a real <code>WM_PAINT</code> message.” </p>
<p> Imagine if the act of prank-calling somebody <a href="http://answers.yahoo.com/question/index?qid=20070912174540AAHge9P"> caused Prince Albert to stop by for a visit</a>! </p>
<p> In particular, the posted message goes into the posted message queue and will rise to the front of the queue as messages are retrieved. On the other hand, the auto-generated message will remain in its proto-message state until the queue is finally empty. </p>
<p> It then follows as a consequence that if you post one of these auto-generated messages, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/12/19/10249000.aspx#10250473"> like <code>WM_TIMER</code> message</a>, you don’t get any magical coalescing behavior because the coalescing happens as part of the auto-generation, not as part of the <code>Post­Message</code>. These prank-call messages also appear in the message queue in posted order rather than being generated at low priority like normal auto-generated messages. </p>


</body>