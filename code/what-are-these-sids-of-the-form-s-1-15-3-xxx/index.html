<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What are these SIDs of the form S-1-15-3-xxx?</h1>  <!-- .entry-meta -->

<p>Last time, we decoded the mysterious S-1-15-2-xxx SIDs. Another family of SIDs you may run across are the S-1-15-3-xxx SIDs.</p>
<p>SIDs of the form S-1-15-3-xxx are app capability SIDs. These SIDs are present in the token of apps running in an app container, and they encode the app capabilities possessed by the app.</p>
<p>As I noted last time, the rules for <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control"> Mandatory Integrity Control</a> say that objects default to allowing write access only to medium integrity level (IL) or higher. Granting access to these app capability SIDs permit access from apps running at low IL, provided they possess the matching capability.</p>
<table border="1" cellpadding="3" cellspacing="0" class="cp3" style="border-collapse: collapse;">
<tbody>
<tr>
<th>SID</th>
<th>Description</th>
</tr>
<tr>
<td align="center" colspan="2">Explicitly assigned</td>
</tr>
<tr>
<td>S-1-15-3-1</td>
<td>internetClient</td>
</tr>
<tr>
<td>S-1-15-3-2</td>
<td>internetClientServer</td>
</tr>
<tr>
<td>S-1-15-3-3</td>
<td>privateNetworkClientServer</td>
</tr>
<tr>
<td>S-1-15-3-4</td>
<td>picturesLibrary</td>
</tr>
<tr>
<td>S-1-15-3-5</td>
<td>videosLibrary</td>
</tr>
<tr>
<td>S-1-15-3-6</td>
<td>musicLibrary</td>
</tr>
<tr>
<td>S-1-15-3-7</td>
<td>documentsLibrary</td>
</tr>
<tr>
<td>S-1-15-3-8</td>
<td>enterpriseAuthentication</td>
</tr>
<tr>
<td>S-1-15-3-9</td>
<td>sharedUserCertificates</td>
</tr>
<tr>
<td>S-1-15-3-10</td>
<td>removableStorage</td>
</tr>
<tr>
<td>S-1-15-3-11</td>
<td>appointments</td>
</tr>
<tr>
<td>S-1-15-3-12</td>
<td>contacts</td>
</tr>
<tr>
<td>S-1-15-3-4096</td>
<td>internetExplorer</td>
</tr>
<tr>
<td align="center" colspan="2">Autogenerated</td>
</tr>
<tr>
<td>S-1-15-3-x1-x2-x3-x4</td>
<td>device capability</td>
</tr>
<tr>
<td>S-1-15-3-1024-x1-x2-x3-x4-x5-x6-x7-x8</td>
<td>app capability</td>
</tr>
</tbody>
</table>
<p>You can sort of see how these assignments evolved. At first, the capability RIDs were assigned by an assigned numbers authority, so anybody who wanted a capability had to apply for a number. After about a dozen of these, the assigned numbers team (probably just one person) realized that this had the potential to become a real bottleneck, so they switched to an autogeneration mechanism, so that people who needed a capability SID could just generate their own.</p>
<p>For device capabilities, the four 32-bit decimal digits represent the 16 bytes of the device interface GUID. Let’s decode this one: S-1-15-3-787448254-1207972858-3558633622-1059886964.</p>
<table border="0" cellpadding="3" cellspacing="0" class="cp3" style="border-collapse: collapse; text-align: center;">
<tbody>
<tr>
<td colspan="4">787448254</td>
<td colspan="4">1207972858</td>
<td colspan="4">3558633622</td>
<td colspan="4">1059886964</td>
</tr>
<tr>
<td colspan="4" style="border: solid 1px black;"><code>0x2eef81be</code></td>
<td colspan="4" style="border: solid 1px black;"><code>0x480033fa</code></td>
<td colspan="4" style="border: solid 1px black;"><code>0xd41c7096</code></td>
<td colspan="4" style="border: solid 1px black;"><code>0x3f2c9774</code></td>
</tr>
<tr>
<td style="border: solid 1px black;"><code>be</code></td>
<td style="border: solid 1px black;"><code>81</code></td>
<td style="border: solid 1px black;"><code>ef</code></td>
<td style="border: solid 1px black;"><code>2e</code></td>
<td style="border: solid 1px black;"><code>fa</code></td>
<td style="border: solid 1px black;"><code>33</code></td>
<td style="border: solid 1px black;"><code>00</code></td>
<td style="border: solid 1px black;"><code>48</code></td>
<td style="border: solid 1px black;"><code>96</code></td>
<td style="border: solid 1px black;"><code>70</code></td>
<td style="border: solid 1px black;"><code>1c</code></td>
<td style="border: solid 1px black;"><code>d4</code></td>
<td style="border: solid 1px black;"><code>74</code></td>
<td style="border: solid 1px black;"><code>97</code></td>
<td style="border: solid 1px black;"><code>2c</code></td>
<td style="border: solid 1px black;"><code>3f</code></td>
</tr>
<tr>
<td colspan="4" style="border: solid 1px black;"><code>2eef81be</code></td>
<td colspan="2" style="border: solid 1px black;"><code>33fa</code></td>
<td colspan="2" style="border: solid 1px black;"><code>4800</code></td>
<td style="border: solid 1px black;"><code>96</code></td>
<td style="border: solid 1px black;"><code>70</code></td>
<td style="border: solid 1px black;"><code>1c</code></td>
<td style="border: solid 1px black;"><code>d4</code></td>
<td style="border: solid 1px black;"><code>74</code></td>
<td style="border: solid 1px black;"><code>97</code></td>
<td style="border: solid 1px black;"><code>2c</code></td>
<td style="border: solid 1px black;"><code>3f</code></td>
</tr>
<tr>
<td colspan="4"><code>{2eef81be-</code></td>
<td colspan="2"><code>33fa<span style="position: relative;"><span style="position: absolute;">-</span></span></code></td>
<td colspan="2"><code>4800<span style="position: relative;"><span style="position: absolute;">-</span></span></code></td>
<td><code>96</code></td>
<td><code>70<span style="position: relative;"><span style="position: absolute;">-</span></span></code></td>
<td><code>1c</code></td>
<td><code>d4</code></td>
<td><code>74</code></td>
<td><code>97</code></td>
<td><code>2c</code></td>
<td><code>3f<span style="position: relative;"><span style="position: absolute;">}</span></span></code></td>
</tr>
</tbody>
</table>
<p>And we recognize <code>{2eef81be-33fa-4800-9670-1cd474972c3f}</code> as <code>DEVINTERFACE_<wbr/>AUDIO_<wbr/>CAPTURE</code>, so this is the microphone device capability.</p>
<p>For app capabilities, the eight 32-bit decimal numbers represent the 32 bytes of the SHA256 hash of the capability name. You can programmatically generate these app capability SIDs by calling <a href="https://docs.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-derivecapabilitysidsfromname"> <code>Derive­Capability­Sids­From­Name</code></a>.</p>


</body>