<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I create a toolbar that sits in the taskbar?</h1>  <!-- .entry-meta -->

<p>Commenter Nick asks, “<a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#677853">How would you go about creating a special toolbar to sit on the taskbar like the Windows Media Player 10 minimised toolbar</a>?”
 You would look at the <a href="http://msdn.microsoft.com/en-us/library/ms716696.aspx"> DeskBand API SDK Sample</a> in the Windows Platform SDK.
 The magic word is DeskBand. <a href="http://msdn.microsoft.com/en-us/library/bb776819(VS.85).aspx"> This MSDN page has an overview</a>.
 <b>Bonus chatter</b>: I’ve seen some online speculation as to whether a DeskBand counts as a shell extension, because of the <a href="http://blogs.msdn.com/oldnewthing/archive/2006/12/18/1317290.aspx"> guidance against writing shell extensions in managed code</a>. As with all guidance, you need to <a href="http://blogs.msdn.com/oldnewthing/archive/2009/11/04/9917052.aspx"> understand the rationale behind the guidance</a> so you can apply the guidance intelligently instead of merely following it blindly off a cliff. Summarizing the rationale: Since only one version of the CLR can exist in a process, any shell extension which runs inside the host process which uses the CLR may inject a version of the CLR that conflicts with the version of the CLR the host process (or some other component in the host process) wants to use. Now that you understand the reason, you also can answer the question, “Is a DeskBand a shell extension (for the purpose of this guidance)?” Yes, because DeskBands (like all other COM objects registered as in-process servers) run inside the host process.</p>
<p> As another example of how understanding the rationale behind guidance lets you know when the guidance no longer applies: In the time since the original guidance was developed, the CLR team came up with a way to <a href="https://channel9.msdn.com/shows/Going+Deep/CLR-4-Side-by-Side-In-Process-What-How-Why/"> run multiple versions of the CLR inside a single process (for specific values of “multiple”)</a>. Therefore, if you use one of those “I won’t conflict with other versions of the CLR inside the same process” versions, then you can see that the rationale behind the guidance no longer applies. </p>


</body>