<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does TaskDialog return immediately without showing a dialog?</h1>  <!-- .entry-meta -->

<p>A customer reported a problem with the <code>Task­Dialog</code> function.</p>
<blockquote class="q"><p>  We’ve encountered a strange behavior in the <code>Task­Dialog</code> function. A user reported that when exiting our application, our program played an error beep that didn’t appear to be associated with an error. After investigating, we found that the sound is coming from our application trying to display an error dialog before closing by calling <code>Task­Dialog</code>. The error beep is played but no dialog appears. </p>
<p> Some background on the error condition that we’re trying to report: We’re calling <code>Create­Window­Ex</code>, and the window procedure creates another window in its <code>WM_CREATE</code> handler. It looks like the original window is destroyed before <code>WM_CREATE</code> is finished, so <code>Create­Window­Ex</code> returns <code>ERROR_INVALID_WINDOW_HANDLE</code>. It’s not clear why this is causing <code>Task­Dialog</code> to fail, but this is the only scenario where we see this behavior. All other calls to <code>Task­Dialog</code> work as expected. We know how to fix the original problem with <code>Create­Window­Ex</code>, but we would like to understand what’s going on with <code>Task­Dialog</code> in case there’s another bug here. </p>
</blockquote>
<p> With a little bit of psychic powers, you can solve this customer’s problem too.</p>
<p> (If you have a good memory, you may have noticed that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/05/20/8520129.aspx"> it’s a variation on a previous puzzle</a>. But I get to keep recycling it because every year, a new batch of developers stumbles across the problem.) </p>


</body>