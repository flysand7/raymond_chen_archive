<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What's the difference between LVM_HITTEST and LVM_INSERTMARKHITTEST?</h1>  <!-- .entry-meta -->

<p>One customer was confused by the two list view hit-test messages <code>LVM_HITTEST</code> and <code>LVM_INSERTMARKHITTEST</code>. What is the difference between the two?
 The <code>LVM_HITTEST</code> message tries to find the item the point is <i>over</i>.
 The <code>LVM_INSERTMARKHITTEST</code> message tries to find the item the point is <i>next to</i>.
 For example, suppose you have two 32×32 items, item zero at (0, 0) and item one at (0, 32).</p>
<table>
<tr>
<th>Coordinates</th>
<th><code>LVM_HITTEST</code></th>
<th><code>LVM_INSERTMARKHITTEST</code></th>
</tr>
<tr>
<td>(0, 34)</td>
<td>On item 1</td>
<td>Next to item 1 on the top side</td>
</tr>
<tr>
<td>(0, 99)</td>
<td>Nowhere</td>
<td>Next to item 1 on the bottom side</td>
</tr>
</table>
<p> You use <code>LVM_HITTEST</code> when you the user is dragging something and you want to see what the item is going to be dropped <i>on</i>. For example, your program might ask the user to drag an icon representing a trouble report and drop it onto the icon representing the department the report should be assigned to.
 You use <code>LVM_INSERTMARKHITTEST</code> when the user is dragging something and you want to see what the item is going to be dropped <i>between</i>. For example, your program might show a list of customers, and the user can drag a new customer into the list or rearrange the customers by dragging an existing one. The <code>LVM_INSERTMARKHITTEST</code> message tells you where the dropped item should go.</p>
<p> The shell uses both of these hit-test messages when you drop a file into an Explorer window. It uses the Explorer uses <code>LVM_HITTEST</code> to determine whether you’re dropping the file onto an item in the folder (hit-test reports an item) or whether you’re dropping the file into the folder itself (hit-test reports nowhere). Furthermore, if you’re dropping into the folder and Auto-Arrange is enabled, then Explorer uses the <code>LVM_INSERTMARKHITTEST</code> to determine where to place the item after it is dropped. </p>


</body>