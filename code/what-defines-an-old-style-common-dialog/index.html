<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What defines an old-style common dialog?</h1>  <!-- .entry-meta -->

<p>In the documentation for the <code>OPEN­FILE­NAME</code> structure, there are many references to “old-style” dialogs. What is an old-style dialog, how do you get one, and how is it different from a new-style dialog?</p>
<p>So-called “old-style” dialogs are the File Open and File Save dialogs from Windows 3.1. Here’s roughly what they looked like:</p>

<p>These are not the “new” style dialogs that resemble an Explorer window. They are the old-fashioned dialogs that scream “I was written in the early 1990s!”</p>
<p>When you use an old-style dialog, Windows basically uses the code that was originally written for Windows 3.1, because programs from that era don’t support fancy things like long file names, and when they try to customize the dialog, they are expecting to customize a Windows 3.1-style dialog, so that’s what we give them.</p>
<p>Here are the main differences between the old style and new style dialogs:</p>
<table border="1" cellpadding="3" cellspacing="0" class="cp3" style="border-collapse: collapse;">
<tbody>
<tr>
<th>Feature</th>
<th>Old-style</th>
<th>New-style</th>
</tr>
<tr>
<td>Long file names</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Resizability</td>
<td>Not resizable</td>
<td>Resizable</td>
</tr>
<tr>
<td>Multiselect</td>
<td>Space-separated file names</td>
<td>Null-separated file names</td>
</tr>
<tr>
<td>Template</td>
<td>Replaces entire dialog</td>
<td>Embedded into existing dialog</td>
</tr>
<tr>
<td>Default extension</td>
<td>Maximum 3 characters</td>
<td>Can exceed 3 characters</td>
</tr>
<tr>
<td>Hooks</td>
<td>Windows 3.1-style</td>
<td>Windows 95-style</td>
</tr>
</tbody>
</table>
<p>The system decides whether you get an old-style or new-style dialog based on the following rules:</p>
<ul>
<li>If you say <code>OFN_<wbr/>EXPLORER</code>, then you get a new-style dialog.</li>
<li>If you don’t say <code>OFN_<wbr/>EXPLORER</code>, and you do say <code>OFN_<code></code>ENABLE­TEMPLATE</code>, <code>OFN_<code></code>ENABLE­TEMPLATE­HANDLE</code>, <code>OFN_<code></code>ENABLE­HOOK</code>, or <code>OFN_<code></code>ALLOW­MULTI­SELECT</code>, then you get an old-style dialog.</li>
<li>If you don’t say anything on the above list, then you get a new-style dialog.</li>
</ul>
<p>In words: You get an old-style dialog if you ask for any of <code>OFN_<code></code>ENABLE­TEMPLATE</code>, <code>OFN_<code></code>ENABLE­TEMPLATE­HANDLE</code>, <code>OFN_<code></code>ENABLE­HOOK</code>, or <code>OFN_<code></code>ALLOW­MULTI­SELECT</code>, since those are the things that affect the programmatic behavior of the dialog. However, you can override this by saying <code>OFN_<wbr/>EXPLORER</code> to say, “No really, I’m okay with the new hotness.”</p>


</body>