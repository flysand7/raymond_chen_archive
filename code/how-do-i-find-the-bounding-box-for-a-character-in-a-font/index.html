<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I find the bounding box for a character in a font?</h1>  <!-- .entry-meta -->

<p>
A customer had the following question:
</p>
<blockquote class="q"><p>
I’m looking for a way to get the height of text which consists
entirely of digits, for example <code>"123"</code>,
as these characters do not have any descent or internal leading.
I expected functions like
<a href="http://msdn.microsoft.com/en-us/library/dd144937(VS.85).aspx">
<code>Get­Text­Extent</code></a>
to return the character’s ascent minus the internal leading, but
in fact it returns the ascent plus the descent plus the internal leading.
I considered getting the font metrics and taking the
<code>TEXT­METRICS.tmAscent</code>, but I’m worried that
numbers in other languages might have a nonzero descent and internal
leading.
Is there a function I can call to return the “real” height of the
text?
</p></blockquote>
<p>
Well, first of all, this question makes an assumption about digits
that isn’t even true in English.
Fonts developed in recent years
tend to keep all digits the same height (and often
the same width), but fonts
designed before the advent of computers
(or computer fonts which were inspired by old-timey fonts)
will often vary the height, and sometimes even have digits
with descenders.
Here’s an example from the font Georgia:
</p>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr style="height: 1ex">
<td bgcolor="white" colspan="15" style="width: 15ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="white" colspan="14" style="width: 14ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="white" colspan="9" style="width: 9ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="white" style="width: 1ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" colspan="3" style="width: 3ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="5" style="width: 5ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="2" style="width: 2ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="6" style="width: 6ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="2" style="width: 2ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="5" style="width: 5ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="2" style="width: 2ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" colspan="2" style="width: 2ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="6" style="width: 6ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="white" style="width: 1ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" colspan="7" style="width: 7ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="2" style="width: 2ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" style="width: 1ex"></td>
</tr>
<tr style="height: .75pt">
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="white" colspan="7" style="width: 7ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="4" style="width: 4ex"></td>
<td bgcolor="black" style="width: 1ex"></td>
<td bgcolor="white" colspan="7" style="width: 7ex"></td>
</tr>
<tr style="height: 1ex">
<td bgcolor="white" colspan="8" style="width: 8ex"></td>
<td bgcolor="black" colspan="4" style="width: 4ex"></td>
<td bgcolor="white" colspan="8" style="width: 8ex"></td>
</tr>
</tbody>
</table>
<caption align="bottom"><font face="Georgia">058</font></caption>
<p>
Observe that the number zero is six pixels tall, whereas
the number eight is nine pixels tall,
and the number five has a two-pixel descender!
</p>
<p>
Okay, so you’re going to have to take the descent into account
for all languages, including English.
Internal leading is the space above a character to separate it
from elements above it.
For example, you need some space above a capital T so that
the horizontal bar remains readable.
Again, the assumption that English doesn’t need internal leading
is false.
</p>
<p>
Okay, but what about the original question?
Well, when I heard this question, my first thoughts went back
to the early days of Win32 when the coolest new GDI feature
was paths, and everybody was showing off
<a href="http://msdn.microsoft.com/en-us/library/dd183441(VS.85).aspx">
the fancy text effects
you could pull off with the aid of paths</a>.
My initial instinct was therefore to use the
<a href="http://www.microsoft.com/mspress/books/sampchap/2344c.aspx">
same technique</a>
as those cool demos by combining
<code>Begin­Path</code>,
<code>Text­Out</code>,
and <code>End­Path</code>.
Once I had a path, I could get its dimensions by using
<code>Path­To­Region</code> and <code>Get­Rgn­Box</code>.
</p>
<p>
Fortunately, it turns out that there’s an easier way.
The
<a href="http://msdn.microsoft.com/en-us/library/dd144891(VS.85).aspx">
<code>Get­Glyph­Outline</code></a> function
returns the glyph metrics, which describe the bounding box of the
pixels of a character.
</p>
<pre>
// Create an identity matrix
static const MAT2 c_mat2Identity = {
    { 0, 1 }, /* eM11 = 1.0 */
    { 0, 0 }, /* eM12 = 0.0 */
    { 0, 0 }, /* eM21 = 0.0 */
    { 0, 1 }, /* eM22 = 1.0 */
 };
GetGlyphOutline(hdc, L'0', GGO_METRICS, &amp;gm, 0, NULL, &amp;c_mat2Identity);
</pre>
<p>
The dimensions of the character are returned in the
<code>GLYPH­METRICS</code> structure, and in particular,
you can derive the bounding box from the
<code>gmptGlyph­Origin</code>,
<code>gmBlack­BoxX</code>, and
<code>gmBlack­BoxY</code> members.</p>


</body>