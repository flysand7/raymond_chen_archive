<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">A library loaded via LOAD_LIBRARY_AS_DATAFILE (or similar flags) doesn't get to play in any reindeer module games</h1>  <!-- .entry-meta -->

<p>If you load a library with the <code>LOAD_LIBRARY_AS_DATA­FILE</code> flag, then it isn’t really loaded in any normal sense. In fact, it’s kept completely <i>off the books</i>.
 If you load a library with the <code>LOAD_LIBRARY_AS_DATA­FILE</code>, <code>LOAD_LIBRARY_AS_DATA­FILE_EXCLUSIVE</code>, or <code>LOAD_LIBRARY_AS_IMAGE_RESOURCE</code> flag (or any similar flag added in the future), then the library gets mapped into the process address space, but it is not a true module. Functions like <code>Get­Module­Handle</code>, <code>Get­Module­File­Name</code>, <code>Enum­Process­Modules</code> and <code>Create­Toolhelp32­Snapshot</code> will not see the library, because it was never entered into the database of loaded modules.
 These “load library as…” flags don’t actually load the library in any meaningful sense. They just take the file and map it into memory manually without updating any module tracking databases. This functionality was overloaded into the <code>Load­Library­Ex</code> function, which in retrospect was probably not a good idea, because people expect <code>Load­Library­Ex</code> to create true modules, but these flags create <i>pseudo-modules</i>, a term I made up just now.
 It would have been less confusing in retrospect if the “load library as…” functionality were split into another function like <code>Load­File­As­Pseudo­Module</code>. Okay, that’s a pretty awful name, but that’s not the point. The point is to put the functionality in some function that doesn’t have the word <i>library</i> in its name.
 Okay, so now that we see that these pseudo-modules aren’t true modules, and they don’t participate in any <a href="http://en.wiktionary.org/wiki/reindeer_games"> reindeer module games</a>. So what use are they?
 Basically, the only thing you can do with a pseudo-module is access its resources with functions like <code>Find­Resource</code>, <code>Load­Resource</code>, and <code>Enum­Resource­Types</code>. Note that this indirectly includes functions like <code>Load­String</code>, and <code>Format­Message</code> which access resources behind the scenes.</p>
<p> So maybe a better name for the function would have been <code>Load­File­For­Resources</code>, since that’s all the pseudo-module is good for. </p>


</body>