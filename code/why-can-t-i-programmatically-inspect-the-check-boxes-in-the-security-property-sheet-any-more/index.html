<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why can’t I programmatically inspect the check boxes in the Security property sheet any more?</h1>  <!-- .entry-meta -->

<p>A customer reported that they used the <code>Create­Security­Page</code> function to create a security property sheet page. The <code>ISecurity­Information</code> object they provide uses the <code>ISecurity­Information::<wbr/>Property­Sheet­Page­Callback</code> method to obtain a handle to the property sheet page window, and then they use functions like <code>Is­Dlg­Button­Checked</code> to snoop on the check boxes on the page. Maybe they planned on launching fireworks if you set the security options the way they liked. Anyway, they found that this mechanism stopped working in Windows 8 and wanted to know when it would be fixed.</p>
<p>Okay, short answer: It’s not going to be fixed, since there is nothing broken in Windows. The broken thing is the customer’s program.</p>
<p>The purpose of the <code>ISecurity­Information::<wbr/>Property­Sheet­Page­Callback</code> method is to give you some insight into the life cycle of the page. The <code>PSPCB_<wbr/>CREATE</code> and <code>PSPCB_<wbr/>RELEASE</code> notifications represent the start and end of the page lifetime, and the <code>PSPCB_<wbr/>SI_<wbr/>INITDIALOG</code> notification lets you delay initialization until the page becomes active.</p>
<p>The window handle is provided so you have an anchor if you need to display an error message. It’s not there so you can reach in and start manipulating the controls on the page (whose control IDs have been and continue to remain undocumented).</p>
<p>In Windows 8, the security page was completely redesigned, and any old code that snooped at the controls on the page will stop working. Which, to be noted, is something you weren’t supposed to be doing anyway.</p>
<p>The way to react to the user’s actions is to respond to methods like <code>ISecurity­Information::<wbr/>Set­Security</code>, which tell you what the user ultimately settled upon and asks you to apply those changes to the underlying securable object. These methods are how the provider interacts with the page. Snooping around on the page controls is not supported, because those are implementation details and not part of the contract.</p>
<p>Windows 8 refreshed the security UI, and that means a new implementation, so anything that relied on undocumented details of the old implementation will stop working.</p>
<p>Still, this is another example of the difficulty of making any changes to the user interface: There’s a good chance that there’s somebody who has taken some sort of obscure dependency on how things used to work, and any change you make will cause some third-party program somewhere to break.</p>


</body>