<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why isn’t my shell namespace extension getting every single DragOver mouse message?</h1>  <!-- .entry-meta -->

<p>A customer had a shell namespace extension and discovered that when the user dragged an item, their custom drop target gets <code>Drag­Enter</code> and <code>Drag­Leave</code> method calls as expected, but the <code>Drag­Over</code> method calls are being throttled. Specifically, they get a new <code>Drag­Over</code> call only if the keyboard modifier state changes. How can they get a <code>Drag­Over</code> call for every mouse move?</p>
<p>Explorer calls the shell extension when significant events occur, such as the user dragging over a different item, but it doesn’t call out for insignificant events, like the mouse moving one pixel.</p>
<p>The customer explained that they found that the default drag feedback for shell extensions doesn’t match the default drag feedback used by Explorer. In particular, the little information box that says “Copy to…” or “Move to…” is missing. The customer wrote their own information box window to show that information, so they need the precise mouse location information so they can position the information box properly.</p>
<p>Oh, if it’s the information box you’re after, then you could have just asked for the information box. (Another case of an XY problem.)</p>
<p>Explorer uses the shell drag/drop helper, so you can use <a href="/code/drag-drop-effects-the-little-drop-information-box" title="Drag/drop effects: The little drop information box"> the <code>Set­Drop­Description</code> function</a> we wrote last time. That will put the information box next to the drag image in exactly the same way that Explorer does. (Because this is the same method that Explorer itself uses to put information into the info box.)</p>
<p>The customer was kind enough to write back. “It works perfectly.”</p>


</body>