<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The dangers of messing with activation when handling a WM_ACTIVATE message</h1>  <!-- .entry-meta -->

<p>This is basically the same thing as <a href="http://blogs.msdn.com/oldnewthing/archive/2005/08/08/448969.aspx"> The dangers of playing focus games when handling a WM_KILLFOCUS message</a>, just with activation in place of focus. <a href="http://groups-beta.google.com/group/microsoft.public.win32.programmer.ui/msg/7c9071f8e9153be4"> One developer discovered the hard way that if you mess with activation inside your WM_ACTIVATE handler, things get weird</a>. The author noted that if he posted a message and did the work from the posted message, then everything came out okay. </p>
<p> <a href="http://groups-beta.google.com/group/microsoft.public.win32.programmer.ui/msg/79cfde5ecae9fd9a"> A follow-up to the original message</a> noted that passing the <code>SWP_NOACTIVATE</code> flag to the <code>SetWindowPos</code> function solves the problem. Do you understand why? </p>


</body>