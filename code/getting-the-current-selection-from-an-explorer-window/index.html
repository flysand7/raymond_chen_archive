<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Getting the current selection from an Explorer window</h1>  <!-- .entry-meta -->

<p><p>
Today’s Little Program prints the current selection
in all open Explorer windows.
(This is an alternative to the
<a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/07/20/188696.aspx">
C++ version</a> that involves a ridiculous amount of typing.)
</p>
<pre>
var shellWindows = new ActiveXObject(“Shell.Application”).Windows();
for (var i = 0; i &lt; shellWindows.Count; i++) {
 var w = shellWindows.Item(i);
 WScript.StdOut.WriteLine(w.LocationName);
 var sel = w.Document.SelectedItems();
 for (var j = 0; j &lt; sel.Count; j++) {
  var item = sel.Item(j);
  WScript.StdOut.WriteLine(item.Name);
  WScript.StdOut.WriteLine(item.Path);
 }
}
</pre>
<p>
I have no idea why you would want to do this,
but there you have it.
(If you want the focused item rather than the selection, then get the
<code>Focused­Item</code> property.)
</p>
<p>
Okay, maybe you can use this as a quick-and-dirty way
to
<a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/02/04/10390725.aspx">
get the parsing name for a shell item</a>:
Open an Explorer window,
select the item you are interested in, then run the script to see
what gets printed out as the <code>Path</code>.
</p></p>


</body>