<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Accessing the current module’s HINSTANCE from a static library</h1>  <!-- .entry-meta -->

<p><p>
If you’re writing a static library, you may have need to access
the <code>HINSTANCE</code> of the module that you have been
linked into.
You could require that the module that links you in pass the
<code>HINSTANCE</code> to a special initialization function,
but odds are that people will forget to do this.
</p>
<p>
If you are using a Microsoft linker, you can take advantage of
a pseudovariable which the linker provides.
</p>
<pre>
EXTERN_C IMAGE_DOS_HEADER __ImageBase;
#define HINST_THISCOMPONENT ((HINSTANCE)&amp;__ImageBase)
</pre>
<p>
The pseudovariable <code>__ImageBase</code>
represents the DOS header of the module, which happens to
be what a Win32 module begins with.
In other words, it’s the base address of the module.
And the module base address is the same as its <code>HINSTANCE</code>.
</p>
<p>
So there’s your <code>HINSTANCE</code>.
</p>
<p>
[Raymond is currently on vacation; this message was pre-recorded.]
</p></p>


</body>