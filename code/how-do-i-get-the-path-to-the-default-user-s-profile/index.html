<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I get the path to the default user's profile?</h1>  <!-- .entry-meta -->

<p>A customer wanted to know how to get the path to the default user’s profile. On older versions of Windows, the default location of the default user’s profile was <code>C:\WINNT\Profiles\Default</code>. Then it moved to <code>C:\Documents and Settings\Default User</code>. Now it’s in <code>C:\Users\Default</code>. And the location may have been <a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/12/10/9188555.aspx"> customized</a>, so in principle it could be anywhere.
 The function to get the default user profile’s directory is is the deviously-named <code>Get­Default­User­Profile­Directory</code>.
 But the reason I’m writing this article is not to call your attention to the <code>Get­Default­User­Profile­Directory</code> function, but rather to something in the function documentation.
 The <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb762277(v=vs.85).aspx"> documentation for the <code>Get­Default­User­Profile­Directory</code> function</a> includes the strings <code>C:\Documents and Settings\Default User</code> and <code>C:\Users\Default</code>, so all somebody had to do was type either of those paths into a search engine scoped to MSDN, and it would have found the function to use.</p>
<p> This sort of counts as a counterexample to the suggestion that in order to help people find the correct function to use (instead of whacking an undocumented registry key), MSDN should include the path to the registry key so that a search for the undocumented registry key will kick up a page that says, “Do not use this registry key. Call this other function instead.” That experiment was attempted (inadvertently) with the <code>Get­Default­User­Profile­Directory</code> function, and it didn’t work. </p>


</body>