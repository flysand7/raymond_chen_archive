<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why do some shortcuts not support editing the command line and other properties?</h1>  <!-- .entry-meta -->

<p>Ben L observed that some shortcuts do not permit the command line and other options to be edited. “<a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/20/10040074.aspx#10040581">Where is this feature controlled? Is there a way to override this mode?</a>” This question is echoed by “Anonymous (Mosquito buzzing around)” (and don’t think we don’t know who you are), who in a huge laundry list of questions adds, “<a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/20/10040074.aspx#10040995">Why does the Game Explorer limit customizing command line, target, etc?</a>”
 These questions are looking at the situation backwards. The issue is not “Why do these shortcuts block editing the command line?” The issue is “Why do some shortcuts <i>allow</i> editing the command line?”
 Recall that shortcuts are references to objects in the shell namespace. Shell namespace objects are abstract. Some of them refer to files, but others refer to non-file objects, like control panels, printers, and dial-up networking connectoids. And in the abstract, these objects support verbs like <i>Open</i> and <i>Rename</i>. But there is no requirement that a shell namespace object support “Run with command line argument”.
 If you have a shortcut to <i>an executable</i>, then the LNK file handler says, “Okay, this is a special case. Executables support command line arguments, so I will run the executable with the command line arguments <a href="http://msdn.microsoft.com/en-us/library/bb774922%28v=vs.85%29.aspx"> set by the <code>IShell­Link::Set­Arguments</code> method</a>.
 Note that the shortcut target and arguments are separate properties. The LNK file property sheet hides this from you by calling <code>IShell­Link::Get­Path</code> and <code>IShell­Link::Get­Arguments</code>, then taking the two strings and combining them into a single <i>Target</i> field for display. When you save the changes, the LNK file property sheet takes the <i>Target</i>, figures out which part is the executable and which part is the arguments, and calls <code>IShell­Link::Set­Path</code> and <code>IShell­Link::Set­Arguments</code> on the two parts.
 In other words, the command line is all a ruse.
 This special action is performed only for executable targets, because those are the only things that accept arguments. If you create a shortcut to a control panel, you’ll find that the <i>Target</i> is not editable. If you create a shortcut to a printer, you’ll find that the <i>Target</i> is not editable. If you create a shortcut to a dial-up networking connectoid, you’ll find that the <i>Target</i> is not editable. Having a non-editable command line is the normal case. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/09/14/229387.aspx"> <i>The file system is the weirdo</i></a>.
 Shortcuts to advertise applications and shortcuts to items in the Games folder are not shortcuts to executables. They are shortcuts into the shell namespace for various types of virtual data. An advertised application is a shell namespace object that represents “an installed application”. It is not a pointer directly to the executable, but rather a reference to an entry in the MSI database, which in turn contains information about how to install the program, repair it, update it, and run it. The shell doesn’t even know what the command line is. To launch an advertised shortcut, the shell asks the MSI database for the command line, and it then executes that command line that MSI returns. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/12/23/10250556.aspx#10250792"> The value set by <code>IShell­Link::Set­Arguments</code> never enters the picture</a>. Similarly, the entries in the Games Folder are not executables; they are entries in the games database.</p>
<p> I can see how this can be confusing, because when you click on these shortcuts, <i>a program runs</i>, but these shortcuts are not shortcuts directly to programs. As a result, the code that takes a <i>Target</i> and <i>Arguments</i> and combines them into a command line does not get a chance to run. </p>


</body>