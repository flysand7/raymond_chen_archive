<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What is the logic behind the thumb size and position calculation in scroll bars?</h1>  <!-- .entry-meta -->

<p>Commenter <a href="http://sarathc.wordpress.com/">sarathc</a> asks, “How do we implement a custom scroll bar as Windows does? <a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#655245"> What is the logic behind the thumb size and position calculation</a>? How we could dynamically manage it?”
 Let’s look at the three questions in turn.
 To implement a custom scroll bar… don’t do it. It’s just not worth the effort, and there will almost always be little seams, like <a href="http://blogs.msdn.com/oldnewthing/archive/2005/02/11/371042.aspx"> not lighting up when the mouse hovers over them</a>.
 The logic behind the thumb size and position calculation I thought I covered <a href="http://blogs.msdn.com/oldnewthing/archive/2003/07/31/54601.aspx"> in my scroll bar series</a>. The size of the thumb relative to the size of the scroll bar is the same as the page size relative to the scroll bar range. In other words:</p>
<blockquote class="m"><p> thumb size / scroll bar size = page size / scroll bar range </p></blockquote>
<p> A little high school algebra tells you, then, that</p>
<blockquote class="m"><p> thumb size = scroll bar size * page size / scroll bar range </p></blockquote>
<p> There may be some off-by-one errors in the above formula, and some special tweaks for extreme cases (you don’t want a thumb smaller than one pixel after all), but that’s the basic idea.
 Similarly, the screen position of the thumb relative to the scroll bar is equal to the programmatic thumb position relative to the scroll bar range (roughly).</p>
<p> To dynamically manage it, use the usual scroll bar functions like <code>SetScrollInfo</code>. </p>


</body>