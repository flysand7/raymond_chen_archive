<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Isn't DDE all asynchronous anyway?</h1>  <!-- .entry-meta -->

<p>“<a href="http://blogs.msdn.com/oldnewthing/archive/2005/06/27/432303.aspx#433091">Isn’t DDE all asynchronous anyway?</a>” asks commenter KaiArnold.
 It’s mostly asynchronous, but not entirely.
 You can read about <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/dataexchange/dynamicdataexchange.asp"> how DDE works</a> in MSDN, but since it seems people are reluctant to read the formal documentation, I’ll repeat here the points relevant to the discussion.
 The DDE process begins with a search for a service provider. This is done by broadcasting the <code>WM_DDE_INITIATE</code> message and collecting the responses. Each server that wishes to respond to the request sends back a <code>WM_DDE_ACK</code> message. The DDE client then chooses which of the servers it wishes to continue the conversation with (possible more than one). The remainder of the DDE conversation is carried out with posted messages, the details of which are not important here.
 As you can see, everything in DDE is asynchronous with the exception of the <code>WM_DDE_INITIATE</code>. Why is <code>WM_DDE_INITIATE</code> synchronous?
 Remember that DDE was developed back in the 16-bit days, <a href="http://blogs.msdn.com/oldnewthing/archive/2005/06/27/432303.aspx"> when it was safe to broadcast messages</a>. The initiate message and its <code>WM_DDE_ACK</code> replies are synchronous to ensure that the client doesn’t have to wait indefinitely to build a list of servers. If it were asynchronous, then the client would post the <code>WM_DDE_INITIATE</code> and then wait “a while” to see if anybody responded. But how does it know when it should give up waiting and just go with whatever it has? What happens if a response comes in after the client already proceeded based on the assumption that that server was unavailable? What if a response comes in five minutes later, when the client had started a <strong>second</strong> DDE discovery query? Would that response have been to the first or the second discovery broadcast?</p>
<p> In particular, it is important for the client to know whether there are any servers out there at all, because the way the shell <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_verbs.asp"> interprets DDE-based file associations</a> is first to attempt a <code>WM_DDE_INITIATE</code> with the application and topic specified in the registration. If no server is found, then it launches the server manually and then tries to connect to the server via DDE a second time. (The second time should work, since the responsible server was explicitly launched!) </p>


</body>