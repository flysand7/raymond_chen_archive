<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Is there anything better than GetThreadTimes for obtaining per-thread CPU usage information?</h1>  <!-- .entry-meta -->

<p>A customer was using the <code>Get­Thread­Times</code> function for high-resolution profiling of performance-sensitive code, but found that its accuracy is rather poor. They were hoping there would be something more along the lines of a <code>Query­Performance­Counter</code> that reported only CPU time consumed by a particular thread, rather than by the system in general. </p>
<p>Fortunately, there is. <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684943(v=vs.85).aspx">The <code>Query­Thread­Cycle­Time</code> function</a> gives you the CPU cycles consumed by a particular thread. This includes time spent both in user mode and in kernel mode. </p>
<p>Note, however, that these values are reported directly from the CPU using mechanisms like RDTSC or <a href="http://infocenter.arm.com/help/topic/com.arm.doc.ddi0290g/Bihcjbaa.html">the performance monitor control register</a>. This means that the actual results are at the mercy of whatever the CPU manufacturer decides the CPU cycle counter means. Maybe they correspond to wall clock time; maybe they don’t. </p>


</body>