<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The great thing about naming conventions is that not everybody will follow them</h1>  <!-- .entry-meta -->

<p>The naming convention for <code>HRESULT</code> is «facility»<code>_</code>«severity»<code>_</code>«name», where the facility portion (and the underscore) is omitted if the facility is <code>FACILITY_NULL</code> or <code>FACILITY_WIN32</code>.
 Good luck finding anybody who follows this naming convention.
 Okay, fine, if you look closely you might be able to find some people who do.</p>
<table cellpadding="0" cellspacing="0">
<tr>
<th align="left" rowspan="2" valign="baseline">COM  </th>
<td align="right">CO_</td>
<td>E_</td>
<td>NOTINITIALIZED</td>
</tr>
<tr>
<td align="right">CO_</td>
<td>S_</td>
<td>MACHINENAMENOTFOUND</td>
</tr>
<tr>
<th align="left" rowspan="2" valign="baseline">Structured storage  </th>
<td align="right">STG_</td>
<td>E_</td>
<td>SHAREVIOLATION</td>
</tr>
<tr>
<td align="right">STG_</td>
<td>S_</td>
<td>CONVERTED</td>
</tr>
<tr>
<th align="left" valign="baseline">SETUPAPI  </th>
<td align="right">SPAPI_</td>
<td>E_</td>
<td>EXPECTED_SECTION_NAME</td>
</tr>
<tr>
<th align="left" rowspan="2" valign="baseline">Data and view  </th>
<td align="right">DV_</td>
<td>E_</td>
<td>TYMED</td>
</tr>
<tr>
<td align="right">DV_</td>
<td>E_</td>
<td>FORMATETC</td>
</tr>
<tr>
<th align="left" valign="baseline">Class factory  </th>
<td align="right">CLASS_</td>
<td>E_</td>
<td>NOAGGREGATION</td>
</tr>
<tr>
<th align="left" valign="baseline">Class registry  </th>
<td align="right">REGDB_</td>
<td>E_</td>
<td>CLASSNOTREG</td>
</tr>
<tr>
<th align="left" rowspan="2" valign="baseline">OLEDB  </th>
<td align="right">DB_</td>
<td>E_</td>
<td>DELETEDROW</td>
</tr>
</table>
<p> Actually, I guess I was a bit too pessimistic when I said <i>nobody</i> follows it. It seems that the majority of Windows components do follow this convention, although there are some notable exceptions.</p>
<table>
<tr>
<th align="left" valign="baseline">DirectDraw  </th>
<td>DDERR_UNSUPPORTEDFORMAT</td>
</tr>
<tr>
<th align="left" valign="baseline">ADSI  </th>
<td>E_ADS_INVALID_DOMAIN_OBJECT</td>
</tr>
</table>
<p> There are also some people who decided to confuse matters further by using the <code>HRESULT</code> convention for error codes returned by <code>GetLastError()</code>!</p>
<table>
<tr>
<th align="left" valign="baseline">RPC  </th>
<td>RPC_S_OBJECT_NOT_FOUND</td>
</tr>
<tr>
<th align="left" valign="baseline">SmartCard  </th>
<td>SEC_E_SMARTCARD_CERT_REVOKED</td>
</tr>
<tr>
<th align="left" valign="baseline">Task scheduler  </th>
<td>SCHED_E_SERVICE_NOT_LOCALSYSTEM</td>
</tr>
<tr>
<th align="left" valign="baseline">Winsock  </th>
<td>WSA_E_NO_MORE</td>
</tr>
</table>
<p> I apologize for the confusion this has caused.</p>
<p> <b>Pre-emptive clarifying remark</b>: The examples given in this article are <a href="http://blogs.msdn.com/oldnewthing/archive/2009/06/18/9771135.aspx#9791094"> merely illustrative and are not intended to be comprehensive</a>. </p>


</body>