<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Command line tool to manage Windows 7 Libraries, with source code</h1>  <!-- .entry-meta -->

<p>
A customer asked if there was a command-line tool for
managing Windows 7 Libraries
so that they could create and deploy libraries across their
organization.
</p>
<p>
Not only is there such a tool, it even comes with source code.
</p>
<p>
The
<a href="http://msdn.microsoft.com/library/dd940379">
Shell Library Command Line Sample</a>
shows how to manage Windows 7 libraries programmatically
via the
<code>IShell­Library</code> interface.
And it’s actually a useful program on its own.
</p>
<pre>
Usage: shlib.exe SUBCOMMAND
Displays and modifies the attributes of Shell Libraries.
Supported commands:
  create      Creates a library at the specified path.
  info        Prints info about the given library.
  enum        Enumerates the folders in the library.
  setattrib   Modifies the attributes of the library.
  add         Adds the specified folder to the specified library.
  remove      Removes the specified folder from the library.
  setsaveloc  Sets the default save location of the library.
  resolve     Resolves the specified folder in the library.
  resolveall  Resolves all locations in the library in bulk.
  manage      Displays the Manage Library Dialog for the library.
</pre>
<p>
For example, to see all the folders that are part of your Documents
library, use the command
</p>
<pre>
shlib enum FOLDERID_DocumentsLibrary
</pre>
<p>
Each of the commands has further sub-options.
</p>
<pre>
Usage: create shlib.exe [OPTIONS]  [...]
Creates a library at the specified path.
Options:
 -create[:ARG]       Specifies that a new library should be created.
   &lt;none&gt;              Fail if the library already exists.
   overwrite           Overwrite any existing library.
   uniquename          Generate a unique name in case of conflict.
The library may be specified by a file system path,
or by a KNOWNFOLDERID (e.g. "FOLDERID_DocumentsLibrary").
</pre>
<p>
And the source code shows how to perform each of these actions
programmatically.
</p>
<p>
The <code>IShellLibrary</code> interface is also supported by
the
<a href="http://archive.msdn.microsoft.com/WindowsAPICodePack">
Windows API Code Pack for .NET</a>,
so you C# folks can use it too.
</p>
<p>
(One thing I noticed that is missing from the sample is a
<code>seticon</code> command.
Shouldn’t be hard to implement.
You just call
<a href="http://msdn.microsoft.com/library/dd391729">
<code>IShell­Library::Set­Icon</code></a>.)</p>


</body>