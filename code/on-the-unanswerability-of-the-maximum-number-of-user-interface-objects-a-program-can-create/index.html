<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">On the unanswerability of the maximum number of user interface objects a program can create</h1>  <!-- .entry-meta -->

<p>The answer to the question “What is the maximum number of window classes a program can register?” is not a number.
 Most user interface objects come from a shared pool of memory known as the “desktop heap”. Although one could come up with a theoretical maximum number of window classes that can fit in the desktop heap, that number is not achievable in practice because the desktop heap is shared with all other user interface objects on the desktop. For example, menus and windows go into the desktop heap, as well as more obscure objects like active window enumerations, window positioning handles used by <code>DeferWindowPos</code>, and even how many threads have attached input queues (either implicitly done by having cross-thread parent/owner relationships or explicitly by calling the <code>AttachThreadInput</code> function). The more windows and menus you have, the less space available for other things like registered window classes.
 Typically, when somebody asks this question, the real problem is that they designed a system to the point where desktop heap exhaustion has become an issue, and they need to redesign the program so they aren’t so wasteful of desktop heap resources in general. (One customer, for example, was registering thousands of window classes in their program, which is excessive.) In the same way that somebody asking for the <a href="http://blogs.msdn.com/oldnewthing/archive/2005/07/29/444912.aspx"> maximum number of threads a process can create</a> is an indication that their program is in need of a redesign, a program that registers thousands of window classes needs to be given another look. After all, even just creating a thousand windows is excessive—any UI that shows the user a thousand windows is too confusing to be usable.</p>
<p> (Pre-emptive link: <a href="http://support.microsoft.com/?scid=126962"> Q126962: On the desktop heap</a>.) </p>


</body>