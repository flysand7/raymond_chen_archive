<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I programmatically create folders like My Pictures if they were manually deleted?</h1>  <!-- .entry-meta -->

<p>A corporate customer had a problem with their employees accidentally deleting folders like <i>Videos</i> and <i>Pictures</i> and are looking for a way to restore them, short of blowing away the entire user profile and starting over. They found some techniques on the Internet but they don’t always work consistently or completely. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/02/06/10496796.aspx#10497222"> What is the recommended way of recreating these missing folders</a>?
 It turns out that the customer was asking a question that I answered <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/11/23/268486.aspx"> many years ago</a>, but looking at it from the other side.
 To recreate a folder, call <code>SHGet­Folder­Path</code> with the flag <code>CSIDL_FLAG_CREATE</code>, or call <code>SHGet­Special­Folder­Path</code> and pass <code>fCreate = TRUE</code>.
 If you are targeting Windows Vista or higher, the known-folder equivalent is calling <code>SHGet­Known­Folder­Path</code>, <code>SHGet­Known­Folder­ID­List</code>, or <code>SHGet­Known­Folder­Item</code> with the <code>KF_FLAG_CREATE</code> flag.</p>
<p> (There is a <a href="http://msdn.microsoft.com/en-us/library/bb762494(VS.85).aspx"> <code>CSIDL</code>-to-KF conversion table</a> in MSDN.) </p>


</body>