<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I extract the path to Control Panel from this shortcut so I can launch it?</h1>  <!-- .entry-meta -->

<p>A customer explained that they had a program that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/12/23/10250556.aspx">used the <code>IShell­Link::Get­Path</code> method to extract the program that is the target of a shortcut</a>. They found that this <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/12/10/10375909.aspx">didn’t work for certain shortcuts</a>, namely, shortcuts whose targets are not physical file paths. </p>
<p>The one that they were specifically having trouble with was the Control Panel shortcut. For example, if you open the classic Control Panel, then drag any of the Control Panel items to the desktop, this will create a shortcut to that Control Panel item. If you view the properties on that shortcut, the Target will be grayed out instead of showing a path. </p>
<p>“We want to get the target path of the shortcut so that we can launch the application. How can we get the target path from <code>IShell­Link::Get­Path</code>? Is there a special Windows API to get the path?” </p>
<p>They can’t get the target path because these are shortcuts to virtual objects. <i>There is no target path to begin with</i>. </p>
<p>But if you look past the question to their problem, you can see that they don’t need to know the path in the first place. All they want to do is launch the target application. The way to do this is simply to pass the shortcut to the <code>Shell­Execute</code> function. You can take <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/11/26/270710.aspx">this simple program</a> as inspiration. Pass <code>"open"</code> as the verb and the full path to the shortcut as the file. </p>
<p>As a bonus: Your program will also respect the other settings in the shortcut, like the Start In folder, the shortcut key, the preferred window state (normal, maximized, <i>etc</i>.), the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd378459(v=vs.85).aspx#where">custom application user model ID</a>. </p>
<p>And to answer the question (even though it isn’t needed to solve the problem): Use <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb774942(v=vs.85).aspx">the <code>IShell­Link::Get­ID­List</code> method</a> to obtain the shortcut target regardless of whether it is a physical file or virtual namespace item. </p>


</body>