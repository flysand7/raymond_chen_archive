<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I consume raw COM interfaces from a Windows Runtime metadata file?</h1>  <!-- .entry-meta -->

<p>Suppose somebody gives you a Windows Runtime metadata file. You can use it from C++ by asking <code>cppwinrt.exe</code> to generate C++/WinRT headers for them. But what if you are writing a C++ program that doesn’t use exceptions,¹ or for a C program? You want to access the raw COM interfaces rather than the exception-based projection. What can you do?</p>
<p>There is a raw COM counterpart to <code>cppwinrt.exe</code> which produces raw COM interfaces rather than C++/WinRT projections. It goes by the name <a href="https://www.nuget.org/packages/Microsoft.Windows.AbiWinRT"> Microsoft.<wbr/>Windows.<wbr/>AbiWinRT</a>. You invoke it basically the same way you invoke <code>cppwinrt.exe</code>; the difference is that the output is raw COM header files, which you can include from your C or C++ project, and then either consume directly or wrap inside a non-exception-based smart pointer library like WRL.</p>
<p>¹ For example, video games operate under tight real-time constraints and typically <a href="https://www.youtube.com/watch?v=IuJ79Og-CfU"> restrict themselves to a subset of C++</a> that, among other things, does not use exceptions.</p>


</body>