<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What’s the point of APTTYPE_CURRENT? I mean, of course I’m current.</h1>  <!-- .entry-meta -->

<p>The <code>Co­Get­Apartment­Type</code> function tells you what kind of apartment you are executing in. One of the values in the <code>APTTYPE</code> enumeration is <code>APTTYPE_</code><code>CURRENT</code>. Receiving this value is like walking up to an information desk and asking, “Where am I?” and the person at the desk says, “Why, you’re right here, of course!”</p>
<p>The confusion is that the <code>APTTYPE</code> enumeration is overloaded for multiple purposes.</p>
<p>It so happens that the <code>Co­Get­Apartment­Type</code> function will never succeed and tell you “You’re right here.”¹</p>
<p>The <code>APTTYPE_</code><code>CURRENT</code> value is used for functions like <code>Co­Get­Default­Context</code> where you tell it what kind of apartment for which you want to get the default context. If you pass <code>APTTYPE_</code><code>CURRENT</code>, then you get the default context that corresponds to whatever apartment type you are currently in.</p>
<p>¹ It does use the <code>APTTYPE_</code><code>CURRENT</code> value for error cases, so that code that forgets to check the error code won’t mistakenly believe that they are STA or MTA or whatever. If you ask for information about current apartment, but COM hasn’t been initialized, COM returns <code>CO_</code><code>E_</code><code>NOT­INITIALIZED</code> to tell you “There is no apartment.” And if you ignore that error code and look at the <code>APTTYPE</code>, it’ll be <code>APTTYPE_</code><code>CURRENT</code>: “Your question made no sense, so I’ll just say that you’re right here.”</p>


</body>