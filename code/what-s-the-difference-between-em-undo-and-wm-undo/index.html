<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What's the difference between EM_UNDO and WM_UNDO?</h1>  <!-- .entry-meta -->

<p><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#437591"> Daniel Chait wonders why we have both <code>EM_UNDO</code> and <code>WM_UNDO</code></a>. You know, I wonder the same thing. But I’m going to make an educated guess.
 Actually, most of what I write is just a lot of educated guessing. Like my explanation of <a href="http://blogs.msdn.com/oldnewthing/archive/2003/09/04/54794.aspx"> why <code>GetWindowText</code> has such complicated rules</a>? A guess. <a href="http://blogs.msdn.com/oldnewthing/archive/2003/10/08/55239.aspx"> Why address space granularity is 64KB</a>? A guess. <a href="http://blogs.msdn.com/oldnewthing/archive/2007/09/10/4849069.aspx"> Why most <code>EM_*</code> messages are in the system message range</a>? A guess. Mind you, it’s logical guesswork, usually strongly guided by the principle of “Imagine if this were possible.”
 Today’s guesswork: The history of <code>EM_UNDO</code> and <code>WM_UNDO</code>.
 It seems obvious that <code>EM_UNDO</code> came first. After all, why would there need to be a <code>EM_UNDO</code> message if a <code>WM_UNDO</code> already existed?
 At some point, somebody decided, “Hey, this sounds like something that people might want to do more generally.” New messages <code>WM_CUT</code>, <code>WM_COPY</code>, <code>WM_PASTE</code>, <code>WM_CLEAR</code>, and <code>WM_UNDO</code> were added, and the first control to implement them was the edit control.
 Therefore, the answer to the question is that for edit controls, the difference is that there is no difference.</p>
<p> The window manager does not provide a default implementation for any of these new messages. (Obviously, because the window manager is not psychic.) If you want your control to support those operations, you’ll have to respond to the messages yourself. </p>


</body>