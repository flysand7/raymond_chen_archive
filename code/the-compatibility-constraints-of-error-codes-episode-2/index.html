<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The compatibility constraints of error codes, episode 2</h1>  <!-- .entry-meta -->

<p>A customer reported an incompatibility in Windows 7: If A: is a floppy drive and they call <code>Load­Library("A:\\foo.dll")</code> and there is no disk in the drive, the <code>Load­Library</code> call fails with the error <code>ERROR_NOT_READY</code>. Previous versions of Windows failed with the error <code>ERROR_MOD_NOT_FOUND</code>.
 Both error codes are reasonable responses to the situation. “The module couldn’t be found because the drive is not ready.” Programs should treat a failed <code>Load­Library</code> as a failed library load and shouldn’t be sensitive to the precise reason for the error. (They can display a more specific error to the user based on the error code, but overall program logic shouldn’t depend on the error code.)
 Fortunately, the customer discovered this discrepancy during their pre-release testing and were able to accommodate this change in their program before ever releasing it. A sigh of relief from the application compatibility team.</p>
<p> <a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/01/18/355177.aspx"> Episode 1</a>. </p>


</body>