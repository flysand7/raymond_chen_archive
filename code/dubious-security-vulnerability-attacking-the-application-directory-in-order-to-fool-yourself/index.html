<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Dubious security vulnerability: Attacking the application directory in order to fool yourself?</h1>  <!-- .entry-meta -->

<p>A security vulnerability report arrived that went something like this: </p>
<blockquote class="q">
<p>There is a vulnerability in the <code>XYZ.EXE</code> program. If you place a hacked copy of the file <code>CABINET.DLL</code> in the same directory as <code>XYZ.EXE</code>, then when the user runs the <code>XYZ.EXE</code> program, it loads the hacked <code>CABINET.DLL</code> instead of the real one. When <code>XYZ.EXE</code> prompts for elevation, the user will allow it, and now the rogue <code>CABINET.DLL</code> is running code as administrator. </p></blockquote>
<p>Um, okay. </p>
<p>First of all, this is an application directory attack, and <a href="https://devblogs.microsoft.com/oldnewthing/">the application directory is considered a trusted location</a>. If you let somebody write to your application directory, then you are giving them control over what the application does. <a href="https://blogs.msdn.microsoft.com/oldnewthing/20121207-00/?p=5893">So don’t do that</a>. </p>
<p>This particular variation tries to disguise the matter by throwing in an elevation prompt, but the underlying issue is the same. Let’s look at it another way: Who is the attacker, and who is the victim? </p>
<p>The attacker is the user who creates a trap in the application directory. The victim is the person who runs the application and gets caught in the trap. But how do you get the victim to <a href="https://blogs.msdn.microsoft.com/oldnewthing/20121031-00/?p=6203">wander into the yucky hot tub</a>? Whatever technique you used to get them to run a program from your hot tub, you can use that technique to get them to run a rogue app directly; no need for fancy application directory attacks. </p>
<p>The other possibility of a victim is the user himself, who runs the <code>XYZ.EXE</code> application, and discovers that he just fell into his own trap. It’s not really considered elevation if you manage to fool yourself. </p>


</body>