<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Answer to yesterday's exercise</h1>  <!-- .entry-meta -->

<p>
<i>iMin</i> is the lowest-index element which intersects the paint rectangle, so a
        simple truncating division produces the desired index.
    </p>
<p>
        The formula for <i>iMax</i> can be interpreted two ways. One is that it is the roundup
        of the first invisible line. Recall the rectangles are exclusive of the endpoint,
        so <i>rcPaint.bottom</i> is actually the first row <i>outside</i> the rectangle. Since
        we want the first element that is completely outside the rectangle, we must round
        up.
    </p>
<p>
        A second interpretation begins with the seemingly equivalent formula. First, the expression
    </p>
<pre>    (pps-&gt;rcPaint.bottom - 1) / g_cyLine
</pre>
<p>
        computes the index of the last visible item. By adding unity, we get the index of
        the first invisible item.
    </p>
<p>
        In both cases, we do not allow the computed value to exceed <i>g_cItems</i> so we
        don’t try to draw items that don’t exist.
    </p>
<p>
        The answer to the next question is that the seemingly equivalent formula does not
        work correctly when <i>rcPaint.bottom</i> is zero or negative because the result of
        integer division is rounded towards zero, which would result in an erroneous computation
        that the value of <i>iMax</i> should be one instead of zero. If integer divisions
        were rounded towards negative infinity, then the formula would be correct.
    </p>
<p>
        And the answer to the final question is that the only harm is that we sometimes draw
        one item that we really didn’t need to. In our example, this is not that big a deal
        since drawing an item is relatively fast. But in cases where drawing an item is expensive,
        avoiding the drawing of even a single item may prove significant.
    </p>
<p>
        And we’ll see in Part 4 that playing with the origin can cause the paint rectangle
        to end up in odd positions.
    </p>


</body>