<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Awaiting Windows Runtime asynchronous operations from C# desktop apps</h1>  <!-- .entry-meta -->

<p>Some time ago, I showed <a href="/code/how-do-i-get-the-computer-s-serial-number-consuming-windows-runtime-classes-in-desktop-apps-part-4-c" title="How do I get the computers serial number? Consuming Windows Runtime classes in desktop apps, part 4: C#"> how to use Windows Runtime objects from C# desktop apps</a>. But that solution only went part of the way. It gave you access to the objects, but it didn’t provide a way to <code>await</code> any asynchronous operations.</p>
<p>Let’s fill in that gap.</p>
<p>Create a new <i>Console App (.NET Framework)</i> project from Visual Studio. This time, go to the References node, click <i>Add Reference</i> and click the <i>Browse</i> button. Change the file type filter to <i>All files</i> and pick</p>
<pre>C:\Program Files (x86)\
    Windows Kits\
    10\
    UnionMetadata\
    (SDK version)\
    Windows.winmd
</pre>
<p>This gets you access to the Windows Runtime classes, but it doesn’t enable <code>await</code> support. To do that, you also need to add</p>
<pre>C:\Program Files (x86)\
    Reference Assemblies\
    Microsoft\
    Framework\
    .NETCore\
    v4.5\
    System.Runtime.WindowsRuntime.dll
</pre>
<p>Okay, now you’re set up.</p>
<p>We’ll take this for a spin next time.</p>


</body>