<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I launch a file as if it were a text file, even though its extension is not .txt?</h1>  <!-- .entry-meta -->

<p>You might have a program that generates log files or other text content with an extension other than <code>.txt</code>. You naturally might want to open these documents in the user’s default text editor.</p>
<p> You might decide to ask the Windows developer support team, “How can I figure out what program is the handler for text files?” The idea being that once you get this program name, you can then run it yourself, with the document on the command line. And you would also be running into the trap of <i>looking for the answer to a question rather than a solution to a problem</i>. </p>
<p> For one thing, the default handler for the file type might require special command line parameters, parameters which you won’t get if you merely get the executable path. For example, on Windows 7, the default command line for JPG files is <code>%SystemRoot%\System32\rundll32.exe "%ProgramFiles%\Windows Photo Viewer\PhotoViewer.dll", ImageView_Fullscreen %1</code>, and if you merely asked for the executable, all you would get back would be <code>rundll32.exe</code>, and trying to execute <code>rundll32.exe Boats.jpg</code> doesn’t get you very far. You lost all the command line arguments. </p>
<p> For another thing, the default handler for the file type might not even be a command line. It might be <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/02/26/1763683.aspx"> an old program</a> that <a href="http://msdn.microsoft.com/library/hh127429"> uses DDE</a>. Or the handler might be a <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/05/03/10006065.aspx"> drop target</a>. Or it could be an <code>IContext­Menu</code> or an <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/03/12/9977246.aspx"> <code>IExecute­Command</code></a>. In these cases, there is no command line in the first place, so asking for the command line template is meaningless. </p>
<p> But we saw the answer to this question before, just in a different guise. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/01/10033224.aspx"> The <code>lpClass</code> member of the <code>SHELL­EXECUTE­INFO</code> lets you open a file as if it were another type of file</a>. In that article, somebody was passing a class when they didn’t mean to; here, we’re passing it on purpose. </p>


</body>