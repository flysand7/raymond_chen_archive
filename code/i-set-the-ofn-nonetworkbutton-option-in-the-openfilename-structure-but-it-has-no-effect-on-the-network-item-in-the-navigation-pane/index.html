<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">I set the <code>OFN_NONETWORKBUTTON</code> option in the <code>OPENFILENAME</code> structure, but it has no effect on the network item in the navigation pane</h1>  <!-- .entry-meta -->

<p>A customer set the <code>OFN_</code><code>NO­NETWORK­BUTTON</code> option in the <code>OPEN­FILE­NAME</code> structure, but it stil shows the <i>Network</i> item in the navigation pane.</p>
<p>There are a number of flags in the <code>OPEN­FILE­NAME</code> structure which harken back to the old Windows 3.1-style dialog box. In Windows 3.1, the <i>Open</i> dialog had a button labeled <i>Network</i> that appeared next to the drives combo box. Clicking it let you map a new network drive. The <code>OFN_</code><code>NO­NETWORK­BUTTON</code> flag hides that button.</p>
<p>But if you’re using the new Explorer-style <i>Open</i> dialog, there is no <i>Network</i> button to begin with, so there’s no button to hide.</p>
<p>While it’s true that there is a <i>Network</i> item in the navigation pane, that is not the thing that the <code>OFN_</code><code>NO­NETWORK­BUTTON</code> flag controls. The purpose of the flag was not to hide the network; it was merely to hide the button that lets you map a new network drive. And since the Explorer-style dialog doesn’t have such a button in the first place, the flag is redundant.</p>
<p>There’s another flag left over from the Windows 3.1 dialog: <code>OFN_</code><code>HIDE­READ­ONLY</code>. The original Windows 3.1 dialog had a separate check box called <i>Read-only</i>, but the Explorer style dialog doesn’t have that check box. Instead, the <i>Open</i> button is a split button, with options <i>Open</i> and <i>Open as read-only</i>. In this case, the <i>Open</i> dialog box was able to map the old flag to a corresponding feature in the new dialog.</p>
<p> </p>


</body>