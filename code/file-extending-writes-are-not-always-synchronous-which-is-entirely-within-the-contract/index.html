<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">File-extending writes are not always synchronous, which is entirely within the contract</h1>  <!-- .entry-meta -->

<p>I noted some time ago that <a href="https://blogs.msdn.microsoft.com/oldnewthing/20180725-00/?p=99335">the current implementation of NTFS forces certain kinds of writes to be synchronous, even when issued asynchronously</a>. Note that this is an implementation decision which is not contractual. Formally, the rule is that any asynchronous operation is permitted (but not required) to complete synchronously. </p>
<p>Malcolm Smith points out that <a href="https://www.osr.com/nt-insider/2015-issue2/maintaining-valid-data-length/">the ReFS file system does not force extending writes to be synchronous</a>. Specifically, ReFS version 1 (Windows 8.1, Windows Server 2012 R2) allowed cached writes to the end of a file to complete asynchronously, and ReFS version 2 (Windows 10 version 1607, Windows Server 2016) maintains validity on a per-range basis, so the need to zero out huge chunks of a file disappears completely. </p>


</body>