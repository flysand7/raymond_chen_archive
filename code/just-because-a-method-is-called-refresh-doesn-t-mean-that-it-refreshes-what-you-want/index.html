<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Just because a method is called Refresh doesn’t mean that it refreshes what you want</h1>  <!-- .entry-meta -->

<p>Here’s a question from a customer:</p>
<blockquote class="q"><p> I made some changes related to my shell extension [details omitted], but the changes don’t show up in the Explorer window when I refresh it. Any suggestions on how to solve this problem? </p></blockquote>
<p> When we asked how they were refreshing the Explorer window, we were expecting something like pressing F5 or calling <code>SHChangeNotify</code> with <code>SHCNE_UPDATEDIR</code>, or maybe calling <code>IShellView::Refresh</code> or possibly even calling <code>WebBrowser.Refresh</code> from script. But we definitely didn’t expect this response: </p>
<blockquote class="q"><p> I’m invoking the <a href="http://msdn2.microsoft.com/en-us/library/system.diagnostics.process.refresh.aspx"> Process.Refresh() method from the </a><a href="http://msdn2.microsoft.com/en-us/library/15t15zda.aspx"> <code>System.Diagnostics</code></a> namespace. </p></blockquote>
<p> Just because a method is called <code>Refresh</code> doesn’t mean that it refreshes what you want. I think this is somebody who just saw a method name, perhaps <a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/02/8918130.aspx#8920037"> inspired by IntelliSense</a> and— <a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/02/8918130.aspx#8920189"> Boom! You have it!</a>—assumed it did what was needed without actually reading the documentation to check. But you don’t even need to read the documentation to know that <code>Process.Refresh</code> has no chance of working. </p>
<p> Since it’s a method on the <code>Process</code> class, the method is applicable to all processes. But certainly there is no generic way to tell a process to refresh. This magical <code>Refresh</code> method would have to know how to refresh Explorer windows, Firefox web pages, iTunes mp3 tags… And what would it even mean to refresh, say, a Notepad window? Does that mean to throw away all changes and reload the original document? </p>
<p> How do you know that there is no generic way to tell a process to refresh? Well, for one thing, a single process like Explorer can be viewing multiple objects that can be refreshed; which one are you refreshing? Second, when you write your own program, how do <i>you</i> implement refresh? Do you respond to some standard system Refresh message? Or do you just add a Refresh option to your program’s main menu and give it some arbitrary command ID? If there’s not even a standard way to refresh <i>your</i> program’s window, then how can there be a standard way to refresh <i>all</i> program windows? </p>
<p> In this specific case, the <code>Process.Refresh</code> method refreshes the <code>Process</code> object’s internal cache of process properties. It doesn’t actually do anything to the process itself. How could it? </p>
<p> It’s like <a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/02/8918130.aspx#8920421"> thinking that the <code>Matrix.Rotate</code> method rotates the entries in a matrix</a>. </p>
<p> <b>Epilogue</b> </p>
<p> Actually, I’m scared by this customer’s question for another reason: The fact that they even mentioned <code>Process.Refresh</code> suggests to me that they wrote their shell extension in managed code, which we already know <a href="http://blogs.msdn.com/oldnewthing/archive/2006/12/18/1317290.aspx"> is strongly disrecommended</a>. </p>


</body>