<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">MessageBoxIndirect loads the icon itself; you can’t hand it a pre-loaded icon</h1>  <!-- .entry-meta -->

<p>Commenter <a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#519342"> 8</a> wants to know how to tell the <code>MessageBoxIndirect</code> function to use an existing <code>HICON</code> instead of pointing it to an icon resource.</p>
<p> You can’t. </p>
<p> The <code>MessageBoxIndirect</code> loads the icon itself. You can’t hand it a pre-loaded icon. </p>
<p> Of course, it’s hardly rocket science to write your own <code>MessageBoxWithMyIcon</code> function that lets you use whatever icon you want. There’s no law that says all Yes/No dialogs must use the <code>MessageBox</code> function. Feel free to write your own. </p>
<p> The <code>MessageBox</code> and <code>MessageBoxIndirect</code> functions are just convenience functions. They don’t create new functionality; they don’t do anything you couldn’t already do yourself. You can have a template dialog box that you use for “generic” purposes and set the icon and text yourself. Or, if you’re really adventuresome, you can <a href="http://blogs.msdn.com/oldnewthing/archive/2005/04/29/412577.aspx"> generate a dialog template on the fly</a>. </p>
<p> The <code>MessageBox</code> and <code>MessageBoxIndirect</code> functions never aspired to be “everything anybody could ever do with a dialog box.” They just provide some basic functionality that lots of people find useful. If you need more functionality, then you can always write it yourself. (There’s already a function for “everything anybody could ever do with a standard Win32 dialog box”: It’s called, um, <code>DialogBox</code>.) </p>
<p> Windows Vista introduces a considerably more customizable “message box”-type dialog known as a <a href="http://msdn2.microsoft.com/en-us/library/ms650910.aspx"> Task Dialog</a>; you may want to give that one a try. </p>


</body>