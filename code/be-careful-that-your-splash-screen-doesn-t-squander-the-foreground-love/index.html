<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Be careful that your splash screen doesn't squander the foreground love</h1>  <!-- .entry-meta -->

<p>Commenter Erbi has a program which creates a splash screen on a background thread while the main thread initializes. “<a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#1639832">I create and then destroy this splash screen window just before creating and displaying the main window</a>.” The problem is that the main window fails to obtain foreground activation. Commenting out the code that creates the splash screen fixes the problem, but then there isn’t a splash screen any more (obviously). “Is there an explanation for this behavior?”
 This behavior is explained by two earlier blog posts, plus a PDC talk. The first blog post came out years before this question was asked: <a href="http://blogs.msdn.com/oldnewthing/archive/2004/02/27/81155.aspx"> The correct order for disabling and enabling windows</a>. Destroying a window is a rather extreme case of disabling it, but the effect is the same. When you destroy the splash screen, foreground activation needs to move to some other window, and since your main window isn’t around to inherit it, foreground activation leaves your program. When the main window appears, it’s too late.</p>
<p> The <a href="https://channel9.msdn.com/pdc2008/PC43/"> PDC talk</a> came next, followed shortly thereafter by <a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/20/9435239.aspx"> a blog post version of the same talk</a>. As marketing folks like to remind you, “You get only one chance to make a first impression.” Similarly, you get only one chance to use your foreground activation permission, and you decided to blow it on a splash screen. That’s fine as far as it goes, but if you want to transfer that permission to another window, you have to manage it yourself. The recommended way is to establish an owner/owned relationship between them; that’s the case that the “disabling and enabling windows” article focuses on. </p>


</body>