<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I convert an error code to text when FORMAT_MESSAGE_FROM_SYSTEM doesn’t work?</h1>  <!-- .entry-meta -->

<p> For the same reason that <a href="http://blogs.msdn.com/oldnewthing/archive/2006/11/03/942851.aspx"> not all error codes are defined in <code>winerror.h</code></a>, not all error strings are defined in the system message table. If you’ve ever played with the message compiler, you’d quickly have recognized the <code>winerror.h</code> file as the header file associated with a message resource. In other words, there’s a <code>.mc</code> file that gets processed by the message compiler, and out pops the message resource (which becomes the system message table) and the <code>winerror.h</code> header file. </p>
<p> As we saw a few years ago, <a href="http://blogs.msdn.com/oldnewthing/archive/2006/11/03/942851.aspx"> not all error messages live in <code>winerror.h</code></a>, which means that not all error messages live in the system message table. Each component that provides error codes outside of <code>winerror.h</code> needs to provide its own message table. For example, <a href="http://msdn2.microsoft.com/en-us/library/aa370285.aspx"> messages for network errors can be found in <code>netmsg.dll</code></a>. Similarly, <a href="http://blogs.msdn.com/oldnewthing/archive/2005/09/08/462402.aspx#462550"> winhttp error message text can be found in <code>winhttp.dll</code></a>. I don’t know about other message ranges; hopefully the documentation for the component that generates those errors also mentions where you can find the text. </p>


</body>