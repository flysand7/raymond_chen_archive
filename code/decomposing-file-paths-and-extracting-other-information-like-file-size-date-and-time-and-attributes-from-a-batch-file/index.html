<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Decomposing file paths (and extracting other information like file size, date and time, and attributes) from a batch file</h1>  <!-- .entry-meta -->

<p>We saw something very similar to this <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/08/02/10334559.aspx">during the first Batch File Week</a>. You have a file name in an environment variable, and you want to decompose its path (say, extract the drive letter or get the file base name without any path information or extension). Or you want to get the file’s size or date or attributes. </p>
<p>The technique we saw in the article was to call a subroutine with the file name, and have the subroutine use the <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/percent.mspx">tilde operators</a> to extract information from the inbound parameter. </p>
<p>You can also do this inline (without needing a subroutine) by abusing the <code>FOR</code> command. Tilde operators work on <code>FOR</code> loop variables, so you just need to set up a <code>FOR</code> loop that doesn’t actually loop! </p>
<pre>
set FILENAME=C:\Program Files\desktop.ini
for %%i in ("%FILENAME%") do set SIZE=%%~zi
</pre>
<p>Ta-da, you put the file size in the <code>SIZE</code> variable. </p>
<p>Of course, you could do actual math, too. Or use the other tilde operators to extract other information. Go nuts. </p>


</body>