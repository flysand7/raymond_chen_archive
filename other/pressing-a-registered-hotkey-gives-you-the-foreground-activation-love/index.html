<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Pressing a registered hotkey gives you the foreground activation love</h1>  <!-- .entry-meta -->

<p>One category of application that people complained about is <a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/20/9435239.aspx#9436619"> the application launcher which keys off a hotkey</a> and doesn’t get the foreground love.</p>
<p> Well, except that windows with registered hotkeys <i>do</i> get the foreground love. </p>
<p> After you call the <code>RegisterHotKey</code> function to register a hotkey, the window manager will send you a <code>WM_HOTKEY</code> message when the user presses that hotkey, and along with it, you will get the foreground love. If you call <code>SetForegroundWindow</code> from inside your hotkey handler, the foreground window will change according to your instructions. </p>
<p> A <a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/20/9435239.aspx#9436633"> special administrator-only list of programs which are exempt from <code>SetForegroundWindow</code> rules</a> would just be adding another round to the <a href="http://blogs.msdn.com/oldnewthing/archive/2004/02/16/73780.aspx"> game of walls and ladders</a>. All that’ll happen is that programs, when they install, will place themselves in the <i>Exempt from the normal rules</i> list, and you’re back where you started. </p>
<p> “Oh no, I’ll super-protect that registry key so that the only way to add an entry to it requires a human being to respond to a dialog box confirming that the entry is being added.” </p>
<p> Well, for one thing, that doesn’t actually stop installers with administrator privilege, since they can just remove the super-protection and update the key anyway. (Administrator privilege is like that.) And even if you somehow manage to super-protect the setting (how? beats me), the next stage is application vendors (or system administrators attempting to deploy the application across their company) asking for a programmatic way to add their program to your super-protected list of exemptions. And then you’re back to where you were. </p>


</body>