<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The .Default user is not the default user</h1>  <!-- .entry-meta -->

<p>If you ever gone spelunking in the <code>HKEY_USERS</code> registry key, you’ve no doubt found the user named <code>HKEY_USERS\.Default</code>. Who is this guy?
 Despite its name, the profile for the .Default user is not the default user profile. It’s actually the profile for the Local System account and is an alias for <code>HKEY_USERS\S-1-5-18</code>. (<a href="http://technet2.microsoft.com/WindowsServer/en/library/86cf2457-4f17-43f8-a2ab-7f4e2e5659091033.mspx"><code>S-1-5-18</code> is the security identifier for the Local System account</a>.) Consequently, settings in <code>HKEY_USERS\.Default</code> are used by programs and services that run as Local System. The most visible examples of programs that run as Local System are <code>winlogon</code> and <code>logonui</code>, the programs that display the interface for logging onto the system. Whatever color scheme and screen saver you choose for the Local System profile get used at the logon screen.
 Unfortunately, the name <code>.Default</code> has led people to believe that this user’s settings are the basis for new user profiles. In retrospect, calling it <code>.Default</code> was probably a bad decision. It just gave people the wrong idea. Here’s one customer that was faked out:</p>
<blockquote class="q"><p> I’m setting the values in <code>HKEY_USERS\.Default\International</code> but when I create a new user, that user doesn’t pick up those settings. I’m stumped. </p></blockquote>
<p> The registry settings for new users do not come from the <code>.Default</code> user. Rather, they come from what I’ve started calling the “template user”, which is kept† in the file <code>C:\Documents and Settings\Default User\ntuser.dat</code>. This hive is not loaded most of the time (since there’s no reason to waste memory on something that is needed only rarely), so if you want to make a change to the template user, you’ll have to load the hive manually.
 Mind you, messing with the template user hive directly is most likely not supported. The supported way of modifying the template user hive on Windows XP is to use the system preparation tool “SysPrep”. Boot into factory mode, make your customizations to the current user, then reseal. The resealing process propagates the current user’s settings to the template user (or, more specifically, the ones that can safely be propagated to the template user—you don’t want to propagate things like encryption keys) before “resealing” the system for deployment.
 (No, I don’t know what the mechanism is for Windows Vista.)
 <b>Nitpicker’s corner</b></p>
<p> †s/which is kept/which is typically kept on US-English systems/ </p>


</body>