<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why isn't Windows Setup just a disk reimage plus a registry dump?</h1>  <!-- .entry-meta -->

<p><a href="http://blogs.msdn.com/oldnewthing/archive/2005/01/27/361595.aspx#363056"> Why can’t all the registry key needed by Windows Setup be precomputed and splorted at one go?</a> One reason is that Windows Setup can be customized via a so-called “<a href="http://support.microsoft.com/kb/155197">unattend file</a>“, which means that a lot of the work cannot be precalculated. Some settings also have cascade effects on other settings.
 Also, the model for component registration is to make each component <a href="http://msdn.microsoft.com/library/en-us/com/htm/cmf_d2l_3cmq.asp"> responsible for its own registration</a>, which can in turn be context-sensitive: “If the system has configuration x, then do y else z”. Internet Explorer’s component registration for example contains many conditional sections based on the installation configuration specified in the unattend file and the even fancier Winbom.ini file used by <a href="http://www.microsoft.com/technet/prodtechnol/winxppro/deploy/introductoin.mspx"> Sysprep-based deployment</a> (which is used by computer manufacturers and large corporations).
 Making each component responsible for its own registration reduces entanglements between components but also means that “global optimizations” such as precalculating the registry cannot be done. Engineering is about tradeoffs and this is one of them: Maintainability vs. speed.
 (Of course, there are sections of the registry that are not context-sensitive, and those to some degree have already been gathered together for block copying onto the machine during Windows Setup. Look at the <code>HIVExxx.INF</code> files on your Windows XP CD.)</p>
<p> That said, it appears that <a href="http://www.winsupersite.com/showcase/longhorn_setup.asp"> Longhorn setup is moving towards the “disk image” model</a>. I wish them luck. </p>


</body>