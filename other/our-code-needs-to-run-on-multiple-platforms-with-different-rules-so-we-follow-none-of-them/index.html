<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Our code needs to run on multiple platforms with different rules, so we follow none of them!</h1>  <!-- .entry-meta -->

<p>A customer was encountering sporadic crashes in their 64-bit application, and upon investigation, the problem was traced to a misaligned RSP register. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/01/14/58579.aspx"> We saw some time ago</a> that <a href="http://msdn.microsoft.com/library/ew5tede7.aspx"> the Windows x64 calling convention requires the RSP register to be 16-byte aligned</a>.
 The customer traced the source of the misalignment to a third-party library they were using. They contacted the vendor, who acknowledged that they were not following <a href="http://msdn.microsoft.com/library/7kcdt6fy.aspx"> the Windows x64 calling conventions</a>, but explained that their code needs to run on multiple x64 operating systems, and since each operating system has different calling conventions, they adhere to none of them!</p>
<p> I was kind of boggled by this remark. Yes, it’s frustrating that different operating systems have different calling conventions, but that doesn’t mean that you are welcome to ignore them. Every region of the world has different laws regarding the operation of motorized vehicles, but that doesn’t mean “My truck driver has to drive through all these different jurisdictions with different rules, so he follows none of them!” </p>


</body>