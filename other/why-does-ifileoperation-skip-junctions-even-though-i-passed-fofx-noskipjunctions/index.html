<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does IFileOperation skip junctions even though I passed FOFX_NOSKIPJUNCTIONS?</h1>  <!-- .entry-meta -->

<p>The <code>IFile­Operation::Set­Operation­Flags</code> method accepts a number of flags to modify the file operation, among them today’s subject <code>FOFX_NO­SKIP­JUNCTIONS</code>. A customer reported that they couldn’t get this flag to work: Whether they set it or not, the <code>IFile­Operation</code> skipped over <a href="http://technet.microsoft.com/en-us/magazine/ee851567.aspx"> file system junctions</a>.
 The term <i>junction</i> evolved two independent different meanings. The shell team invented the term <i>shell namespace junction</i> in Windows 95 to refer to a point in the shell namespace <a href="http://msdn.microsoft.com/cc144096.aspx"> in which one type of namespace extension is grafted into another</a>. For example, a directory of the form <code>name.{guid}</code> serves as the transition point between the default file system namespace and a custom namespace.
 Meanwhile, the file system team developed the term <i>NTFS junction point</i> to refer to a directory entry which links to another location.
 If you just hear the word <i>junction</i> by itself, you need to use context to determine whether it is short for <i>shell namespace junction</i> or <i>NTFS junction point</i>.</p>
<p> Since <code>IFile­Operation::Set­Operation­Flags</code> is a shell interface, the shell interpretation is more likely (and is the correct one in this case). The <code>FOFX_NO­SKIP­JUNCTIONS</code> flag has no effect on the behavior of the <code>IFile­Operation</code> interface on NTFS junction points; it modifies the behavior on shell namespace junctions. </p>


</body>