<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Documentation creates contract, which is why you need to be very careful what you document</h1>  <!-- .entry-meta -->

<p>A person with a rude name asks, “<a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/06/30/10538242.aspx#10538401">Why does MS not document the system metrics used by classic/pre-uxtheme windows and common controls</a>? <a href="http://web.archive.org/web/20070301202835/http://shellrevealed.com/photos/blog_images/images/4538/original.aspx">This image</a> is really useful and I wish all of this was actually documented.” </p>
<p>Actually, that picture explains why it <i>isn’t</i> documented. </p>
<p>Suppose such a picture existed in the Windows 2000 documentation. I don’t know what it would say exactly, so suppose, for the purpose of discussion, that it said that the caption buttons are exactly <code>SM_CX­FRAME</code> pixels from the right-hand edge of the window, and that the buttons are exactly <code>SM_CX­SIZE</code> pixels wide, with exactly <code>SM_CX­EDGE</code> pixels of padding between the buttons, and the buttons are exactly <code>SM_CY­SIZE</code> pixels tall, with  <code>SM_CY­EDGE</code> pixels between the top of the button and the top of the window. </p>
<p>Once that picture existed in the documentation, the picture you linked to could never exist. </p>
<p>The picture from Windows 2000 doesn’t include the <code>SM_CX­PADDED­BORDER</code> or the the <code>SM_CY­PADDED­BORDER</code>. It can’t, because those metrics didn’t exist in Windows 2000. Since the diagram is part of the documentation, it is contractual, and it would not be possible to alter the layout of the window caption (say, by incorporating a new metric like <code>SM_CX­PADDED­BORDER</code>), because that would break existing code. </p>
<p>For example, a program may have looked at the diagram and concluded, “Okay, so if I want to programmatically click the Close button, I can go to the upper right corner of the window, move down <code>SM_CY­FRAME + 1</code> pixels, move left move down <code>SM_CX­FRAME + 1</code> pixels, and click there, and it will hit the button.” </p>
<p>And then Windows Vista shows up, adds some <code>SM_CX­PADDED­BORDER</code> between the Close button and the right edge, and the program stops working. </p>
<p>Publishing the <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/12/02/10577260.aspx">redlines</a> would force the visual layout to be locked in stone. Windows 95 could not have added the Close button. Windows Vista could not have added extra padding around the buttons. </p>
<p>Note that changing the visual layout of the caption does not break programs which draw their own caption bar. They will continue to draw the caption bar their own custom way. If they tried to mimic the Windows 2000 caption bar, then they will continue to mimic the Windows 2000 caption bar, even on Windows Vista. But nobody gets hurt, because the application is doing both the drawing and the hit-testing, so it remains in sync with itself. </p>


</body>