<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Self-esteem gone overboard: The perils of a global namespace</h1>  <!-- .entry-meta -->

<p>There are items with overly generic names. <code>HANDLE</code>, <code>CloseHandle</code>, <code>GetObject</code>, <code>DIFFERENCE</code>, <code>query.exe</code>. But their functionality doesn’t live up to their name. <code>HANDLE</code> refers only to kernel handles, <code>CloseHandle</code> can only close kernel handles, <code>GetObject</code> only gets information about GDI objects, <code>DIFFERENCE</code> applies only to the numerical difference between group resources and standalone resources, and <code>query.exe</code> only queries information about <strike>Terminal Services</strike> <a href="http://blogs.msdn.com/ts/archive/2008/11/03/terminal-services-renamed-remote-desktop-services-at-teched-emea.aspx"> Remote Desktop Services</a>.</p>
<p> Why do functions that operate only inside a specific realm have names that suggest a broader scope? </p>
<p> Self-esteem gone bad. </p>
<p> You’re on the kernel team. You have a handle manager. What should you call your handles? Well, since they’re handles, just call them <code>HANDLE</code>. Because that’s what they are, right? And naturally the function that closes <code>HANDLE</code>s should be called <code>CloseHandle</code>. Sure, there are other types of handles out there, but they don’t exist in your world. Your world is the kernel, and in the kernel world, you can call them <code>HANDLE</code>s and everybody will know that you’re talking about kernel handles because that’s why you’re in the kernel in the first place! Why would somebody pass a handle to a non-kernel object to a kernel function? That makes no sense! </p>
<p> Similarly, the GDI folks came up with their own object system, and naturally the way you get information about an object is to call <code>GetObject</code>. There’s no confusion here, right? I mean, this is GDI, after all. What other types of objects are there? </p>
<p> The <strike>Terminal Services</strike> Remote Desktop Services folks thought the same thing when they created their <code>query.exe</code> program. Hey, this is a computer set up to run Remote Desktop Services; of course you want to query information about Remote Desktop Services. </p>
<p> Of course, when your symbol exists in a shared namespace, the context of your naming decision becomes lost, and your generic-sounding function name (which worked just great for generic operations <i>in the world in which it was created</i>) ends up carrying more meaning than you originally intended. </p>
<p> Commenter <a href="http://blogs.msdn.com/oldnewthing/archive/2006/05/01/587528.aspx#587944"> Sean W.</a> tries to explains that Unix doesn’t have this problem. “A Unix-flavored close() system call can close any file descriptor.” This explanation ends up being its own counter-argument. When you say that it can close any file descriptor, you’re admitting that it can’t close <i>anything</i>. You can’t use <code>close()</code> to close the objects opened by <code>opendir()</code> or <code>dbm_open()</code> or <code>XtOpenDisplay</code>. </p>
<p> “Well, yeah, but it can close any file descriptor regardless of where it came from.” And <code>CloseHandle</code> works the same way: It can close any kernel handle regardless of where it came from. </p>
<p> Sean W. later clarified that “<a href="http://blogs.msdn.com/oldnewthing/archive/2006/05/01/587528.aspx#588022">the scope of <code>close()</code> is the system kernel, so it’s reasonable to expect that it applies to kernel data and no other data, whereas the scope of <code>CloseHandle</code> is all of Win32, including at least KERNEL/USER/GDI/ADVAPI</a>.” Um, actually, the scope of <code>CloseHandle</code> is also the kernel. </p>
<p> And in the category of “suggesting things that are already done” goes this comment from Daniel, who suggests that <a href="http://blogs.msdn.com/oldnewthing/archive/2006/05/01/587528.aspx#589287"> the documentation explain which <code>HANDLE</code>s can be closed by <code>CloseHandle</code></a>. Actually, if you look at each function that creates a handle, it also tells you the function to use to close it. Not quite the same thing, but since you have to open something in order to close it, you’ll find the information even sooner. </p>


</body>