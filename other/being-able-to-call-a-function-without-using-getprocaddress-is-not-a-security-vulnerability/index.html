<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Being able to call a function without using GetProcAddress is not a security vulnerability</h1>  <!-- .entry-meta -->

<p>Another genre in the sporadic category of dubious security vulnerability is people who find an unusual way of accomplishing something perfectly normal but declare it a security vulnerability because they found an unusual way of doing it.</p>
<blockquote class="q"><p>  Security is important to all computers users, from families at home to employees of government agencies, and people who use Microsoft Windows are no exception. Trojans, backdoors, and spyware (collectively known as <i>malware</i>) have taken many forms, most recently those of so-called <i>rootkits</i>, which modify the operating system itself in order to prevent their detection. Firewalls are an important tool in the defense against malware. </p>
<p> Through the following sequence of tricks, we can obtain the address of any function without using the <code>GetProcAddress</code> function. Once that address is obtained, the function can be called in the normal manner. First, obtain the module base address by calling the <code>LoadLibrary</code> function. The headers of the image are mapped into memory at the base address. From there, you can parse the headers of the module, look for the export directory, then manually parse the exported function name table until you find the function you want. In this way you can call functions like <code>RegSetValue</code> without detection. </p>
</blockquote>
<p> Well, sure, you can manually perform all the operations that the <code>GetProcAddress</code> would perform, but what’s the point? Once you call <code>RegSetValue</code> all the normal registry security checks take place. You haven’t bypassed anything. If you were so keen on calling functions surreptitiously, you could scan memory looking for the byte pattern that corresponds to the function you’re looking for, or heck, just cut out the middle man and just take the code from the DLL you are trying to gain secret access to and copy it into your program! </p>
<p> In other words, you just <a href="http://blogs.msdn.com/oldnewthing/archive/2008/05/16/8510192.aspx"> found a complicated way of doing something perfectly mundane</a>. You can’t make up for the absence of any actual vulnerability by piling on style points and cranking up the degree of difficulty. </p>


</body>