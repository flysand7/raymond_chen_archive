<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Command lines need to be quoted; paths don't</h1>  <!-- .entry-meta -->

<p>While it’s true that one category of problems comes from <a href="http://blogs.msdn.com/oldnewthing/archive/2003/08/27/54715.aspx"> failing to quote spaces in command lines</a>, it is a false statement that “<a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#429980">path names in the registry should have quotation marks around them for obvious reasons</a>.” In fact it’s the opposite. Path names should <i>not</i> be quoted.
 Think about it: Quotation marks are a parsing issue, not a file name issue. The quotation marks are not part of the file name. If you type <code>dir</code> or open the folder in Explorer, you don’t see any quotation marks. You can’t pass quotation marks to <code>CreateFile</code> or <code>GetFileAttributes</code> since they aren’t actually part of the file name.
 Quotation marks indicate to code that is parsing a command line that a space should not be interpreted as the end of the command line token. Therefore, you need quotation marks when the string will be interpreted as a command line, such as in the <code>lpCommandLine</code> parameter to <code>CreateProcess</code> (but not the <code>lpApplicationName</code> parameter). Many places in the registry allow you to specify a command line, such as in the <code>Run</code> key or in the <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_verbs.asp"> registration of static verbs</a>. If the string will be used as a command line, then you need to quote the spaces so that the command line parser knows where the program name ends and the command line arguments begin.
 In the example in the linked comment, the registry key in question is a list of paths to files, not a list of command lines. Since it’s not a command line, quotation marks would result in an invalid file name, since quotation marks are not legal file name characters.
 The correct statement of the rule is that <i>command lines</i> in the registry should have quotation marks to protect spaces. Path names, on the other hand, not only do not require quotation marks, but in fact <i>must not</i> have quotation marks, because the quotation mark is not a part of the file name.
 <b>Nitpicker’s corner</b></p>
<p> Observe that at no point did I claim that Microsoft employees are perfect. <a href="http://blogs.msdn.com/oldnewthing/archive/2007/05/04/2402028.aspx"> Microsoft employees make mistakes, too</a>. </p>


</body>