<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Dubious security vulnerability: Copying a program and running the copy</h1>  <!-- .entry-meta -->

<p>This wasn’t an actual security vulnerability report, but it was inspired by one. “If you take the program <code>XYZ.EXE</code> and you rename it or copy it to a new name that contains the letters <code>XYX</code>, then you can trigger a buffer overflow in the renamed/copied version of <code>XYZ.EXE</code> due to a bug in the way it parses its own file name in order to generate the names of its auxiliary files.” </p>
<p>While that’s a bug, and thanks for pointing it out, it is not a security issue because there is no elevation of privilege. Sure, you could rename or copy the program and run it, but if you have permission to do that, you may as well do it the easy way: Instead of copying <code>XYZ.EXE</code> and running it, just copy <code>pwnz0rd.exe</code> and run it! Either way, it’s just a case of you attacking yourself. You did not gain any privileges. </p>
<p>Renaming or copying a file requires <code>FILE_ADD_FILE</code> permission in the destination directory, and if you have permission to add files to a directory, why stop at just adding files that are copies of existing files? You can add entirely new files! </p>
<p>In other words, instead of <code>copy XYZ.EXE XYX.EXE</code>, just do <code>copy pwnz0rd.exe XYX.EXE</code>. </p>
<p>This is a variation of the dubious vulnerability known as <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/08/07/4268706.aspx#4282521"><i>Code execution results in code execution</i></a>. </p>
<p>Now, this would be an actual vulnerability if you could somehow redirect attempts by other people to run <code>XYZ.EXE</code> from the original to your alternate <code>XYX.EXE</code> instead. But that would be attacking the redirection code, not attacking <code>XYZ.EXE</code> itself. Because if you can fool somebody into running <code>XYX.EXE</code> instead of <code>XYZ.EXE</code>, then you may as well fool them into running <code>pwnz0rd.exe</code>. It’s not like the <code>Create­Process</code> function performs a hard drive scan looking for a program whose name is similar to the one you requested and running that other program instead. </p>


</body>