<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Windowless controls are not magic</h1>  <!-- .entry-meta -->

<p>It seems that when people notice that the Internet Explorer rendering engine doesn’t use HWNDs for screen elements, they think that Internet Explorer is somehow “cheating” and doing something “undocumented” and has an “unfair advantage”.
 Nevermind that <a href="http://msdn.microsoft.com/workshop/components/activex/buildax.asp"> windowless controls have been around since 1996</a>. They aren’t magic. Mind you, they’re <strong>a lot of work</strong>, but they aren’t magic.
 Clearly Internet Explorer cannot create a real HWND for every element in an HTML page. <a href="http://support.microsoft.com/default.aspx?kbid=326591"> There is a limit of 10,000 USER handles per process</a>, and you are likely to <a href="http://support.microsoft.com/default.aspx?kbid=126962"> run out of desktop heap long before then</a>.
 The Internet Explorer team went and reimplemented all of the controls that a web page would need.  They have their own windowless checkbox control, a windowless listbox control, a windowless edit box, and so on.  In addition to reproducing all the functionality of the windowed controls, the Internet Explorer folks also had to reproduce the “look” of the windowed controls, down to the last pixel. (Functions like <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/userex/functions/drawthemebackground.asp"> DrawThemeBackground</a> and <a href="http://msdn.microsoft.com/library/en-us/gdi/pantdraw_4b3g.asp"> DrawFrameControl</a> prove extremely helpful here.)
 If I recall correctly, the only element that is still windowed is <a href="http://msdn.microsoft.com/workshop/author/dhtml/reference/objects/select.asp"> the &lt;SELECT&gt; element</a>.
 If you squint, you can see some places where they didn’t quite nail it. For example, if you right-click in a text box, options like “Right to left reading order” and “Insert Unicode control character” are missing. As another example, notice that IE’s scroll bars do not light up when you hover over them.</p>
<p> Remember, I never worked on Internet Explorer; all I know is what I learn from people from that team. (<a href="http://blogs.msdn.com/jeffdav/">jeffdav</a> for example, joins the shell team for lunch nearly every day.) If you have questions about Internet Explorer, you would likely have much better success asking the Internet Explorer team yourself via <a href="http://blogs.msdn.com/IE/">their team blog</a>. </p>


</body>