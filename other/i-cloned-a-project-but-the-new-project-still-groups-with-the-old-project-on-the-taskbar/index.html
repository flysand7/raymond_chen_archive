<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">I cloned a project, but the new project still groups with the old project on the taskbar</h1>  <!-- .entry-meta -->


<p>Alternate title from a non-programmer point of view: <i>When I copy an executable to another name, sometimes it groups separately, and sometimes it groups with the original</i>. </p>
<p>A customer had a product, let’s call it Contoso Designer. They decided to try an experimental new version of Contoso Designer. So they cloned the Contoso Designer project, and then started changing the parts of the program that were related to the experiment. </p>
<p>When they did this, they noticed that Contoso Designer Experimental and Contoso Designer both grouped together in the taskbar. This isn’t what they wanted, because the original and the experimental versions were not replacements for each other; they are separate programs that merely happen to have started out from the same code base. </p>
<p>So they ran another experiment. </p>
<p>They created a scratch project, put a scratch program in it, compiled it, and ran it. They then copied the <code>scratch.exe</code> file to <code>scratch2.exe</code> and ran that one, and it did not group with <code>scratch.exe</code> in the taskbar. Then they cloned the scratch project, recompiled the scratch program, and ran the clone. All three copies were separate in the taskbar. </p>
<p>So what was haunted about their project that caused the clone to have a secret psychic connection to the original, and group together with it? And more important, how do they get it to stop? </p>
<p>The answer is in the Application User Model ID. As we saw <a href="http://blogs.msdn.com/b/oldnewthing/archive/2015/08/10/10634022.aspx">some time ago</a>, the Application User Model ID is how the taskbar identifies applications. If two processes have the same Application User Model ID, then they are treated as the same application, even if the physical executable is different. In other words, the program and its clone were following the instructions in that article and saying, “I want these programs to group together.” </p>
<p>Given that nudge, the customer wrote back, “Thanks. Updating the call to <code>Set­Current­Process­Explicit­App­User­Model­ID</code> did the trick.” </p>
<p>I hope they remembered to update their Start menu shortcut, too. </p>


</body>