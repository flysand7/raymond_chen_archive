<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How do I inflate a bicycle tire with a potato?</h1>  <!-- .entry-meta -->

<p>
I see this all the time.
</p>
<p>
People have a problem and have already decided what technology they’re
going to use to solve it, and then they hit a roadblock:
The technology they picked is unsuited to the problem!
</p>
<blockquote class="q"><p>
How do I put my laptop into standby mode from VBScript?
</p></blockquote>
<blockquote class="q"><p>
How do I change the user’s mouse acceleration from a batch file?
I changed the registry values but it doesn’t take effect immediately.
</p></blockquote>
<p>
The functionality you seek is implemented in native code via Win32.
At the end of the day, the solution involves calling
<code>SetSystemPowerState</code> or
<code>SystemParametersInfo(SPI_SETMOUSE)</code>,
since those are the functions that actually do the work.
</p>
<p>
There’s no law that forbids writing programs in C or C++,
particularly since that’s the target language for the native
bits of Win32.
Go ahead, write that program, and then call it from your batch file.
</p>
<p>
Now, it’s possible that you can get somebody else to play
middle-man for you.
For example, if you wanted to shut down the computer,
you can get the <code>shutdown.exe</code> program to help out.
And if you had chosen wisely,
the technology you already decided upon may wrap the Win32
functionality inside a helper function or class,
or it may provide
a way of calling into native Win32 code. For example,
your Visual Basic program could just call <code>SetSystemPowerState</code>
via a platform invoke:
</p>
<pre>
&lt;DllImport("kernel32.dll")&gt;
Public Shared Function SetSystemPowerState(_
      fSuspend As Boolean, _
      fForce As Boolean) As Boolean
SetSystemPowerState(True, False)
</pre>
<p>
(Note: I don’t speak Visual Basic, so I may have gotten the details
wrong, but I hope you get the idea.)</p>


</body>