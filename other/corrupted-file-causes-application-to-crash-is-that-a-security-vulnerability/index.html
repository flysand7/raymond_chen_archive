<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Corrupted file causes application to crash; is that a security vulnerability?</h1>  <!-- .entry-meta -->

<p>A security vulnerability report came in that went something like this: </p>
<blockquote class="q"><p>We have found a vulnerability in the XYZ application when it opens the attached corrupted file. The error message says, “Unhandled exception: System.OverflowException. Value was either too large or too small for an Int16.” For a nominal subscription fee, you can learn about similar vulnerabilities in Microsoft products in the future. </p></blockquote>
<p>Okay, so there is a flaw in the XYZ application where a file that is corrupted in a specific way causes it to suffer an unhandled exception trying to load the file. </p>
<p>That’s definitely a bug, and thanks for reporting it, but is it a security vulnerability? </p>
<p>The attack here is that you create one of these corrupted files and you trick somebody into opening it. And then when they open it, the XYZ application crashes. The fact that an <code>Overflow­Exception</code> was raised strongly suggests that the application was diligent enough to do its file parsing <!-- backref: The scope of the C# checked/unchecked keyword is static, not dynamic -->under the <code>checked</code> keyword, or that the entire module was <a href="http://msdn.microsoft.com/en-us/library/h25wtyxf.aspx">compiled with the <code>/checked</code> compiler option</a>, so that any overflow or out-of-range errors raise an exception rather than being ignored. That way, the overflow cannot be used as a vector to another attack. </p>
<p>What is missing from the story is that nobody was set up to catch the overflow exception, so the corrupted file resulted in the entire application crashing rather than some sort of “Sorry, this file is corrupted” error being displayed. </p>
<p>Okay, so let’s assess the situation. What have you gained by tricking somebody into opening the file? The program detects that the file is corrupted and crashes instead of using the values in it. There is no code injection because the overflow is detected at the point it occurs, before any decisions are made based on the overflowed value. Consequently, there is no elevation of privilege. All you got was a denial of service against the XYZ application. (The overflow checking did its job and stopped processing as soon as corruption was detected.) </p>
<p>There isn’t even data loss, because the problem occurred while loading up the corrupted file. It’s not like the XYZ application had any old unsaved data. </p>
<p>At the end of the day, the worst you can do with this crash is annoy somebody. </p>
<p>Here’s another way you can annoy somebody: Send them a copy of <a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/02/12/10392805.aspx">onestop.mid</a>. </p>


</body>