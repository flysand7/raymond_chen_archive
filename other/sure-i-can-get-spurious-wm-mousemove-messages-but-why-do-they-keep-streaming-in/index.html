<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Sure, I can get spurious WM_MOUSEMOVE messages, but why do they keep streaming in?</h1>  <!-- .entry-meta -->

<p>I wrote some time ago that <a href="http://blogs.msdn.com/oldnewthing/archive/2003/10/01/55108.aspx"> the window manager generates spurious <code>WM_MOUSEMOVE</code> messages</a> in order to let programs know that the mouse has entered the window even if the reason was a window hierarchy reshuffle rather than a physical motion of the pointing device. But some people have noticed that <a href="http://blogs.msdn.com/oldnewthing/archive/2003/10/01/55108.aspx#55109"> that explanation fails to account for all the <code>WM_MOUSEMOVE</code> messages that are being delivered</a>. In particular, the reasoning fails to explain why a stream of <code>WM_MOUSEMOVE</code> messages is being generated. So where is this infinite stream of <code>WM_MOUSEMOVE</code> messages coming from, even when the window hierarchy is stable?</p>
<p> They’re most likely coming from some third party so-called enhancement software. </p>
<p> The Windows performance and mobility teams keep a close eye on these sort of continuous phenomena. The performance folks are interested because this continuous stream of messages suck away resources that could be used for something more productive. It’s not just the cost in CPU. The memory in the message handling code path can’t be paged out since it’s being hit all the time. The context switches force CPU caches to be flushed. Algorithms which had been tuned to reside entirely within the L2 cache now find themselves going out to slower main memory. Meanwhile, the mobility team is concerned because all this continuous activity runs down your battery, prevents the CPU from going into a low-power state, and <a href="http://www.gottabemobile.com/forum/forum_posts.asp?TID=4419&amp;PID=28758#28758"> prevents your screen saver from kicking in</a>. </p>
<p> If you find a continuous stream of <code>WM_MOUSEMOVE</code> messages, then there is some continuous activity going on that is causing it. It might be some software that is polling the mouse in order to provide “extra value”. For example, they might check the mouse cursor position and try to guess what it is positioned over, but they never realize that “You know, if nothing has changed, the answer is probably the same as it as last time you checked.” Or, as the author of linked posting above eventually figured out, it might be a buggy wireless mouse which not only is sucking down your CPU and preventing your screen saver from running, but is also draining your wireless mouse battery! </p>


</body>