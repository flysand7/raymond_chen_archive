<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why can't I install this DLL via Regsvr32 /i?</h1>  <!-- .entry-meta -->

<p>A customer asked for help installing a particular DLL. They ran the command <code>regsvr /i SomeDll.dll</code> but got the error “SomeDll.dll was loaded, but the DllInstall entry point was not found. This file can not be registered.”
 A DLL needs to be specifically written to be used with the <code>regsvr32</code> command. You can’t just grab some random DLL and expect <code>regsvr32</code> to work. As we saw last week, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/11/10/10235540.aspx"> the <code>regsvr32</code> program merely loads the specified DLL and calls an entry point established by convention</a>. If the DLL was not written to be used with <code>regsvr32</code> then the conventional entry point will not be found, and you get an error message.
 The <code>/i</code> switch to <code>regsvr32</code> instructs the program to look for <a href="http://msdn.microsoft.com/library/bb759846.aspx"> the entry point known as <code>Dll­Install</code></a>. By convention, the <code>Dll­Install</code> function performs installation and setup of a DLL, but since it’s just some function exported by a DLL, it could do anything it wants (or nothing at all).
 You can’t just <a href="http://social.technet.microsoft.com/Forums/en/itprovistaapps/thread/edf883c6-ecdc-4473-b21c-0d6aba3ec748"> grab a random DLL and expect <code>regsvr32</code> to do anything meaningful with it</a>. The DLL has to be designed to operate with <code>regsvr32</code>.
 Handing random DLLs to <code>regsvr32</code> is like dialing a random telephone number, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/11/11/10235970.aspx"> sending a tone at 1170Hz</a> and getting upset when you don’t <a href="http://en.wikipedia.org/wiki/War_dialing"> get a 2125Hz tone in response</a>.
 The number one hit for a search on <a href="http://www.bing.com/search?q=what+does+regsvr32+do"> <i>what does regsvr32 do</i></a> is an old Knowledge Base article which <a href="http://support.microsoft.com/kb/207132"> explains what <code>regsvr32</code> does</a>, and it even contains a sample program which emulates <code>regsvr32</code> so you can use it to debug your DLL. (The sample program hasn’t been updated to support the <code>/i</code> flag, which I leave as an exercise.)
 One day, I received a piece of email from another employee whom I had never met nor had ever heard of. It didn’t even begin with an introduction; it just jumped right in as if we’d been friends for years. “I’m trying to debug a problem where regsvr32 cannot register my DLL. It gives the error ‘The specified procedure could not be found.’ I saw a blog entry written by you and am trying to understand what our problem is.”
 This blog thing has backfired. The reasons I write these articles is to get people to <i>stop</i> asking me questions. (The mechanism for that being to give the answer out in public for everyone to see.) Instead, it turns into “Hi, I found an article you wrote about X, which <i>ipso facto</i> makes you not only the world’s foremost authority on X, but also the world’s leading support technician on X.”
 News flash: Posting a blog entry about something on the Internet should not be taken as evidence that the author is an expert on that subject. (One might argue that it in fact is more likely to be the opposite.)
 At the time, I wasn’t aware of the knowledge base article that explains what <code>regsvr32</code> does and how to debug it, so I couldn’t point to it. I wrote back, “All <code>regsvr32</code> does is <code>Load­Library</code>, <code>Get­Proc­Address</code>, and then calls the function. You can write your own test that does the same thing. You do not require any expertise from me.”
 Less than an hour later, I received a reply: “Thanks. I figured it out. There was an older version of the DLL in the path ahead of the one I was trying to register.”</p>
<p> And I never did figure out which blog entry I wrote that made them think I was an expert on <code>regsvr32</code>. Maybe the person worked in Microsoft Research and used a prototype of <a href="http://www.wired.com/epicenter/2010/05/video-microsoft-attempts-to-predict-the-future/"> their machine that predicts the future</a>, and used it to predict that I was going to write about <code>regsvr32</code> two years later. </p>


</body>