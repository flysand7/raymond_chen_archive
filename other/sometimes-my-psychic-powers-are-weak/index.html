<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Sometimes my psychic powers are weak</h1>  <!-- .entry-meta -->

<blockquote class="q">
<p>
Why does my MFC program exit unexpectedly?
The stack trace at the point we hit <code>ExitInstance</code>
goes like this:
</p>
<pre>
CClientConsoleApp::ExitInstance
CWinThread::Run+0x88
AfxWinMain+0x84
_wWinMainCRTStartup+0x138
BaseThreadInitThunk+0xe
_RtlUserThreadStart+0x23
</pre>
<p>
Thanks.
</p>
</blockquote>
<p>
You can already see some of what’s going on, but clearly
more information is needed.
My first psychic suggestion was to examine MFC’s message
pump to see what causes it to exit.
Then follow the money backwards.
</p>
<blockquote class="q"><p>
That’s what we want to know and what we want to find out.
</p></blockquote>
<p>
MFC comes with source code so you can do this yourself.
Don’t expect somebody to do your debugging for you.
You have the tools to do it yourself:
You have the source code and you have a brain.
</p>
<p>
Once you figure out what conditions make MFC’s message pump exit,
then try to figure out which of those conditions is actually
occurring, and then set breakpoints to try to catch the
condition being achieved.
</p>
<p>
I don’t have the MFC source code memorized and I didn’t feel
like installing it just to help somebody solve their own problem,
so I resorted to wild guessing in the guise of psychic powers:
</p>
<blockquote class="q"><p>
I don’t know what MFC’s message pump looks like
but my psychic powers tell me that it stops when it gets a
<code>WM_QUIT</code> message.
My psychic powers are losing strength
from being so heavily stressed so early in the morning…
I see a shadow, a vague form,
it’s not all that clear, kind of hazy,
it might be… yes I think it says
“<code>PostQuitMessage</code>“…
hard to tell… connection fading…
</p></blockquote>
<p>
(Sorry, I can’t finish up this story with a snappy ending.
It happened so long ago I forget what the problem was.)</p>


</body>