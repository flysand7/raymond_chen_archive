<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">It rather involved being on the other side of this airtight hatchway: Account vulnerable to Active Directory administrator</h1>  <!-- .entry-meta -->

<p>A security vulnerability report came in that went something like this:</p>
<blockquote class="q"><p> <b>Disclosure of arbitrary data from any user</b> </p>
<p> An attacker can obtain arbitrary data from any user by means of the following steps: </p>
<ol>
<li>Obtain administrative access on the domain controller. </li>
<li>Stop the XYZZY service. </li>
<li>Edit the XYZZY.DAT file in a hex editor     and changes the bytes starting     at offset 0x4242 as follows: </li>
<li>… </li>
</ol>
</blockquote>
<p> There’s no point continuing, because the first step assumes that you are on the other side of the airtight hatchway. If you have compromised the domain controller, then you control the domain. From there, all the remaining steps are just <a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/04/09/9539191.aspx"> piling on style points and cranking up the degree of difficulty</a>.
 A much less roundabout attack is as follows:</p>
<blockquote class="q">
<ol>
<li>Obtain administrative access on the domain controller. </li>
<li>Deploy a logon script to all users that     <i>does whatever you want</i>. </li>
<li>Wait for the user to log in next, and your script will     DO ANYTHING YOU WANT. </li>
</ol>
</blockquote>
<p> No, wait, I can make it even easier.</p>
<blockquote class="q">
<ol>
<li>Obtain administrative access on the domain controller. </li>
<li>Change the victim’s password. </li>
<li>Log on as that user and DO ANYTHING YOU WANT. </li>
</ol>
</blockquote>
<p> You are the domain administrator. You already pwn the domain. That you can pwn a domain that you pwn is really not much of a surprise.</p>
<p> This is why it is important to choose your domain administrators carefully. </p>


</body>