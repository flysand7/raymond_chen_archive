<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">When you start talking about numbers as small as 2⁻¹²², you have to start looking more closely at the things you thought were zero</h1>  <!-- .entry-meta -->

<p>GUID generation algorithm 4 fills the GUID with 122 random bits. The odds of two GUIDs colliding are therefore one in 2¹²², which is a phenomenally small number. When you are dealing with rates this low, you have to adjust your frame of reference. </p>
<p>Some people don’t like algorithm 4 because the algorithm is not designed to ensure uniqueness. There is a chance, admittedly small, that a collision will occur. On the other hand, algorithm 1, for example, uses time-space coordinates to ensure <a href="https://blogs.msdn.microsoft.com/oldnewthing/20150410-00/?p=44263#comment-1184493">zero chance of duplication, unless someone screws up the generation process</a>. </p>
<p>Hang on a second. “Unless someone screws up the generation process.” Ah, so it’s not zero after all, because there is of course a tiny chance that something will get screwed up in the generation process. </p>
<p>According to <a href="http://www.cs.toronto.edu/~bianca/papers/sigmetrics09.pdf">this research paper (pdf)</a>, memory chips suffer 25,000 to 70,000 errors per billion hours per megabit. Let’s do some back-of-the-envelope calculations. </p>
<table border="0" style="text-align: center">
<tr>
<td>    25,000 to 70,000 errors     
<hr style="border-color: inherit;color: black;background-color: black"/>    10⁹ hours × 2²⁰ bits     </td>
<td>     ≈      </td>
<td>    2¹⁵ errors     
<hr style="border-color: inherit;color: black;background-color: black"/>    2³⁰ hours × 2²⁰ bits     </td>
<td>     =      </td>
<td>    1 error     
<hr style="border-color: inherit;color: black;background-color: black"/>    2³⁵ hours × bits     </td>
</tr></table>
<p>Now let’s see how this error rate converts to “corrupted GUIDs”. </p>
<table border="0" style="text-align: center">
<tr>
<td>    1 error     
<hr style="border-color: inherit;color: black;background-color: black"/>    2³⁵ hours × bits     </td>
<td>     ×      </td>
<td>    2⁷ bits     
<hr style="border-color: inherit;color: black;background-color: black"/>    1 GUID     </td>
<td>     ×      </td>
<td>    1 hour     
<hr style="border-color: inherit;color: black;background-color: black"/>    60 × 60 × 10⁹ nanoseconds     </td>
</tr></table>
<p>Now, 60 × 60 = 3600 is approximately 4096 = 2¹², and 10⁹ is approximately 2³⁰. </p>
<table border="0" style="text-align: center">
<td>    ≈      </td>
<td>    2⁷ errors     
<hr style="border-color: inherit;color: black;background-color: black"/>    2³⁵ × 2¹²     × 2³⁰ GUID × nanosecond     </td>
<td>     =      </td>
<td>    1 errors     
<hr style="border-color: inherit;color: black;background-color: black"/>    2⁷⁰ GUID × nanosecond     </td>
</table>
<p>The odds that a GUID will be corrupted in memory in the one nanosecond between the time it is created and the time the value is copied somewhere safe is therefore around one in 2⁷⁰. </p>
<p>This is 2⁵² ≈ 10¹⁵ = a quadrillion* times more likely than a collision between two GUIDs generated by algorithm 4. </p>
<p>And that’s just mechanical failures in the RAM chips. There are other ways that the generation process can get screwed up. For example, there could be a failure in the CPU itself, maybe due to overheating or <a href="https://blogs.msdn.microsoft.com/oldnewthing/20050412-47/?p=35923">overclocking</a>. Or a bit error on the hard drive. Or <a href="https://blogs.msdn.microsoft.com/oldnewthing/20091001-00/?p=16533">a programming error</a>. </p>
<p>When you start talking about numbers as small as 2⁻¹²², you have to start looking more closely at all the things that you thought were zero. </p>
<p>* Or “a thousand billion” if you use the European scale. </p>
<p><b>Bonus chatter</b>: Note that I’m not saying that a collision caused by a random bit flip is more likely than a collision caused by a v4 GUID happening to match some other v4 GUID. I’m saying that it’s wrong to say that the v1 GUID generator will never generate a collision, because there’s a nonzero probability that the v1 GUID generator will deviate from the algorithm. Sure, that probably may be minuscule, but when you’re dealing with numbers like 2⁻¹²², these minuscule probabilities become significant. </p>


</body>