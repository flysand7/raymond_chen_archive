<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Dubious security vulnerability: Code execution via LNK file</h1>  <!-- .entry-meta -->

<p>A security vulnerability report arrived that claimed to have achieved code execution via a shortcut (LNK) file. The report was somewhat convoluted, but it went something like this:</p>
<ol>
<li>Start with this pre-fabricated shortcut file.</li>
<li>Copy it to a folder of your choosing.</li>
<li>Edit the shortcut file in this very special way, substituting the full path to the shortcut file where specified.</li>
<li>Double-click the shortcut file.</li>
<li>Code execution is achieved!</li>
</ol>
<p>If you can trick the user into double-clicking an arbitrary shortcut file of your choosing, then you don’t have to do all this weird special editing nonsense.</p>
<ol>
<li>Create a shortcut that runs <code>pwnzor.exe</code> directly from an Internet-accessible file share.</li>
<li>Double-click the shortcut file.</li>
<li>Code execution is achieved!</li>
</ol>
<p>When phrased this way, it’s clear that the attack is really a social engineering attack: If you can convince a user to do anything you tell them to, then you can get them to do anything.</p>
<p>This in itself is not particularly interesting.</p>
<p>Upon closer inspection, what the finder was actually reporting was that they found a clever way to make a file both a legal LNK file and a legal script file. The “Edit the shortcut file in this very special way” was setting things up so that the LNK file could feed itself to the script engine.</p>
<p>This was an interesting discovery, the ability to <a href="https://en.wikipedia.org/wiki/Polyglot_(computing)">polyglot</a> a LNK file with a script file. But it’s not a security vulnerability. It’s just a curiosity.</p>
<p>Because you still have to convince the user to run it.</p>


</body>