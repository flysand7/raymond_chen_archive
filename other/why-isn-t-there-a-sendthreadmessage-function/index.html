<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why isn’t there a SendThreadMessage function?</h1>  <!-- .entry-meta -->

<p>Here’s an interesting customer question:</p>
<blockquote class="m"><p> Windows has <code>PostMessage</code> and <code>SendMessage</code>. It also has <code>PostThreadMessage</code> but no <code>SendThreadMessage</code>. Why isn’t there a <code>SendThreadMessage</code> function? Am I forced to simulate it with an event? </p></blockquote>
<p> What would this imaginary <code>SendThreadMessage</code> function do? Recall that <code>SendMessage</code> delivers the message directly to the window procedure; the message pump never sees it. The imaginary <code>SendThreadMessage</code> function would have to deliver the message directly to…. what? There is no “thread window procedure” to deliver it to. </p>
<p> Okay, maybe you still intend to process the thread message in your message pump, but you want the caller of the imaginary <code>SendThreadMessage</code> function to wait until you’ve finished processing the message. But how does it know when you’re finished? It can’t wait for <code>DispatchMessage</code> to return, since <code>DispatchMessage</code> can’t dispatch thread messages. (Where would it dispatch them <i>to</i>?) The processing of the thread message is completely under the control of the message pump. The window manager gives it a thread message, and as far as the window manager is concerned, that’s the end of the story. </p>
<p> You might say that the processing of the thread message is complete when somebody next calls <code>GetMessage</code> or <code>PeekMessage</code>, but there’s no guarantee that the next call to a message-retrieval function will come from the message pump. Handling the thread message may result in a call to <code>MessageBox</code>, and as a modal function, it will have its own message loop, which will call <code>GetMessage</code>, resulting in your imaginary <code>SendThreadMessage</code> function deciding that message processing is complete when in fact it’s still going on. </p>
<p> What should you do instead? Just create a window and send it a message. The scenarios where you would want to use the <code>PostThreadMessage</code> function are very limited and specialized. Under normal circumstances, you should just send a regular window message. </p>


</body>