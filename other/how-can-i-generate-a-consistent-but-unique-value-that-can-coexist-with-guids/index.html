<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How can I generate a consistent but unique value that can coexist with GUIDs?</h1>  <!-- .entry-meta -->

<p>A customer needed to generate a GUID for each instance of a hardware device they encounter:</p>
<blockquote class="q"><p> The serial number for each device is 20 bits long (four and a half bytes). We need to generate a GUID based on each device, subject to the constraints that when a device is reinserted, we generate the same GUID for it, that no two devices generate the same GUID, and that the GUIDs we generate not collide with GUIDs generated by other means. One of our engineers suggested just running <code>uuidgen</code> and substituting the serial number for the final nine hex digits. Is this a viable technique? </p></blockquote>
<p> This is similar to the trap of thinking that <a href="http://blogs.msdn.com/oldnewthing/archive/2008/06/27/8659071.aspx"> half of a GUID is just as unique as the whole thing</a>. Remember that all the pieces of a GUID work together to establish uniqueness. If you just take parts of it, then the algorithm breaks down.
 For this particular case, you’re in luck. The classic Type 1 GUID uses 60 bits to encode the timestamp and 48 bits to identify the location (computer). You can <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/02/11/71307.aspx"> take a network card, extract the MAC address, then smash the card with a hammer</a>. Now you have a unique location. Put your twenty bits of unique data as the timestamp, and you have a Type 1 GUID that is guaranteed never to collide with another GUID.</p>
<p> If you have more than 60 bits of unique data, then this trick won’t work. Fortunately, <a href="http://www.apps.ietf.org/rfc/rfc4122.html">RFC4122</a> explains how to create a so-called <i>name-based UUID</i>, which is a UUID that can be reliably regenerated from the same source data. <a href="http://www.apps.ietf.org/rfc/rfc4122.html#sec-4.3"> Section 4.3 explains how it’s done</a>. The result is either a <a href="http://www.apps.ietf.org/rfc/rfc4122.html#sec-4.1.3"> type 3 or type 5 UUID</a>, depending on which variant of the algorithm you chose. </p>


</body>