<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How can I figure out which user modified a file?</h1>  <!-- .entry-meta -->

<p>The <code>Get­File­Time</code> function will tell you <i>when</i> a file was last modified, but it won’t tell you who did it. Neither will <code>Find­First­File</code>, <code>Get­File­Attributes</code>, or <code>Read­Directory­ChangesW</code>, or <code>File­System­Watcher</code>.</p>
<p> None of these the file system functions will tell you which user modified a file because the file system doesn’t keep track of which user modified a file. But there is somebody who <i>does</i> keep track: The security event log. </p>
<p> To generate an event into the security event log when a file is modified, you first need to enable auditing on the system. In the <i>Local Security Policy</i> administrative tool, go to <i>Local Policies</i>, and then double-click <i>Audit Policy</i>. (These steps haven’t changed <a href="http://support.microsoft.com/kb/300549"> since Windows 2000</a>; the only thing is that the Administrative Tools folder <a href="http://support.microsoft.com/kb/310399"> moves around a bit</a>.) Under <i>Audit Object Access</i>, say that you want an audit raised when access is successfully granted by checking <i>Success (An audited security access attempt that succeeds)</i>. </p>
<p> Once auditing is enabled, you can then mark the files that you want to track modifications to. On the <i>Security</i> tab of each file you are interested in, go to the <i>Auditing</i> page, and select <i>Add</i> to add the user you want to audit. If you want to audit all accesses, then you can choose <i>Everyone</i>; if you are only interested in auditing a specific user or users in specific groups, you can enter the user or group. </p>
<p> After specifying whose access you want to monitor, you can select what actions should generate security events. In this case, you want to check the <i>Successful</i> box next to <i>Create files / write data</i>. This means “Generate a security event when the user requests and obtains permission to create a file (if this object is a directory) or write data (if this object is a file).” </p>
<p> If you want to monitor an entire directory, you can set the audit on the directory itself and specify that the audit should apply to objects within the directory as well. </p>
<p> After you’ve set up your audits, you can view the results in <i>Event Viewer</i>. </p>
<p> This technique of using auditing to track who is generating modifications also works for registry keys: Under the <i>Edit</i> menu, select <i>Permissions</i>. </p>
<p> <b>Exercise</b>: You’re trying to debug a problem where a file gets deleted mysteriously, and you’re not sure which program is doing it. How can you use this technique to log an event when that specific file gets deleted? </p>


</body>