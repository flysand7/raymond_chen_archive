<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The inability to lock someone out of the registry is a feature, not a bug</h1>  <!-- .entry-meta -->

<p>There is no way to lock the registry. Whereas you can open a file with a <i>deny all</i> sharing mode to prevent anyone else from opening the file, the registry has no such provision. You can’t lock a registry key and prevent others from reading from or writing to it. There is an internal lock on the registry, but that’s just to ensure that registry operations are atomic; that is, that if one thread writes a value to the registry and another thread reads that same value from the registry, then the value that comes back is either the value before the write took place or the value after the write took place, but not some sort of mixture of the two.</p>
<p> <a href="http://blogs.msdn.com/oldnewthing/archive/2006/02/22/536920.aspx#537376"> Some people consider the inability to lock the registry to be a bug</a> but it’s actually a feature. It means that nobody can launch a denial of service attack against the registry by opening a key in an exclusive mode and preventing anybody else from reading it. This is important, because many security settings are stored in the registry, and locking somebody out of a registry key means that the part of the operating system whose job it is to enforce the security of a particular feature would no longer be able to check whether the operation is allowed. </p>
<p> This all means that if you’re reading from the registry, you have to accept that the contents can change while you’re reading them, in the same way that <a href="http://blogs.msdn.com/oldnewthing/archive/2007/11/09/6001644.aspx"> you have to accept that the file system can change</a>. If you’re writing to the registry, you can take advantage of <a href="http://msdn.microsoft.com/en-us/library/bb852232.aspx"> transactional registry support</a> new to Windows Vista. </p>


</body>