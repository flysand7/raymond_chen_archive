<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">The StartRunNoHOMEPATH policy affects whether the user's HOME path is the current directory when you use Start.Run, but make sure you read that carefully</h1>  <!-- .entry-meta -->

<p>A customer (via the customer liaison) discovered that even though they had set <a href="http://support.microsoft.com/kb/264061"> the <code>Start­Run­No­HOME­PATH</code> policy</a>, they found “if the user creates a Notepad file, the file is searched in the user’s HOME directory, in contradiction of <code>Start­Run­No­HOME­PATH</code> policy,”
 I asked the liaison to confirm: “The steps you describe are rather vague. Are you saying that the problem occurs when the user opens the Run dialog and types <code>Notepad filename.txt</code>?”
 The customer liaison replied, “I believe the scenario is close to what you describe. The user opens the Run dialog, types <code>Notepad</code>, then types some text into Notepad and then does a <i>Save As</i>. I will confirm with the customer.”
 A few days later (the customer was on leave), the customer liaison provided the exact steps:</p>
<ul>
<li>Open the Start menu (Windows 7) </li>
<li>Type <code>Notepad</code> to search the Start menu. </li>
<li>When the Notepad program is found, click on it. </li>
<li>Type some text. </li>
<li>Perform a <i>Save As</i>.     This operation is slow.     Network traces show many accesses to the user’s HOME directory. </li>
</ul>
<p> Okay, well, now that the steps are all carefully spelled out, it is clear what is going on. Or more accurately, it is clear what is <i>not</i> going on.
 The <code>Start­Run­No­HOME­PATH</code> policy controls the working directory when a program is run from the Start.Run dialog. <a href="http://support.microsoft.com/kb/264061"> Like it says in the KB article</a>:</p>
<blockquote class="q"><p> <b>Symptoms</b> </p>
<p> If you have a home folder set and you try to run a program by clicking <b>Start</b> and then clicking <b>Run</b>, Windows searches your home folder for the program before searching the path. </p>
</blockquote>
<p> The article then goes on to describe how you can solve the problem if those are the symptoms you are trying to relieve.
 But those symptoms do not match the customer’s problem.
 The customer ran the program directly from the Start menu, not by going through the Start.Run dialog. Therefore, the KB article and the <code>Start­Run­No­HOME­PATH</code> policy do not apply.</p>
<p> Policies do what they are documented to do, not what you wish they did. </p>


</body>