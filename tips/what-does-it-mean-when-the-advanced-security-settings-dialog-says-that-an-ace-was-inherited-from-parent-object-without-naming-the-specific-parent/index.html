<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What does it mean when the Advanced Security Settings dialog says that an ACE was inherited from "Parent Object" without naming the specific parent?</h1>  <!-- .entry-meta -->

<p>The Advanced Security Settings dialog shows the ACEs in an object’s ACL, and one of the pieces of information is a column labeled <i>Inherited from</i> which identifies whether the ACE was inherited, and if so, from where. A customer observed that when they opened the Advanced Security Settings dialog, one of their objects had an ACE that showed <i>Parent Object</i> as the <i>Inherited from</i>.</p>
<table style="background-color: white;font-family: Segoe UI, Tahoma, Arial, sans-serif;font-size: 10pt;border: solid 1px black">
<tr>
<td> Name: C:\dir1\dir2\dir3\dir4\file </td>
</tr>
<tr>
<td>
<table border="0" cellspacing="0" style="background-color: white;font-family: Segoe UI, Tahoma, Arial, sans-serif;font-size: 10pt;border: solid 1px black;border-collapse: separate">
<tr bgcolor="#FCFCFC">
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em">Type</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em;width: 10em">Principal</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em">Access</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em;width: 8em">Inherited from</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em">Applies to</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Administrators</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">None</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder only</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Administrators</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">SYSTEM</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">CREATOR OWNER</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Subfolders and files only</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Users</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Read &amp; execute</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Users</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Special</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder and subfolders</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Authenticated Users</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Parent Object <font color="red">⇐</font></td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
</table>
</td>
</tr>
</table>
<p> However, when they went to the parent object <code>C:\dir1\dir2\dir3\dir4</code>, that ACE is nowhere to be found.</p>
<table style="background-color: white;font-family: Segoe UI, Tahoma, Arial, sans-serif;font-size: 10pt;border: solid 1px black">
<tr>
<td> Name: C:\dir1\dir2\dir3\dir4 </td>
</tr>
<tr>
<td>
<table border="0" cellspacing="0" style="background-color: white;font-family: Segoe UI, Tahoma, Arial, sans-serif;font-size: 10pt;border: solid 1px black;border-collapse: separate">
<tr bgcolor="#FCFCFC">
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em">Type</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em;width: 10em">Principal</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em">Access</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em;width: 8em">Inherited from</td>
<td nowrap="" style="border: solid 1px #e1e1e1;padding-left: 2pt;padding-right: 1em">Applies to</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Administrators</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">None</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder only</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Administrators</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">SYSTEM</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">CREATOR OWNER</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Subfolders and files only</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Users</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Read &amp; execute</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Users</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Special</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder and subfolders</td>
</tr>
<tr>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Allow</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Everyone</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">Full control</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">C:\dir1\dir2\</td>
<td nowrap="" style="padding-left: 2pt;padding-right: 1em">This folder, subfolders and files</td>
</tr>
</table>
</td>
</tr>
</table>
<p> How can an ACE be inherited from its parent, when it doesn’t exist in the parent?
 The Advanced Security Settings dialog is trying to be helpful, but in doing so, it implies a greater level of confidence than it actually offers.
 ACEs do not specify where they were inherited from. There is merely a bit in the ACE called <code>INHERITED_ACE</code> which means, “This ACE was created via inheritance.” Not only does this bit not tell you where the ACE was inherited from, but the bit might even be wrong! Anybody can go in and toggle the bit, and bingo, you now have forged the “I was created via inheritance” flag. Another way this flag could be out of sync is if the user started an ACL update operation and then <!-- backref: If you cancel an operation while it's in progress, then it's not surprising that it's only half-done --> canceled it partway through.
 The Advanced Security Settings dialog uses the <a href="http://msdn.microsoft.com/library/aa446640"> <code>Get­Inheritance­Source</code></a> function to determine the source of each ACE. That function walks up the parent chain looking for matching inheritable ACEs. If a match is found, then the Advanced Security Settings dialog  shows that parent as the <i>Inherited from</i>. Otherwise, it shrugs its shoulders and says <i>Parent Object</i>.
 The string <i>Parent Object</i> means “This ACE claims to have been inherited from somewhere, but I can’t figure out where, so I’m just going to be vague and say that it came from some parent object somewhere.” Perhaps a less confusing string would have been <i>Ancestor Object</i> or even simply <i>Unknown</i>.</p>
<p> The Advanced Security Settings dialog figured that it would go the extra mile and instead of merely saying <i>Inherited = Yes</i>, it would try to find a parent object that was the most likely source of the inheritance. But by doing that, you came to expect it, and then you got upset when it wasn’t able to come through for you. No good deed goes unpunished. </p>


</body>