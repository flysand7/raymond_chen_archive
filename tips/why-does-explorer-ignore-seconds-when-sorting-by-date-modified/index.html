<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does Explorer ignore seconds when sorting by Date Modified?</h1>  <!-- .entry-meta -->

<p>A customer reported that Explorer appears to be ignoring the seconds when sorting by Date Modified. The customer was kind enough to include detailed steps to reproduce the problem.</p>
<blockquote class="m"><p>  Start with a folder with several files, sorted by Date Modified. </p>
<table style="border: solid .75pt black">
<col style="padding-right: 1em"/>
<tr>
<td bgcolor="#F0F0F0" style="width: 15em">Name</td>
<td bgcolor="#D0D0D0">Date modified <font size="-2">▼</font></td>
<td bgcolor="#F0F0F0">Type</td>
<td bgcolor="#F0F0F0" style="width: 5em"></td>
</tr>
<tr>
<td>TPS 06-05-2012 Report</td>
<td>6/12/2012 7:00 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-29-2012 Report</td>
<td>6/5/2012 11:30 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-22-2012 Report</td>
<td>5/29/2012 10:17 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-15-2012 Report</td>
<td>5/22/2012 2:35 PM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-09-2012 Report</td>
<td>5/15/2012 11:26 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-02-2012 Report</td>
<td>5/9/2012 10:31 AM</td>
<td>Contoso Document</td>
</tr>
</table>
<p> Right-click on the newest file, select <i>Copy</i>. </p>
<p> Right-click on the blank column on the right, select <i>Paste</i>. This will create a file with the same name, but <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/09/27/5155193.aspx"> with “- Copy” appended</a>. </p>
<p> Press F5 to refresh the view and note the sort order. The copy appears at the top of the list. </p>
<table style="border: solid .75pt black">
<col style="padding-right: 1em"/>
<tr>
<td bgcolor="#F0F0F0" style="width: 15em">Name</td>
<td bgcolor="#D0D0D0">Date modified <font size="-2">▼</font></td>
<td bgcolor="#F0F0F0">Type</td>
<td bgcolor="#F0F0F0" style="width: 5em"></td>
</tr>
<tr>
<td>TPS 06-05-2012 Report – Copy</td>
<td>6/12/2012 7:00 AM</td>
<td>Contoso Document</td>
<td><font color="red">←</font></td>
</tr>
<tr>
<td>TPS 06-05-2012 Report</td>
<td>6/12/2012 7:00 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-29-2012 Report</td>
<td>6/5/2012 11:30 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-22-2012 Report</td>
<td>5/29/2012 10:17 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-15-2012 Report</td>
<td>5/22/2012 2:35 PM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-09-2012 Report</td>
<td>5/15/2012 11:26 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-02-2012 Report</td>
<td>5/9/2012 10:31 AM</td>
<td>Contoso Document</td>
</tr>
</table>
<p> Highlight the newly-created file, hit F2, and give the document a different name, and also remove the “- Copy” suffix. Hit Enter to accept the operation. </p>
<p> Press F5 to refresh the view again. Notice that the file that you just renamed, which is the <i>newest</i> file in the folder (it having just been created seconds ago) appears <i>second</i> in the list. </p>
<table style="border: solid .75pt black">
<col style="padding-right: 1em"/>
<tr>
<td bgcolor="#F0F0F0" style="width: 15em">Name</td>
<td bgcolor="#D0D0D0">Date modified <font size="-2">▼</font></td>
<td bgcolor="#F0F0F0">Type</td>
<td bgcolor="#F0F0F0" style="width: 5em"></td>
</tr>
<tr>
<td>TPS 06-05-2012 Report</td>
<td>6/12/2012 7:00 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 06-12-2012 Report</td>
<td>6/12/2012 7:00 AM</td>
<td>Contoso Document</td>
<td><font color="red">←</font></td>
</tr>
<tr>
<td>TPS 05-29-2012 Report</td>
<td>6/5/2012 11:30 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-22-2012 Report</td>
<td>5/29/2012 10:17 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-15-2012 Report</td>
<td>5/22/2012 2:35 PM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-09-2012 Report</td>
<td>5/15/2012 11:26 AM</td>
<td>Contoso Document</td>
</tr>
<tr>
<td>TPS 05-02-2012 Report</td>
<td>5/9/2012 10:31 AM</td>
<td>Contoso Document</td>
</tr>
</table>
<p> It appears that Explorer is ignoring the seconds in the Date Modified column and sorting only by the hour and minute. </p>
</blockquote>
<p> It’s an interesting theory the customer came up with, but the customer was fooled by the fact that he ran the experiment shortly after modifying the <i>TPS 06-05-2012 Report</i> document, so that the real behavior was masked.
 When you copy a file, the system preserves the date-modified timestamp. The <i>Date modified</i> column is not ignoring the seconds; in fact, it’s comparing them quite carefully, but since the timestamps of the original and the copy are the same, the timestamps compare equal. And when the items compare equal according to the sort criteria, Explorer falls back to sorting by name, and the fallback sort is always ascending.
 The confusion would have been cleared up if the <i>Date modified</i> column used the long time format instead of the short time format, but that only pushes the problem to files whose timestamps are fractional seconds apart. You have two files which show up as “6/12/2012 7:00:12 AM” and don’t realize that one of them is “6/12/2012 7:00:12.02 AM” and the other is “6/12/2012 7:00:12.89 AM”. My guess is that geeks won’t be satisfied until Explorer shows the full 64-bit <code>FILETIME</code> so you can see the difference down to the <a href="http://msdn.microsoft.com/en-us/library/ms724284(VS.85).aspx"> 100-nanosecond interval</a>.</p>
<p> (If you want to see the seconds, you can look on the file’s property sheet.) </p>


</body>