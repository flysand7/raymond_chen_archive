<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">How does the taskbar decide whether to show Recent or Frequent documents on the jump list?</h1>  <!-- .entry-meta -->

<p>Some jump lists show Recent documents, and others show Frequent documents. <img decoding="async" height="480" src="http://blogs.microsoft.co.il/blogs/sasha/image_7EA52397.png" width="228"/><img decoding="async" height="512" src="http://blogs.microsoft.co.il/blogs/sasha/image_thumb_02BED590.png" width="252"/>
 (Images stolen from <a href="http://blogs.microsoft.co.il/blogs/sasha/archive/2009/02/20/windows-7-taskbar-jump-lists.aspx"> Sasha Goldshtein</a>.)
 Our friend xpclient wanted to know how the taskbar decides which one to use, because it seemed random. (Ironically, xpclient is asking a question about the Window 7 client.)
 The default is to show Recent documents. But an application can customize its jump list, and in that case, the application can select <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd378397(v=vs.85).aspx"> which category to show</a> based on the guidance in the documentation. (Or the application might choose to ignore the guidance in the documentation and <a href="http://dilbert.com/strips/comic/1996-01-27"> show both</a>.)
 Okay, but what about Explorer itself? You can find that Explorer will sometimes show Frequent locations (e.g., on My Computer) and sometimes Recent locations (e.g., on Control Panel). How is this possible if the decision is made on per-application basis?
 Because the taskbar uses the shell <a href="http://msdn.microsoft.com/library/dd391569"> application user model</a> to associate windows with applications. We’ve taken advantage of this model a number of times before, like when we <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/06/01/10170113.aspx"> prevented a program from being pinned</a>, or <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/08/17/10340743.aspx"> made one application look like two</a> or <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/08/20/10341464.aspx"> many</a>. Explorer sets its jump lists to show Frequent, but if an Explorer window sets a custom application ID, then that window is treated by the taskbar as a separate program and therefore the Explorer default does not apply (and it gets Recent instead).
 To make things even more complicated, xpclient was running a third-party taskbar hacking application which manipulated application ID of windows which belong to other applications. And just like in real life, if you mess with stuff that isn’t yours, you can cause trouble for the real owner. In this case, manipulating the application IDs broke Explorer’s jump list customizations.
 This is another case of somebody <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/04/19/10295140.aspx"> doing some weird customization and then complaining that their system acts all strange</a> (which often leads to the accusation that Microsoft developers are a bunch of idiots) when the strange behavior was caused by their customization. I mean, if you’re running a taskbar hacking application, then you really shouldn’t be surprised if the taskbar occasionally behaves erratically.</p>
<p> <b>Bonus chatter</b>: The Recent and Frequent categories are variable-length, which you can customize by setting the <i>Number of recent items to display in Jump Lists</i>. </p>


</body>