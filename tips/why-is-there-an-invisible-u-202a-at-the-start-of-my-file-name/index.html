<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why is there an invisible U+202A at the start of my file name?</h1>  <!-- .entry-meta -->

<p>There’s something strange about this property sheet page: </p>
<table border="0" cellpadding="0" cellspacing="0" style="color: black;background-color: #f0f0f0;border: solid 1px #5284bc;width: 40em;font-size: 9pt;font-family: Segoe UI, Tahoma, MS Sans Serif, Arial, sans-serif" title="Explorer file property sheet open to the Security tab.">
<tr bgcolor="#6badf6" style="font-size: 14pt">
<td><span style="float: left;width: 5px"></span></td>
<td style="padding-bottom: 5px">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td align="center"><span style="float: left;width: 32pt"></span></td>
<td align="center" valign="bottom" width="100%">        IMG31415 Properties       </td>
<td align="center"> <span style="float: right;background-color: #c75050;color: white;font-size: 16pt;width: 32pt"> <b>×</b> </span> </td>
</tr>
</table>
</td>
<td><span style="float: left;width: 5px"></span></td>
</tr>
<tr>
<td bgcolor="#6badf6"><span style="float: left;width: 5px"></span></td>
<td style="border: solid 1px #5b93d1;border-bottom-width: 0px;padding: 5px">
<table border="0" cellpadding="0" cellspacing="0" style="width: 100%">
<tr>
<td valign="bottom">

</td>
<td>

</td>
<td valign="bottom">

</td>
<td style="border-bottom: solid 1px #afafaf;width: 100%">               </td>
</tr>
<tr>
<td colspan="4" style="border: solid 1px #afafaf;border-top-color: transparent;background-color: white;padding: 15px">


<table style="width: 100%;border: solid 1px #afafaf;text-align: left">
<tr>
<td> <span>👤</span> <span style="color: gray"> 👤</span> </td>
<td bgcolor="#3399ff" style="width: 100%;color: white">              SYSTEM             </td>
</tr>
<tr>
<td>               👤             </td>
<td>              Bob             </td>
</tr>
<tr>
<td> <span>👤</span> <span style="color: gray"> 👤</span> </td>
<td>              Administrators             </td>
</tr>
<tr>
<td> </td>
</tr>
<tr>
<td> </td>
</tr>
<tr>
<td> </td>
</tr>
</table>

<table cellspacing="0" style="width: 100%">
<thead>
<tr>
<td align="left">Permissions for SYSTEM</td>
<td align="center">Allow</td>
<td align="center">Deny</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;border-top: solid 1px #afafaf;padding-left: 10px">               Full control</td>
<td align="center" style="border-top: solid 1px #afafaf">              ✓</td>
<td align="center" style="border-right: solid 1px #afafaf;border-top: solid 1px #afafaf">                </td>
</tr>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;padding-left: 10px">               Modify</td>
<td align="center">              ✓</td>
<td align="center" style="border-right: solid 1px #afafaf">               </td>
</tr>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;padding-left: 10px">               Read &amp; execute</td>
<td align="center">              ✓</td>
<td align="center" style="border-right: solid 1px #afafaf">               </td>
</tr>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;padding-left: 10px">               Read</td>
<td align="center">              ✓</td>
<td align="center" style="border-right: solid 1px #afafaf">               </td>
</tr>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;padding-left: 10px">               Write</td>
<td align="center">              ✓</td>
<td align="center" style="border-right: solid 1px #afafaf">               </td>
</tr>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;padding-left: 10px">               Special permissions</td>
<td align="center">               </td>
<td align="center" style="border-right: solid 1px #afafaf">               </td>
</tr>
<tr>
<td align="left" style="border-left: solid 1px #afafaf;border-bottom: solid 1px #afafaf">                </td>
<td align="center" style="border-bottom: solid 1px #afafaf">               </td>
<td align="center" style="border-right: solid 1px #afafaf;border-bottom: solid 1px #afafaf">                </td>
</tr>
</tbody>
</table>

</td>
</tr>
</table>
</td>
<td bgcolor="#6badf6"><span style="float: left;width: 5px"></span></td>
</tr>
<tr>
<td bgcolor="#6badf6"><span style="float: left;width: 5px"></span></td>
<td style="border: solid 1px #5b93d1;border-top-width: 0px;padding: 5px"> <span style="float: right;width: 7em;text-align: center;padding: 5px;margin: 5px;border: solid 1px #afafaf">Apply</span> <span style="float: right;width: 7em;text-align: center;padding: 5px;margin: 5px;border: solid 1px #afafaf">Cancel</span> <span style="float: right;width: 7em;text-align: center;padding: 5px;margin: 5px;border: solid 1px #afafaf">OK</span> </td>
<td bgcolor="#6badf6"><span style="float: left;width: 5px"></span></td>
</tr>
<tr>
<td bgcolor="#6badf6" colspan="3"> <span style="float: left;height: 5px;width: 5px"></span></td>
</tr>
</table>
<p>Okay, that was a trick question, because the thing that’s strange is not visible to the eye. </p>
<p>Use the mouse to click in the object name field (the thing with the file path), then press <kbd>Home</kbd>, followed by <kbd>Shift</kbd>+<kbd>End</kbd> to select the entire text, then <kbd>Ctrl</kbd>+<kbd>C</kbd> to copy it to the clipboard. </p>
<p>Now things get interesting. </p>
<p>Fire up Notepad, paste the path into the Notepad document, and save it to the desktop with the name <tt>tricky.txt</tt>. </p>
<p>Huh? Notepad says, “This file contains characters in Unicode format which will be lost if you save this as an ANSI encoded text file.” </p>
<p>What Unicode characters are we talking about? There are no accented letters here. All the characters in the file name fit in the ASCII repertoire. </p>
<p>Go to a command prompt and type </p>
<pre>
C:\Users\Bob&gt; copy "
</pre>
<p>and then paste the path from the clipboard, then close the quotation mark, and hit Enter. </p>
<pre>
C:\Users\Bob&gt; copy "?C:\Users\Bob\Desktop\IMG31415.jpg"
The filename, directory name, or volume label syntax is incorrect.
</pre>
<p>Wait, what? Where did that rogue question mark come from? </p>
<p>The answers to the two questions are the same: The mysterious Unicode character, which is invisible in Notepad, and which appears as a question mark on the command line, is U+202A (LEFT-TO-RIGHT EMBEDDING). </p>
<p>We saw <a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/12/19/10483396.aspx">some time ago</a> that you can, as a last resort, insert the character U+202B (RIGHT-TO-LEFT EMBEDDING) to force text to be interpreted as right-to-left. The converse character is U+202A (LEFT-TO-RIGHT EMBEDDING), which forces text to be interpreted as left-to-right. </p>
<p>The Security dialog box inserts that control character in the file name field in order to ensure that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/10/26/10362864.aspx">the path components are interpreted in the expected manner</a>. Unfortunately, it also means that if you try to copy the text out of the dialog box, the Unicode formatting control character comes along for a ride. Since the character is normally invisible, it can create all sorts of silent confusion. </p>
<p>(We’re lucky that the confusion was quickly detected by Notepad and the command prompt. But imagine if you had pasted the path into the source code to a C program!) </p>


</body>