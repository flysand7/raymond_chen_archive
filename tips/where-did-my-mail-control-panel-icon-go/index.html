<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Where did my mail control panel icon go?</h1>  <!-- .entry-meta -->

<p>A customer ran into the following problem:</p>
<blockquote class="q"><p> I was trying to add another email account to Outlook, and the instructions say that I should go to the mail icon in the Control Panel, which to my surprise is nowhere to be found! How can I figure out what went wrong? </p></blockquote>
<p> A little bit of psychic debugging will solve this.
 The customer was running Windows Vista, 64-bit edition. On 64-bit versions of Windows XP and Windows Vista, the Control Panel shows only 64-bit control panels. The 32-bit control panels are off in a separate 32-bit control panel, which you can find by <a href="http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2007/03/23/9176.aspx"> clicking the <i>View 32-bit Control Panel Items</i> icon</a>.
 The separation of 32-bit and 64-bit control panels is an unfortunate consequence of the rule that 64-bit processes cannot load 32-bit DLLs and vice versa. On 64-bit Windows, Explorer is a 64-bit process, which means that it can’t load traditional 32-bit control panels. (Recall that <a href="http://blogs.msdn.com/oldnewthing/archive/2003/12/26/45979.aspx"> control panel applications run as DLLs inside the host process</a>.) Therefore, Explorer has to pass off the work of working with 32-bit control panel applications to a 32-bit alter ego process.
 Fortunately, Windows 7 no longer segregates control panel applications by bitness: They all appear in the main Control Panel. This was done by running a puppet 32-bit copy of the Control Panel behind the scenes and making the puppet do the main Control panel’s bidding whenever it needed to access information about 32-bit control panel applications.
 “Hey, go enumerate the 32-bit control panel applications for me.”
 “Hey, go get the icon for this 32-bit control panel application.”
 “Hey, go launch this 32-bit control panel application.”
 “Hey, go make me a sandwich.”</p>
<p> “Hey, give me a backrub.” </p>


</body>