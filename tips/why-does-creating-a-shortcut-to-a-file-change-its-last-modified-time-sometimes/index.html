<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does creating a shortcut to a file change its last-modified time… sometimes?</h1>  <!-- .entry-meta -->

<p>A customer observed that sometimes, the last-modified timestamp on a file would change even though nobody modified the file, or at least consciously took any steps to modify the file. In particular, they found that simply double-clicking the file in Explorer was enough to trigger the file modification.
 It took a while to puzzle out, but here’s what’s going on:
 When you double-click a file in Explorer, Explorer adds it to the Recent Items list. Internally, this is done by creating a shortcut to the item. The nice thing about a shortcut is that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/02/24/10133280.aspx"> it knows how to track its target</a>. That way, if you move an item, then try to open it from the Recent Items list, the <a href="http://technet.microsoft.com/en-us/magazine/2009.10.windowsconfidential.aspx"> shortcut tracking code will try to find where you moved it to</a>. You moved the file. The shortcut still works. Magic.
 Shortcut target tracking magic is accomplished <a href="http://technet.microsoft.com/en-us/magazine/2009.10.windowsconfidential.aspx"> with the assistance of object identifiers</a>, and object identifiers, as we saw earlier, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/02/28/10134679.aspx"> are created on demand the moment somebody first asks for one</a>.
 And that’s where the file modification is coming from. If the file is freshly-created, it won’t have an object identifier. When you create a shortcut to it (which happens implicitly when it is added to the Recent Items list), that triggers the creation of an object identifier, which in turn updates the last-modified time on the file.</p>
<p> Frustratingly, the <i>Link­Resolve­Ignore­Link­Info</i> and <i>No­Resolve­Track</i> policies do not prevent the creation of object identifiers. Those policies control whether the tracking information is used during the resolve process, but they don’t control whether the tracking information is obtained during shortcut creation. (Who knows, maybe you’re creating the shortcut to be used on a machine where those policies are not in effect.) To suppress collecting the volume information and object identifier at shortcut creation time, you need to pass the <a href="http://msdn.microsoft.com/bb762540.aspx"> <code>SLDF_FORCE_NO_LINKINFO</code> and <code>SLDF_FORCE_NO_LINKTRACK</code> flags</a> to the <a href="http://msdn.microsoft.com/bb774920.aspx"> <code>IShell­Link­Data­List::Set­Flags</code></a> method when you create the shortcut. </p>


</body>