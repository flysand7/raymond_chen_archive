<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why doesn't the Open Files list in the Shared Folders snap-in show all my open files?</h1>  <!-- .entry-meta -->

<p>A customer wanted a way to determine which users were using specific files on their server. They fired up the <a href="http://technet.microsoft.com/cc770406.aspx"> Shared Folders MMC snap-in</a> and went to the <i>Open Files</i> list. They found that the results were inconsistent. Some file types like <code>.exe</code> and <code>.pdf</code> did show up in the list when they were open, but other file types like <code>.txt</code> did not. The customer asked for an explanation of the inconsistency and for a list of which file types work and which ones don’t.
 The customer is confusing two senses of the term <i>open file</i>. From the file system point of view, an open file is one that has an outstanding handle reference. This is different from the user interface concept of “There is an open window on my screen showing the contents of the file.”
 The <i>Open Files</i> list shows files which are open in the file system sense, not in the user interface sense.
 Whether a file shows up in the <i>Open Files</i> list depends on  the application that is used to open the file (in the user interface sense). Text files are typically opened by Notepad, and Notepad reads the entire contents of the file into memory and closes the file handle. Therefore, the file is open (in the file system sense) only when it is in the process of being loaded or saved.
 There is no comprehensive list of which types of files fall into which category because the behavior is not a function of the file type but rather a function of the application being used to view the file. (If you open a <code>.txt</code> file in Word, I believe it will keep the file system handle open until you close the document window.)</p>
<p> The customer seemed satisfied with the explanation. They ran some experiments and observed that <i>Hey, check it out, if I load a really big text file into Notepad, I can see it show up in the Open Files list momentarily</i>. They never did come back with any follow-up questions, so I don’t know how they went about solving the original problem. (Maybe they used a SACL to audit who was opening the files.) </p>


</body>