<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Is it expected that custom default pinned taskbar items via LayoutModification.xml keep coming back each time the user logs on?</h1>  <!-- .entry-meta -->

<p>A customer was using the <code>LayoutModification.xml</code> file in their operating system image in order to pin a few applications to the taskbar automatically. They found that if the user unpinned those items, that seemed to work okay, but once the user logged out and back in, the pinned items came back. They wanted to know if this was intended behavior.</p>
<p>Yes, this is intended behavior, as spelled out <a href="https://docs.microsoft.com/en-us/windows/configuration/configure-windows-10-taskbar#configure-taskbar-general"> in the documentation</a>:</p>
<blockquote class="q"><p>If you use a provisioning package or import-startlayout to configure the taskbar, your configuration will be reapplied each time the explorer.exe process restarts. If your configuration pins an app and the user then unpins that app, the user’s change will be overwritten the next time the configuration is applied.</p></blockquote>
<p>The paragraph also tells you what to do if you want user changes to be preserved:</p>
<blockquote class="q"><p>To apply a taskbar configuration that allows users to make changes that will persist, apply your configuration by using Group Policy.</p></blockquote>
<p>On the other hand, if your goal was to apply a configuration that users cannot change, then it is typical to hide the weirdness of “I unpinned this app, but it keeps coming back” by preventing them being unpinned in the first place: Couple the <code>LayoutModification.xml</code> file with the <a href="https://docs.microsoft.com/en-us/windows/configuration/windows-10-start-layout-options-and-policies"> <code>NoPinningToTaskbar</code> policy</a>, which preserves existing pins but does not allow the user to pin new apps or unpin old ones.</p>


</body>