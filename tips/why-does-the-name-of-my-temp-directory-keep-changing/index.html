<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does the name of my TEMP directory keep changing?</h1>  <!-- .entry-meta -->

<p>A customer liaison contacted the shell team with the following request:</p>
<blockquote class="q"><p> <b>Subject</b>: <a href="http://blogs.msdn.com/oldnewthing/archive/2007/01/18/1488858.aspx">Support case: 069314718055994</a></p>
<p> On two of my customer’s machines, he’s finding that if he opens %TEMP% from the Start menu, it opens C:\Users\username\AppData\Local\Temp\1, C:\Users\username\AppData\Local\Temp\2, and so on. Each time the user logs off and back on, the number increments. The number resets after each reboot. Why are we seeing these folders being created under Temp? This does not appear to be the default behavior. What would cause the operating system to create these folders? </p>
<p> The customer rebuilt one of the affected machines, and the behavior went away. However, the customer claims that both machines were working fine before, and then this problem suddenly started. Therefore, the customer is afraid that the problem will come back in the future. Any pointers in solving this mystery would be very much appreciated. </p>
</blockquote>
<p> It’s not clear why this question was directed at the shell team, since Explorer doesn’t set your TEMP directory. (In general, a lot of random questions come to the shell team not because they are shell questions but because people don’t know where else to turn. Since the shell presents the desktop, and the desktop is on the screen when the problem occurs, maybe it’s a shell issue!)
 The question was redirected to the Remote Desktop team, since it is Remote Desktop that creates these subdirectories off the TEMP directory. And from there, psychic powers predicted that the problem lay in the <a href="http://technet.microsoft.com/en-us/library/cc759190(WS.10).aspx"> <i>Administrative Templates\Windows Components\Terminal Services\Temporary folders</i></a> group policy. If you don’t select <i>Do not use temporary folders per session</i>, then these TEMP subdirectories are created. (Yet another of those crazy <a href="http://blogs.msdn.com/oldnewthing/archive/2007/03/14/1878777.aspx"> negative checkboxes</a>.) There is also <a href="http://support.microsoft.com/kb/243215"> a knowledge base article describing the registry keys behind these group policies</a>.</p>
<p> The customer liaison responded cryptically, </p>
<blockquote class="q"><p> Thanks. I tested the policies and it is the one that creates the folder. </p></blockquote>
<p> Not sure what this means for solving the customer’s problem, but that was the last we heard from the customer liaison, so I guess this policy was enough to give the customer a nudge in the right direction. </p>


</body>