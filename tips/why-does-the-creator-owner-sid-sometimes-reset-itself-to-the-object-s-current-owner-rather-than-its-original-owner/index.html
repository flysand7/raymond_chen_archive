<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does the CREATOR_OWNER SID sometimes reset itself to the object’s current owner rather than its original owner?</h1>  <!-- .entry-meta -->

<p>I noted some time ago that the <code>CREATOR_</code><code>OWNER</code> security identifier (SID) is not a shorthand that refers to the object’s current owner. Rather, <a href="https://blogs.msdn.microsoft.com/oldnewthing/20160524-00/?p=93515">the <code>CREATOR_</code><code>OWNER</code> SID is a template that is applied when the object is created</a>. When the template is applied, all occurrences of <code>CREATOR_</code><code>OWNER</code> are replaced with the object’s current owner, and it is the replaced SID that controls access. Changing the object’s owner doesn’t cause these access control entries to be recalculated;¹ they continue to refer to the captured value. </p>
<p>A customer observed this phenomenon when they created a folder with an inheritable access control entry (ACE) for <code>CREATOR_</code><code>OWNER</code>. They observed that those access control entries were indeed propagated to child objects, with the <code>CREATOR_</code><code>OWNER</code> changed to the object’s actual owner. Furthermore, if they went to the Security properties and changed the child object’s owner, the ACE was not recalculated to update the ACE’s SID from the old owner to the new owner. </p>
<p>However (and this is the weird part), if they use the Security properties to make some unrelated change to the object’s access control list (ACL), then this has a side effect of recalculating the ACEs and updating the <code>CREATOR_</code><code>OWNER</code>-sourced ACEs to refer to the new owner. </p>
<p>This recalculation is not being done by the security infrastructure. It’s being done by the ACL editor. </p>
<p>When you change the access control list for an item, the ACL editor calls <code>Tree­Set­Named­Security­Info</code> and passes an ACL that consists only of the non-inherited ACEs, and it sets the <code>UNPROTECTED_</code><code>DACL_</code><code>SECURITY_</code><code>INFORMATION</code> flag, which means “Oh, and also inherit ACEs from my parent, as if I were newly-created.” </p>
<p>In other words, the ACL edit deletes all the ACEs that were obtained by inherance, and then creates new ACEs based on the current parent’s inheritable ACEs. </p>
<p>The ACL editor is trying to be helpful, but it ends up being confusing. </p>
<p>¹ What would this recalculation even mean if the object was moved to a new folder after being created, or if the containing folder’s access control list were modified in the interim? I guess you could have a bit somewhere in the ACE that says, “This was originally created from a template that used <code>CREATOR_</code><code>OWNER</code>.” The closest thing to that is the <code>INHERITED_</code><code>ACE</code> bit, which says “This ACE was autogenerated via inheritance,” but it doesn’t give any information as to what the original ACE was. Suppose the object’s current owner is Bob. If an ACE applies to Bob and has the <code>INHERITED_</code><code>ACE</code> bit set, it could mean that the original template ACE’s SID was <code>CREATOR_</code><code>OWNER</code> that was changed to Bob during template application because Bob was the original owner, or it could mean that the original template ACE’s SID was <code>CREATOR_</code><code>GROUP</code> that was changed to Bob during template application because Bob was the original group, or it could mean that the original template ACE’s SID was Bob all along. </p>
<p>


</p></body>