<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Capturing the current directory from a batch file</h1>  <!-- .entry-meta -->

<p>
Sometimes people go to great lengths to get information which
is available in a much simpler way.
We saw it a few days ago when we found a 200+-line C# program that
could be replaced with
<a href="/oldnewthing/archive/2005/01/20/357225.aspx">
a 90-byte batch file</a>.
Here’s another example
<a href="http://www.differentpla.net/node/view/255">
of a rather roundabout way of
capturing the current directory from a batch file</a>.
</p>
<p>
The easy way is to use the <code>%CD%</code> pseudo-variable.
It expands to the current working directory.
</p>
<pre>
set OLDDIR=%CD%
.. do stuff ..
chdir /d %OLDDIR% &amp;rem restore current directory
</pre>
<p>
(Of course, directory save/restore could more easily have been
done with pushd/popd, but that’s not the point here.)
</p>
<p>
The <code>%CD%</code> trick is handy even from the command line.
For example, I often find myself in a directory where there’s
a file that I want to operate on but… oh, I need to
chdir to some other directory in order to perform that operation.
</p>
<pre>
set _=%CD%\curfile.txt
cd ... some other directory ...
somecommand args %_% args
</pre>
<p>
(I like to use <code>%_%</code> as my scratch environment variable.)
</p>
<p>
Type <code>SET /?</code> to see the other pseudo-variables provided by the
command processor.</p>


</body>