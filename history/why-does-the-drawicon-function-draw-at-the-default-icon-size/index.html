<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does the DrawIcon function draw at the default icon size?</h1>  <!-- .entry-meta -->

<p>Miral wondered <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/29/10043635.aspx#10044060"> why the <code>Draw­Icon</code> function draws at the default icon size instead of respecting the actual icon size</a>. After all, if you loaded a nonstandard-sized icon via <code>Load­Image</code>, then presumably you want to use that nonstandard size.
 The question is one of those types of questions that fails to understand history, like asking why NASA didn’t send the space shuttle to rescue the Apollo 13 astronauts.
 At the time the <code>Draw­Icon</code> function was written, the <code>Load­Image</code> function didn’t exist, and wouldn’t exist for over a decade. The <code>Load­Image</code> function showed up in Windows 95, but Windows was drawing icons long before then, and for a long time, the only way to load icons was with the <code>Load­Icon</code> function, which always loaded icons at their default size. When the ability to create nonstandard-sized icons was added, you then had the question of how to draw them. Code which relied on the fact that all icons were the same size would call <code>Draw­Icon</code> expecting the result to be a 32×32 image (or whatever your icon size was). If you drew it at its actual size, you would either have this L-shaped “hole” in the application (if the actual size was smaller), or you would have an icon that overflowed some other part of the application. Either way you lose.
 Therefore, <code>Draw­Icon</code> always draws at the standard icon size. Think of it as <code>Draw­Icon­Back­Compat</code>. If you are a fancy new application that can handle icons at nonstandard sizes, then use <code>Draw­Icon­Ex</code> and don’t pass the <code>DI_DEFAULT­SIZE</code> flag.
 <b>Bonus chatter</b>: The documentation states that the <code>DI_COMPAT</code> has no effect. Presumably it had an effect in some previous version of Windows?
 In Windows 95, if you used the <code>LoadCursor</code> to load a standard cursor (like, say, <code>IDC_ARROW</code>), but the standard arrow cursor was customized by the user, Windows would draw the customized cursor. Passing the <code>DI_COMPAT</code> flag forced the standard arrow cursor to be drawn. <strike>So far as I can tell, nobody ever passed that flag.</strike></p>
<p> <b>Update</b>: My claim that nobody passed that flag is incorrect. The <code>Draw­Icon</code> function itself passed that flag (and still does today, even though it no longer does anything). </p>


</body>