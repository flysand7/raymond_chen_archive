<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does the CBS_SORT combo box style sort the left square bracket so strangely?</h1>  <!-- .entry-meta -->

<p>Some time ago, <a href="http://blogs.msdn.com/michkap/">Michael Kaplan</a> asked (and answered), <a href="http://blogs.msdn.com/michkap/archive/2008/10/29/9022296.aspx"> How the @#%&amp;*! does <code>CBS_SORT</code> choose to sort it all out?</a> One detail in his answer is that the sorting algorithm used by <code>CBS_SORT</code> is basically <code>CompareString</code>, with special treatment for the left square bracket U+005B.
 Why is the left square bracket so special?
 It goes back to the <code>LB_DIR</code> message (which is in turn used by <code>DlgDirList</code>, <code>CB_DIR</code>, <code>DlgDirListComboBox</code>, and related functions). If you ask for drives to be added to the list or combo box, they are added in the form <code>[-X-]</code>, where <code>X</code> is the drive letter. The left square bracket is special-cased so that the drive letters sort to the top of the list.</p>
<p> Of course, <code>LB_DIR</code> and related functions and messages are pretty old-school nowadays, but the code for them is still around, so the sort function still needs to worry about them. </p>


</body>