<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why doesn’t findstr use the standard regular expression library?</h1>  <!-- .entry-meta -->

<p>Tim wonders <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/10/21/10566091.aspx#10566266">why there isn’t a standard library that was settled on and used by everyone by now</a>. (While you’re at it, <a href="http://gizmodo.com/5391271/giz-explains-why-every-country-has-a-different-fing-plug">why isn’t there a standard for electrical outlets that was settled on and used by everyone by now</a>?) And the answer is the same: Things started out with everybody doing their own thing, and by the time a standard emerged, it was too late. </p>
<p><span id="more-92361"></span></p>
<p>The <code>findstr</code> program was written in 1990 by a colleague of mine who retired in the year 2000. Let’s call him Bob. It was originally written for MS-DOS and was called <code>qgrep</code>. I don’t know what the <code>q</code> stands for, but it couldn’t call itself <code>grep</code> because that name was already taken. And since this was Bob’s little program, he got to choose which regular expression language it accepted. </p>
<p>The <code>qgrep</code> program sat in Bob’s bag of tricks, and he shared it with his closest friends, who shared it with their friends, and so on. Meanwhile, Bob ported <code>qgrep</code> to OS/2 (because he needed a version that ran on OS/2) and eventually Windows NT (because he needed a version that ran on Windows NT). </p>
<p>At this point, <code>qgrep</code> caught the attention of the people in charge of the Windows Resource Kit. They were on the prowl for handy little utilities that could be tossed onto the CD. They said, “Hey, can we put <code>qgrep</code> on the Resource Kit CD?” Bob said, “Sure, here you go.” And then the Resource Kit people said, “Okay, but we are afraid to call it <code>qgrep</code> because that might create licensing or trademark problems, so we’re going to have to call it something else. We’ll call it <code>findstr</code>! Also, we’d like to change the command line switches to match the other Resource Kit tools, and we’d like to change the help text based on this feedback from our editors.” </p>
<p>“Whatever,” said Bob. “I’m going to keep calling mine <code>qgrep</code>, thanks the same. Here you go: I created a clone of <code>qgrep</code>, renamed it <code>findstr</code>, and made the changes you requested.” </p>
<p>That’s how things stood for several years. Bob had <code>qgrep</code>. The Resource Kit had <code>findstr</code>, a mutant offshoot of <code>qgrep</code>. </p>
<p>One piece of common feedback from system administrators was that a lot of the Resource Kit tools were really handy, but it was pain to have to install them on every computer. And since they aren’t part of the core Windows installation, the tools aren’t available for use in logon scripts either. </p>
<p>And that’s how <code>findstr</code> ended up part of Windows. It came in through on the coattails of the Resource Kit. I remember when they were added to Windows because becoming part of the core product meant another round of security reviews. </p>
<p>Okay, that’s a nice story, but it doesn’t answer the question. Why wasn’t <code>findstr</code> upgraded to use a newer regular expression engine? </p>
<p>Recall that Bob retired in 2000. And since <code>qgrep</code> was Bob’s baby, all development on <code>qgrep</code> stopped when he retired. When Bob gave the <code>findstr</code> project to the Resource Kit team, they got the source code, but there was no knowledge hand-off so that somebody on the Resource Kit team understood how the program worked, in case they needed to fix a bug or add a feature. Not that there was anybody on the Resource Kit team available to receive said knowledge. The Resource Kit was primarily a <i>book</i>, so the Resource Kit team consisted mostly of writers and editors, not programmers. (That’s probably why they were so excited about changing the help text.) The CD filled with tools was considered a bonus feature, not the primary product. I guess they figured that if they needed a bug fixed or a feature added, they’d just ask Bob. </p>
<p>Besides, you can’t change the regular expression language accepted by a program after it has been released, because that would break all the scripts that used the old language. Remember those logon scripts that use <code>findstr</code>? If any of them used a regular expression whose meaning changed between the old syntax and the new syntax, those scripts would subtly stop working properly. A change in the regular expression syntax would require a new switch to opt into the new behavior. </p>
<p>I don’t recall Bob ever mentioning to me that somebody asked him to upgrade the regular expression engine in <code>qgrep</code>. I suspect nobody asked, seeing as perl-style regular expressions didn’t become popular until long after Bob retired. Also, Bob is not a lawyer, so he doesn’t want to have to read the license for a third-party library and figure out how to remain in compliance with it. </p>
<p>(From reading <a href="http://www.pcre.org/licence.txt">the PCRE license</a>, it appears that if your program uses PCRE, you must reproduce “the above copyright notice”, but there are <i>three</i> copyright notices on that page. Does the program need to reproduce all of them? Or just the last one? It seems to me that nearly everybody just ignores the license requirements. For example, Safari uses PCRE, but the PCRE copyright, licensing terms, and disclaimer do not appear in <a href="http://images.apple.com/legal/sla/docs/Safari.pdf">the Safari EULA</a> or any other Safari documentation I can find.) </p>


</body>