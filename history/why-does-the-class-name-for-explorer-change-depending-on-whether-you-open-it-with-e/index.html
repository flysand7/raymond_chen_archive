<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Why does the class name for Explorer change depending on whether you open it with /e?</h1>  <!-- .entry-meta -->

<p>I noted some time ago that Explorer’s original name was Cabinet, and that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/07/29/10545697.aspx">the name lingers in the programmatic class name: Cabinet­WClass</a>. A commenter with a rude name points out that Explorer uses the class name Explorer­WClass if you open it with the /e command line switch, adding, “<a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/07/29/10545697.aspx#10546016">This is rather strange since you can toggle the folder pane on/off in the UI either way</a>.” </p>
<p>In Windows 95, the window class names for Explorer were Cabinet­WClass for plain Explorer windows and Explorer­WClass for windows opened in Explore mode with the folder tree view thingie on the left hand side. This was not strange at the time because there were two different types of Explorer windows, and there was no way to change between them. The UI to toggle the folder pane on/off did not exist. </p>
<p>Internally, the two types of Explorer windows were handled by different frame window classes, and naturally the two different classes got different names. The plain Explorer window frame hosted a view window, an address bar, and a status bar, whereas the fancy Explorer window frame hosted those components plus a folder tree. It wasn’t until some time later that the ability to toggle the folder pane on and off was added. To do this, the two window classes were merged into a single implementation that dynamically added in or removed the folder tree. </p>
<p>Great, we can get rid of Explorer­WClass and just use Cabinet­WClass for everything. </p>
<p>And then the application compatibility bug reports came in. </p>
<p>Because even though it wasn’t documented, application relied on the implementation detail that plain Explorer windows could be found by doing a <code>Find­Window</code> for Cabinet­WClass, and that fancy Explorer windows could be found by doing a <code>Find­Window</code> for Explorer­WClass. They would do things like launch <code>explorer.exe /e C:\some\folder</code>, wait a few seconds, and then do a <code>Find­Window("Explorer­WClass", ...)</code> and expect to find a window. (Just do a Web search for <a href="http://www.bing.com/search?q=%2BCabinetWClass">Cabinet­WClass</a> and <a href="http://www.bing.com/search?q=%2BExplorerWClass">Explorer­WClass</a> if you don’t believe me.) </p>
<p>For compatibility, therefore, Explorer windows still use the old class names from Windows 95. If you open the window with the folder pane hidden, the class name is Cabinet­WClass, and if you open it with the folder pane visible, the class name is Explorer­WClass. The two classes are functionally identical, but people who rely on undocumented behavior expect to see the same names from 1995. </p>


</body>