<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What’s the atom returned by RegisterClass useful for?</h1>  <!-- .entry-meta -->

<p>The <code> <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/windowclassreference/windowclassfunctions/registerclass.asp"> RegisterClass</a></code> and <code> <a href="http://msdn.microsoft.com/library/en-us/winui/WinUI/WindowsUserInterface/Windowing/WindowClasses/WindowClassReference/WindowClassFunctions/RegisterClassEx.asp"> RegisterClassEx</a></code> functions return an <code> <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/dataexchange/atoms.asp"> ATOM</a>.</code> What is that <code>ATOM</code> good for?</p>
<p> The names of all registered window classes is kept in an <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/dataexchange/atoms/aboutatomtables.asp"> atom table</a> internal to USER32.  The value returned by the class registration functions is that atom. You can also retrieve the atom for a window class by asking a window of that class for its class atom via <code>GetClassWord(hwnd, GCW_ATOM)</code>. </p>
<p> The atom can be converted to an integer atom via <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/dataexchange/atoms/atomreference/atommacros/makeintatom.asp"> the <code>MAKEINTATOM</code> macro</a>, which then can be used by functions that accept class names in the form of strings or atoms. The most common case is the <code>lpClassName</code> parameter to <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/createwindow.asp"> the <code>CreateWindow</code> macro</a> and <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/createwindowex.asp"> the <code>CreateWindowEx</code> function</a>. Less commonly, you can also use it as the <code>lpClassName</code> parameter for <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/windowclassreference/windowclassfunctions/getclassinfo.asp"> the <code>GetClassInfo</code></a> and <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/windowclassreference/windowclassfunctions/getclassinfoex.asp"> <code>GetClassInfoEx</code> functions</a>. (Though why you would do this I can’t figure out. In order to have the atom to pass to <code>GetClassInfo</code> in the first place, you must have registered the class (since that’s what returns the atom), in which case why are you asking for information about a class that you registered?) </p>
<p> To convert a class name to a class atom, you can create a dummy window of that class and then do the aforementioned <code>GetClassWord(hwnd, GCW_ATOM)</code>. Or you can take advantage of the fact that the return value from the <code>GetClassInfoEx</code> function is the atom for the class, cast to a <code>BOOL</code>. This lets you do the conversion without having to create a dummy window. (Beware, however, that <code>GetClassInfoEx</code>‘s return value is <strong>not</strong> the atom on Windows 95-derived operating systems.) </p>
<p> But what good is the atom? </p>
<p> Not much, really. Sure, it saves you from having to pass a string to functions like <code>CreateWindow</code>, but all it did was replace a string with with an integer you now have to save in a global variable for later use. What used to be a string that you could hard-code is now an atom that you have to keep track of. Unclear that you actually won anything there. </p>
<p> I guess you could use it to check quickly whether a window belongs to a particular class.  You get the atom for that class (via <code>GetClassInfo</code>, say) and then get the atom for the window and compare them.  But you can’t cache the class atom since the class might get unregistered and then re-registered (which will give it a new atom number). And you can’t prefetch the class atom since the class may not yet be registered at the point you prefetch it. (And as noted above, you can’t cache the prefetched value anyway.) So this case is pretty much a non-starter anyway; you may as well use <a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/windowclassreference/windowclassfunctions/getclassname.asp"> the <code>GetClassName</code> function</a> and compare the resulting class name against the class you’re looking for. </p>
<p> In other words, window class atoms are an anachronism. Like <a href="http://blogs.msdn.com/oldnewthing/archive/2003/11/13/55662.aspx"> replacement dialog box classes</a>, it’s one of those generalities of the Win32 API that never really got off the ground, but which must be carried forward for backwards compatibility. </p>
<p> But at least now you know what they are. </p>
<p> [Typos fixed October 12.] </p>


</body>