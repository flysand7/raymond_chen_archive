<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">What is the purpose of the RunAsCommand value?</h1>  <!-- .entry-meta -->

<p>Commenter c_e_pizano asks <a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#539003">what the purpose of the <code>HKLM\Software\Microsoft\Windows\CurrentVersion\App Paths\foo.exe\RunAsCommand</code> registry value is</a>.</p>
<p>Well, for starters, it isn’t documented, so the official answer to that question is “Don’t mess with it.” </p>
<p>Kind of makes me wonder why you’re asking about the registry value anyway, seeing as it’s undocumented in the first place. Are you trying to reverse-engineer Windows? </p>
<p>To be honest, I don’t know what its purpose is, but I do know what happens when you set it: Everything stops working. </p>
<p>This is one of those abandoned features like <a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/25/5658731.aspx"><code>EM_SETHILITE</code></a>. When it got abandoned, not all of the pieces got cleaned up, and there is still code that queries for the key, but the code path that gets executed when the query succeeds simply doesn’t work (probably because some of the functionality it relied upon was deleted!) and consequently always returns an error. That’s why, if you set the value, you get a weird error message. </p>
<p>The broken code was deleted in 2004, so Windows Vista doesn’t even query for the value any more. It’s now just a footnote to history. </p>


</body>