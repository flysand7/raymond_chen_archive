<body style=max-width:80ch;margin:auto>
<h1 class="entry-title" style="margin-bottom:15px;">Woe unto PROGMAN.INI</h1>  <!-- .entry-meta -->

<p>Sad but true: Once you document a file format, it becomes a de facto API.
 The Windows 95 team learned this the hard way when they set out to replace Program Manager with Explorer. Not only were the settings in the <code>PROGMAN.INI</code> file documented, so too was the binary file format of <code>*.GRP</code> files. The binary file format was included for diagnostic purposes: If you have a corrupted <code>GRP</code> file, you can use the binary file format documentation to try to recover what you can out of it.
 But many people treated this documentation not as a FYI, but as a backdoor API. Instead of using the formal DDE interface for creating program groups and icons, they just directly edited the <code>PROGMAN.INI</code> file and the applicable <code>GRP</code> files to get the icons and groups they wanted.
 Oh wait, and then you need to reboot in order for the backdoor API to take effect, because all you did was modify the on-disk files, not the in-memory copy held by <code>PROGMAN.EXE</code>.
 Of course, when Windows 95 replaced Program Manager with Explorer, these programs found themselves modifying the data files of a program that no longer was running. Special code had to be added to Explorer to read settings from <code>PROGMAN.INI</code> and even detect that a new <code>GRP</code> file was added and convert it into shortcuts on the Start menu.</p>
<p> I wouldn’t be surprised if that code is still lying around, just in case somebody pulls out an old application from 1994 and installs it. </p>


</body>